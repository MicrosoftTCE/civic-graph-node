!function(){function e(e,t){e.each(function(){var e,n=d3.select(this),i=n.text().split(/\s+/).reverse(),l=[],o=0,a=1.1,r=parseFloat(n.attr("dy")),c=d3.select(this)[0][0].__data__,s=n.text(null).append("tspan").attr("x",0).attr("y",function(){return null!==c.employees?z(c.employees)+10:17}).attr("dy",r+"em");for(console.log(n);e=i.pop();)l.push(e),s.text(l.join(" ")),s.node().getComputedTextLength()>t&&(l.pop(),s.text(l.join(" ")),l=[e],o++,s=n.append("tspan").attr("x",0).attr("y",function(){return null!==c.employees?z(c.employees)+5:12}).attr("dy",o*a+r+"em").text(e))})}function t(e){return"translate("+e.x+","+e.y+")"}function n(e,t){return"translate("+e+","+t+")"}function i(e){e+="",x=e.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var t=/(\d+)(\d{3})/;t.test(x1);)x1=x1.replace(t,"$1,$2");return x1+x2}d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var e=this.parentNode.firstChild;e&&this.parentNode.insertBefore(this,e)})};var l,o,a,r,c,u,d,p,f,h,y={},m={},v={},g={},b=1,k=(d3.scale.category20(),1e3),w=1e3,E={},A={},I={},B={},O={},P={},F={},N={},T={},C={},G=d3.select(".content").append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("id","network").attr("height",w).attr("width",k).style("position","fixed");d3.select("body > nav > nav > div").append("div").attr("id","editBox").append("p").text("Edit").style("color","#2e92cf");var S=k/w,q=$("#network"),Y=q.parent();$(window).on("resize",function(){var e=Y.width();q.attr("width",e),q.attr("height",Math.round(e/S))}).trigger("resize");var R="0 0 "+k+" "+w;G.attr("viewBox",R).attr("preserveAspectRatio","xMidYMid");var z=d3.scale.sqrt().domain([10,13e4]).range([10,50]),D=d3.scale.sqrt().domain([10,1e6]).range([10,50]);d3.json("/athena",function(x,S){function q(e){d3.select(this).classed("fixed",function(e){e.fixed=!1}),d3.select(this).on("mousedown.drag",null),u=d3.select(this).data()[0];{var t=parseInt(G.style("width").substring(0,(G.style("width").length+1)/2)),n=parseInt(G.style("height").substring(0,(G.style("height").length+1)/2));parseInt(t/2),parseInt(n/2)}multiplierX=t/k,multiplierY=n/w,scaledDX=multiplierX*e.x,scaledDY=multiplierY*e.y,C=jQuery.extend(!0,{},e),C.x=k/2-10,C.y=w/2-60;d3.layout.force().nodes(vt).size([k,w]).links(_t).linkStrength(0).charge(function(e){return null!==e.employees?-6*z(e.employees):-25}).on("tick",yt).start()}function Y(e){s=j(e),webform=Q(e),d3.select("#edit").html(webform),d3.select("#info").html(s).style("list-style","square"),d3.selectAll("#editCurrentInfo").on("click",function(){R(e)}).on("mouseover",function(){return d3.select(this).style("cursor","pointer"),d3.select("#editBox").style("visibility","visible")}).on("mousemove",function(){return console.log(d3.event.pageY),console.log(d3.event.pageX),d3.select("#editBox").style("top",d3.event.pageY+4+"px").style("left",d3.event.pageX+16+"px")}).on("mouseout",function(){return d3.select("#editBox").style("visibility","hidden")})}function R(e){console.log(e),L(),ot(e)}function Q(){var e="";return e+='<h1 id="edit-add-info"><i class="icon-plus on-left"></i>Add Information</h1>'}function j(e){var t="";if(t+='<div style="height:30px"><a style="float:right;"><i id="editCurrentInfo" class="icon-pencil on-left"></i></a></div>',t+='<h1><a href="'+e.url+'" target="_blank">'+e.name+"</a></h1>",t+="<h6>Type of Entity: </h6> <h5>"+e.type+"</h5>",null!==e.location){t+="<br/><h6> Location:  </h6>";var n=[];if(-1!==e.location.indexOf("; ")){t+="<br/> <h5><ul>",n=e.location.split("; ");for(var l=0;l<n.length;l++)t+='<li style="display:block;"><h5><a class="click-location" style="cursor:pointer;">'+n[l]+"</h5></a></li>"}else t+="<h5><ul>",t+='<li style="display:inline-block;"><h5><a class="click-location" style="cursor:pointer;">'+e.location+"</h5></a></li>";t+="</h5></ul><br/>"}else t+="<br/><h6> Location:  </h6> <h5>N/A</h5><br/>";if("Individual"!==e.type&&(t+=null!==e.employees?"<h6>Employees: </h6> <h5>"+i(e.employees.toString())+"</h5><br/>":"<h6>Employees: </h6> <h5>N/A</h5><br/>"),null===e.twitter_handle)t+="<h6>Twitter:  </h6> <h5>N/A</h5><br/>",t+="<h6>Twitter Followers: </h6> <h5>N/A</h5><br/>";else{var o=e.twitter_handle.replace("@","");o="https://twitter.com/"+o,t+='<h6>Twitter:  </h6> <h5><a href="'+o+'" target="_blank">'+e.twitter_handle+"</h5></a><br/>",t+=null!==e.followers?"<h6>Twitter Followers:  </h6> <h5>"+i(e.followers.toString())+"</h5><br/>":"<h6>Twitter Followers:  </h6> <h5>N/A</h5><br/>"}if(null!==e.key_people){t+="<br/><h6>Key People:</h6><ul><h5>";for(var l=0;l<e.key_people.length;l++)t+='<li><a href="http://www.bing.com/search?q='+e.key_people[l].replace(" ","%20")+"%20"+e.nickname.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.key_people[l]+"</a></li>";t+="</h5></ul>"}return null===e.funding_received?t+="<br/><h6>No known funding received.</h6><br/>":(t+="<br/><h6>Received funding from:</h6><ul>",e.funding_received.forEach(function(e){t+=0===e.amount||null===e.amount?'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+i(e.amount.toString())+"</strong></li>",null===e.year}),t+="</ul>"),null===e.funding_given?t+="<br/><h6>No known funding provided.</h6><br/>":(t+="<br/><h6>Gave funding to:</h6><ul>",e.funding_given.forEach(function(e){t+=0===e.amount||null===e.amount?'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+i(e.amount.toString())+"</strong></li>",null===e.year}),t+="</ul>"),null===e.investments_received?t+="<br/><h6>No known investments received.</h6><br/>":(t+="<br/><h6>Received investments from:</h6><ul>",e.investments_received.forEach(function(e){t+=0===e.amount||null===e.amount?'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+i(e.amount.toString())+"</strong></li>",null===e.year}),t+="</ul>"),null===e.investments_made?t+="<br/><h6>No known investments made.</h6><br/>":(t+="<br/><h6>Invested in:</h6><ul>",e.investments_made.forEach(function(e){t+=0===e.amount||null===e.amount?'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+i(e.amount.toString())+"</strong></li>",null===e.year}),t+="</ul>"),null===e.collaborations?t+="<br/><h6>No known collaborations.</h6><br/>":(t+="<br/><h6>Collaborated with:</h6><ul>",e.collaborations.forEach(function(e){t+='<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+"</a></h5></li>"}),t+="</ul>"),null===e.data?t+="<br/><h6>No known external data usage.</h6><br/>":(t+="<br/><h6>Obtained data from:</h6><ul>",e.data.forEach(function(e){t+='<li><h5><a href="http://www.bing.com/search?q='+e.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.entity+"</a></h5></li>"}),t+="</ul>"),it(e),t}function L(){d3.select("#edit-add-info").html('<i class=" icon-file on-left"></i>Reset Form').on("click",L),h.on("mouseover",null),sa=it(),d3.select("#info").html(sa),d3.select('#key-people-0 input[name="kpeople"]').on("keyup",function(){X(0)}),d3.select('#funding-0 input[name="fund"]').on("keyup",function(){J(0)}),d3.select('#investing-0 input[name="invest"]').on("keyup",function(){H(0)}),d3.select('#fundinggiven-0 input[name="fundgiven"]').on("keyup",function(){V(0)}),d3.select('#investmentmade-0 input[name="investmade"]').on("keyup",function(){U(0)}),d3.select('#data-0 input[name="data"]').on("keyup",function(){Z(0)}),d3.select("#toFormC").on("click",function(){displayFormC()}),d3.selectAll("#submit-A").on("click",function(){d3.select("#name").style("border-color","#d9d9d9"),d3.select("#location").style("border-color","#d9d9d9"),K()})}function W(){var e={type:null,categories:null,name:null,nickname:null,location:null,url:null,employees:null,key_people:null,twitter_handle:null,followers:null,relations:null,funding_received:null,investments_received:null,funding_given:null,investments_made:null,collaborations:null,data:null,revenue:null,expenses:null,influence:null};if(""===$('input[name="name"]').val()&&""===$('input[name="location"]').val())return console.log("The entity name and location have not been filled out."),{name:null,location:null,errorMessage:"The entity name and location have not been filled out."};if(""===$('input[name="name"]').val())return console.log("The entity name has not been filled out."),{name:null,errorMessage:"The entity name has not been filled out."};if(""===$('input[name="location"]').val())return console.log("The location has not been filled out."),{location:null,errorMessage:"The location has not been filled out."};e.type=$("input#rb_forpro").is(":checked")?"For-Profit":$("input#rb_nonpro").is(":checked")?"Non-Profit":$("input#rb_gov").is(":checked")?"Government":"Individual",e.name=d3.select(".webform-content input[name='name']")[0][0].value,e.categories=[],d3.selectAll(".webform-categories input").filter(function(){if(this.checked===!0)switch(this.value){case"General":e.categories.push("General");break;case"DataTrans":e.categories.push("Data Transparency");break;case"CJobsOpp":e.categories.push("21st Century Jobs and Opportunities");break;case"SRCities":e.categories.push("Smart and Resilient Cities")}}),0===e.categories.length&&(e.categories=null),e.location=d3.select("input[name='location']")[0][0].value,e.url="",e.url=""===d3.select("input[name='website']")[0][0].value?null:d3.select("input[name='website']")[0][0].value,e.employees="",e.employees=""===d3.select("input[name='employees']")[0][0].value?null:parseInt(d3.select("input[name='employees']")[0][0].value),e.key_people=[],d3.selectAll(".kpeople").filter(function(){""!==this.value&&e.key_people.push(this.value)}),0===e.key_people.length&&(e.key_people=null),e.funding_received=[];var t;d3.selectAll(".fund-input .funder").filter(function(n,i){this.value&&(d3.selectAll(".fund_amt")[0][i].value?(t=d3.selectAll(".fund_amt")[0][i].value,e.funding_received.push(d3.selectAll(".fund_year")[0][i].value?{name:this.value,amount:t,year:d3.selectAll(".fund_year")[0][i].value}:{name:this.value,amount:t,year:null})):(t=null,e.funding_received.push(d3.selectAll(".fund_year")[0][i].value?{name:this.value,amount:t,year:d3.selectAll(".fund_year")[0][i].value}:{name:this.value,amount:t,year:null})))}),0===e.funding_received.length&&(e.funding_received=null),e.funding_given=[];var n;d3.selectAll(".fundgiven-input .fundee").filter(function(t,i){this.value&&(d3.selectAll(".fundgiven_amt")[0][i].value?(n=d3.selectAll(".fundgiven_amt")[0][i].value,e.funding_given.push(d3.selectAll(".fundgiven_year")[0][i].value?{name:this.value,amount:n,year:d3.selectAll(".fundgiven_year")[0][i].value}:{name:this.value,amount:n,year:null})):(n=null,e.funding_given.push(d3.selectAll(".fundgiven_year")[0][i].value?{name:this.value,amount:n,year:d3.selectAll(".fundgiven_year")[0][i].value}:{name:this.value,amount:n,year:null})))}),0===e.funding_given.length&&(e.funding_given=null),e.investments_received=[];var i;d3.selectAll(".invest-input .investor").filter(function(t,n){this.value&&(d3.selectAll(".invest_amt")[0][n].value?(i=d3.selectAll(".invest_amt")[0][n].value,e.investments_received.push(d3.selectAll(".invest_year")[0][n].value?{name:this.value,amount:i,year:d3.selectAll(".invest_year")[0][n].value}:{name:this.value,amount:i,year:null})):(i=null,e.investments_received.push(d3.selectAll(".invest_year")[0][n].value?{name:this.value,amount:i,year:d3.selectAll(".invest_year")[0][n].value}:{name:this.value,amount:i,year:null})))}),0===e.investments_received.length&&(e.investments_received=null),e.investments_made=[];var l;return d3.selectAll(".investmade-input .investee").filter(function(t,n){this.value&&(d3.selectAll(".investmade_amt")[0][n].value?(l=d3.selectAll(".investmade_amt")[0][n].value,e.investments_made.push(d3.selectAll(".investmade_year")[0][n].value?{name:this.value,amount:l,year:d3.selectAll(".investmade_year")[0][n].value}:{name:this.value,amount:l,year:null})):(l=null,e.investments_made.push(d3.selectAll(".investmade_year")[0][n].value?{name:this.value,amount:l,year:d3.selectAll(".investmade_year")[0][n].value}:{name:this.value,amount:l,year:null})))}),0===e.investments_made.length&&(e.investments_made=null),e.data=[],d3.selectAll(".data-entity").filter(function(){""!==this.value&&e.data.push(this.value)}),0===e.data.length&&(e.data=null),e}function M(e){e.nickname=d3.select(".webform-content input[name='nickname']")[0][0].value,e.nickname||(e.nickname=e.name),e.twitter_handle=d3.select(".webform-content input[name='twitterhandle']")[0][0].value,e.twitter_handle||(e.twitter_handle=null),e.influence=$(".webform-influence input#rb_local").is(":checked")?"local":"global",e.collaborations=[],d3.selectAll(".collaborator").filter(function(){this.value&&e.collaborations.push(this.value)}),0===e.collaborations.length&&(e.collaborations=null),e.revenue=[];var t;d3.selectAll(".revenue-input .revenue_amt").filter(function(n,i){this.value&&(t=d3.selectAll(".revenue-input .revenue_year")[0][i].value,e.revenue.push(t?{amount:this.value,year:t}:{amount:this.value,year:null}))}),0===e.revenue.length&&(e.revenue=null),e.expenses=[];var n;return d3.selectAll(".expense-input .expense_amt").filter(function(t,i){this.value&&(n=d3.selectAll(".expense-input .expense_year")[0][i].value,e.expenses.push(n?{amount:this.value,year:n}:{amount:this.value,year:null}))}),0===e.expenses.length&&(e.expenses=null),console.log(e),e}function K(){var e=W();e.location&&e.name?(counterKey=0,counterK=0,counterFund=0,counterF=0,s="",s+='<h2 id="webform-head">Information</h2><hr/>              <div class="webform-content">              <div class="input-control text" data-role="input-control">                <input type="text" name="name" id="name" placeholder="Name of Entity"/>              </div>              <h3 class="form-header">Entity Type</h3>              <div class="webform-entities">                <div data-role="input-control" class="input-control radio default-style webform">                  <label>                    <input id="rb_forpro" type="radio" name="entitytype" value="For-Profit" checked="checked"/><span class="check"></span>                    <h4 class="webform-labels">For-Profit</h4>                  </label>                </div>                <div data-role="input-control" class="input-control radio default-style webform">                  <label>                    <input id="rb_nonpro" type="radio" name="entitytype" value="Non-Profit"/><span class="check"></span>                    <h4 class="webform-labels">Non-Profit</h4>                  </label>                </div>                <div data-role="input-control" class="input-control radio default-style webform">                  <label>                    <input id="rb_gov" type="radio" name="entitytype" value="Government"/><span class="check"></span>                    <h4 class="webform-labels">Government</h4>                  </label>                </div>               <div data-role="input-control" class="input-control radio default-style webform">                  <label>                    <input id="rb_individs" type="radio" name="entitytype" value="Individual"/><span class="check"></span>                    <h4 class="webform-labels">Individual</h4>                  </label>                </div>              </div>              <div class="input-control text" data-role="input-control">                <input type="text" name="location" id="location" placeholder="City, State"/>              </div>              ',s+='<hr/>            <div class = "input-control text" data-role="input-control">              <input type="text" name="nickname" id="nickname" placeholder="Nickname/Abbr."/>            </div>            <div class = "input-control text" data-role="input-control">              <input type="text" name="twitterhandle" id="twitterhandle" placeholder="Twitter Handle"/>            </div>            <h3 class="form-header" style="display:inline-block;">Circle of Influence: </h3>            <div class="webform-influence">              <div data-role="input-control" class="input-control radio default-style webform">                <label>                  <input id="rb_local" type="radio" name="influence-type" value="Local Influence" checked="checked"/><span class="check"></span>                  <h4 class="webform-labels">Local Influence</h4>                </label>              </div>              <div data-role="input-control" class="input-control radio default-style webform">                <label>                  <input id="rb_global" type="radio" name="influence-type" value="Global Influence" checked="checked"/><span class="check"></span>                  <h4 class="webform-labels">Global Influence</h4>                </label>              </div>            </div>            <h3 class="form-header">Collaboration</h3>            <div id="collaboration-0" class="input-control text" data-role="input-control">            <input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/>            </div>            <h3 class="form-header">Revenue</h3>            <div id="revenue-0">            <div class="revenue-input input-control text" data-role="input-control">            <input type="text" name="revenue_amt" class="revenue_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/>            <input type="text" name="revenue_year" class="revenue_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div>            </div>            <h3 class="form-header">Expenses</h3>            <div id="expense-0">            <div class="expense-input input-control text" data-role="input-control">            <input type="text" name="expense_amt" class="expense_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/>            <input type="text" name="expense_year" class="expense_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div>            </div>            <button type="button" id="submit-B" href="javascript: check_empty()">Submit</button>            </div>',d3.select("#info").html(s),d3.selectAll("#name").text(function(){console.log(e.name),this.value=e.name}).attr("disabled",!0),d3.selectAll("#location").text(function(){this.value=e.location}).attr("disabled",!0).style("margin-top","10px"),d3.selectAll('input[name="entitytype"]').filter(function(){this.checked=this.value===e.type?!0:!1,this.disabled=!0}),d3.selectAll('input[name="collaboration"]').on("keyup",function(){et(0)}),d3.selectAll('input[name="revenue_amt"]').on("keyup",function(){tt(0)}),d3.selectAll('input[name="expense_amt"]').on("keyup",function(){nt(0)}),d3.selectAll("#submit-B").on("click",function(){lt(e)})):e.name||e.location?e.name?d3.select("#location").style("border-color","#e51400"):d3.select("#name").style("border-color","#e51400"):(d3.select("#name").style("border-color","#e51400"),d3.select("#location").style("border-color","#e51400"))}function X(e){""!==$("#key-people-"+e+' input[name="kpeople"]').val()&&(d3.select("#key-people-"+e+' input[name="kpeople"]').on("keyup",null),e++,console.log(e),$("#key-people-"+(e-1)).after('<div id="key-people-'+e+'" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name"/></div>'),d3.select("#key-people-"+e+" input[name='kpeople']").on("keyup",function(){X(e)}))}function J(e){""!==$("#funding-"+e+' input[name="fund"]').val()&&(d3.select("#funding-"+e+' input[name="fund"]').on("keyup",null),e++,console.log(e),$("#funding-"+(e-1)).after('<div id="funding-'+e+'"><div class="fund-input input-control text" data-role="input-control">            <input type="text" name="fund" class="funder" placeholder="Funder" style="display:inline-block; width:50%;"/>            <input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#funding-"+e+" input[name='fund']").on("keyup",function(){J(e)}))}function H(e){""!==$("#investing-"+e+' input[name="invest"]').val()&&(d3.select("#investing-"+e+' input[name="invest"]').on("keyup",null),e++,console.log(e),$("#investing-"+(e-1)).after('<div id="investing-'+e+'"><div class="invest-input input-control text" data-role="input-control">            <input type="text" name="invest" class="investor" placeholder="Investor" style="display:inline-block; width:50%;"/>            <input type="text" name="invest_amt" class="invest_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="invest_year" class="invest_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#investing-"+e+" input[name='invest']").on("keyup",function(){H(e)}))}function V(e){""!==$("#fundinggiven-"+e+' input[name="fundgiven"]').val()&&(d3.select("#fundinggiven-"+e+' input[name="fundgiven"]').on("keyup",null),e++,console.log(e),$("#fundinggiven-"+(e-1)).after('<div id="fundinggiven-'+e+'"><div class="fundgiven-input input-control text" data-role="input-control">            <input type="text" name="fundgiven" class="fundee" placeholder="Fundee" style="display:inline-block; width:50%;"/>            <input type="text" name="fundgiven_amt" class="fundgiven_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="fundgiven_year" class="fundgiven_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#fundinggiven-"+e+" input[name='fundgiven']").on("keyup",function(){V(e)}))}function U(e){""!==$("#investmentmade-"+e+' input[name="investmade"]').val()&&(d3.select("#investmentmade-"+e+' input[name="investmade"]').on("keyup",null),e++,console.log(e),$("#investmentmade-"+(e-1)).after('<div id="investmentmade-'+e+'"><div class="investmade-input input-control text" data-role="input-control">            <input type="text" name="investmade" class="investee" placeholder="Investee" style="display:inline-block; width:50%;"/>            <input type="text" name="investmade_amt" class="investmade_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="investmade_year" class="investmade_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#investmentmade-"+e+" input[name='investmade']").on("keyup",function(){U(e)}))}function Z(e){""!==$("#data-"+e+' input[name="data"]').val()&&(d3.select("#data-"+e+' input[name="data"]').on("keyup",null),e++,console.log(e),$("#data-"+(e-1)).after('<div id="data-'+e+'" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div>'),d3.select("#data-"+e+" input[name='data']").on("keyup",function(){Z(e)}))}function et(e){""!==$("#collaboration-"+e+' input[name="collaboration"]').val()&&(d3.select("#collaboration-"+e+' input[name="collaboration"]').on("keyup",null),e++,console.log(e),$("#collaboration-"+(e-1)).after('<div id="collaboration-'+e+'" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div>'),d3.select("#collaboration-"+e+" input[name='collaboration']").on("keyup",function(){et(e)}))}function tt(e){""!==$("#revenue-"+e+' input[name="revenue_amt"]').val()&&(d3.select("#revenue-"+e+' input[name="revenue_amt"]').on("keyup",null),e++,console.log(e),$("#revenue-"+(e-1)).after('<div id="revenue-'+e+'"><div class="revenue-input input-control text" data-role="input-control">            <input type="text" name="revenue_amt" class="revenue_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/>          <input type="text" name="revenue_year" class="revenue_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#revenue-"+e+" input[name=revenue_amt]").on("keyup",function(){tt(e)}))}function nt(e){""!==$("#expense-"+e+' input[name="expense_amt"]').val()&&(d3.select("#expense-"+e+' input[name="expense_amt"]').on("keyup",null),e++,console.log(e),$("#expense-"+(e-1)).after('<div id="expense-'+e+'"><div class="expense-input input-control text" data-role="input-control">           <input type="text" name="expense_amt" class="expense_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/>          <input type="text" name="expense_year" class="expense_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#expense-"+e+" input[name=expense_amt]").on("keyup",function(){nt(e)}))}function it(){return s="",s+='<h2 id="webform-head">Information</h2><hr/>            <div class="webform-content">            <div class="input-control text" data-role="input-control">            <input type="text" name="name" id="name" placeholder="Name of Entity"/>            </div>            <h3 class="form-header">What type of entity?</h3>            <div class="webform-entities">            <div data-role="input-control" class="input-control radio default-style webform">              <label>                <input id="rb_forpro" type="radio" name="entitytype" value="For-Profit" checked="checked"/><span class="check"></span>                <h4 class="webform-labels">For-Profit</h4>              </label>            </div>            <div data-role="input-control" class="input-control radio default-style webform">              <label>                <input id="rb_nonpro" type="radio" name="entitytype" value="Non-Profit"/><span class="check"></span>                <h4 class="webform-labels">Non-Profit</h4>              </label>            </div>            <div data-role="input-control" class="input-control radio default-style webform">              <label>                <input id="rb_gov" type="radio" name="entitytype" value="Government"/><span class="check"></span>                <h4 class="webform-labels">Government</h4>              </label>            </div>            <div data-role="input-control" class="input-control radio default-style webform">              <label>                <input id="rb_individs" type="radio" name="entitytype" value="Individual"/><span class="check"></span>                <h4 class="webform-labels">Individual</h4>              </label>            </div>            </div>            <h3 class="form-header">What type(s) of work do they do?</h3><h4>(Select All That Apply)</h4>            <div class="webform-categories">            <div data-role="input-control" class="input-control checkbox webform">              <label>                <input id="cb_gen" type="checkbox" name="gen" data-show="general" value="General"/><span class="check"></span>                <h4 class="webform-labels">General</h4>              </label>            </div>            <div data-role="input-control" class="input-control checkbox webform">              <label>                <input id="cb_datat" type="checkbox" name="datat" data-show="datatrans" value="DataTrans"/><span class="check"></span>                <h4 class="webform-labels">Data Transparency</h4>              </label>            </div>            <div data-role="input-control" class="input-control checkbox webform">              <label>                <input id="cb_cjao" type="checkbox" name="cjao" data-show="cjobsopp" value="CJobsOpp"/><span class="check"></span>                <h4 class="webform-labels">21st Century Jobs and Opportunities</h4>              </label>            </div>            <div data-role="input-control" class="input-control checkbox webform">              <label>                <input id="cb_src" type="checkbox" name="src" data-show="srcities" value="SRCities"/><span class="check"></span>                <h4 class="webform-labels">Smart and Resilient Cities</h4>              </label>            </div>            </div>            <div class="input-control text" data-role="input-control">              <input type="text" name="location" id="location" placeholder="City, State"/>            </div>            <div class="input-control text" data-role="input-control">            <input type="text" name="website" id="website" placeholder="Website"/>            </div>            <h3 class="form-header" style="display:inline-block;">Number of Employees</h3>            <div class="input-control text" data-role="input-control" style="width:27% !important; display:inline-block; float:right; margin-top: 2%;">              <input type="text" name="employees" id="employee" maxlength="6" style="width:100% !important;"/>            </div>            <h3 class="form-header">Key People?</h3>            <div id="key-people-0" class="input-control text" data-role="input-control">              <input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name"/>            </div>            <h3 class="form-header">Who funds them via grants?</h3>            <div id="funding-0">            <div class="fund-input input-control text" data-role="input-control">            <input type="text" name="fund" class="funder" placeholder="Funder" style="display:inline-block; width:50%;"/>            <input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div>            </div>            <h3 class="form-header">Who invests in them via equity stakes (stock)?</h3>            <div id="investing-0">            <div class="invest-input input-control text" data-role="input-control">            <input type="text" name="invest" class="investor" placeholder="Investor" style="display:inline-block; width:50%;"/>            <input type="text" name="invest_amt" class="invest_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="invest_year" class="invest_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div>            </div>            <h3 class="form-header">Who do they fund via grants?</h3>            <div id="fundinggiven-0">            <div class="fundgiven-input input-control text" data-role="input-control">            <input type="text" name="fundgiven" class="fundee" placeholder="Fundee" style="display:inline-block; width:50%;"/>            <input type="text" name="fundgiven_amt" class="fundgiven_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="fundgiven_year" class="fundgiven_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div>            </div>            <h3 class="form-header">Who do they invest in via equity stakes (stock)?</h3>            <div id="investmentmade-0">            <div class="investmade-input input-control text" data-role="input-control">            <input type="text" name="investmade" class="investee" placeholder="Investee" style="display:inline-block; width:50%;"/>            <input type="text" name="investmade_amt" class="investmade_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="investmade_year" class="investmade_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div>            </div>            <h3 class="form-header">Who provides them with data?</h3>            <div id="data-0" class="input-control text" data-role="input-control">            <input type="text" name="data" class="data-entity" placeholder="Data Resource"/>            </div>            <div id="nextPhase"><span>Almost done...</span><button type="button" id="submit-A" href="javascript: check_empty()">Next</button></div>            </div>            <hr/>            <div class="webform-footer">            <span id="">Some entities lack adequate information. Would you like to help?</span><br/><span id="toFormC">Click here!</span>            </div>'
}function lt(e){var t=M(e);console.log(e);var n="";n+='<h2 id="webform-head">Information</h2><hr/>              <div style="text-align:center;" class="webform-content">              <p>Thanks for submitting information to Athena!</p>              <p>Might you be interested in helping with other entities?</p>',n+='<ul id="suggestions">',n+="</ul>          </div>",d3.select("#info").html(n),d3.selectAll("#info ul a").on("click",function(e,t){pt(suggestions[t]),L(),ot(suggestions[t])}),$.ajax({type:"POST",data:$.param(t),url:"/database/save",crossDomain:!0}).done(function(){})}function ot(e){if(p=e,d3.selectAll("#name").text(function(){this.value=e.name}),d3.selectAll("#location").text(function(){this.value=e.location}),d3.selectAll('input[name="entitytype"]').filter(function(){this.checked=this.value===e.type?!0:!1}),null!==e.categories&&d3.selectAll(".webform-categories input").filter(function(t,n){this.checked=e.categories.indexOf(d3.selectAll(".webform-categories h4")[0][n].textContent)>-1?!0:!1}),d3.selectAll("#website").text(function(){this.value=e.url}),d3.selectAll("#employee").text(function(){this.value=e.employees}),null!==e.key_people){for(var t=e.key_people,n=0;n<t.length;n++)$("#key-people-"+n).after('<div id="key-people-'+(n+1)+'" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name""/></div>'),d3.select("#key-people-"+n+' input[name="kpeople"]').on("keyup",null),d3.select("#key-people-"+n+' input[name="kpeople"]').text(function(){this.value=t[n]});d3.select("#key-people-"+t.length+' input[name="kpeople"]').on("keyup",function(){X(t.length)})}if(null!==e.funding_received){var i=e.funding_received;i.forEach(function(e,t){$("#funding-"+t).after('<div id="funding-'+(t+1)+'"><div class="fund-input input-control text" data-role="input-control">            <input type="text" name="fund" class="funder" placeholder="Funder" style="display:inline-block; width:50%;"/>            <input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div></div>'),d3.select("#funding-"+t+' input[name="fund"]').on("keyup",null),d3.select("#funding-"+t+' input[name="fund"]').text(function(){this.value=e.entity}),d3.select("#funding-"+t+' input[name="fund_amt"]').text(function(){this.value=e.amount}),d3.select("#funding-"+t+' input[name="fund_year"]').text(function(){this.value=e.year})}),d3.select("#funding-"+i.length+" input[name='fund']").on("keyup",function(){J(i.length)})}if(null!==e.funding_given){var l=e.funding_given;l.forEach(function(e,t){$("#fundinggiven-"+t).after('<div id="fundinggiven-'+(t+1)+'"><div class="fundgiven-input input-control text" data-role="input-control">            <input type="text" name="fundgiven" class="fundee" placeholder="Fundee" style="display:inline-block; width:50%;"/>            <input type="text" name="fundgiven_amt" class="fundgiven_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="fundgiven_year" class="fundgiven_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div></div>'),d3.select("#fundinggiven-"+t+' input[name="fundgiven"]').on("keyup",null),d3.select("#fundinggiven-"+t+' input[name="fundgiven"]').text(function(){this.value=e.entity}),d3.select("#fundinggiven-"+t+' input[name="fundgiven_amt"]').text(function(){this.value=e.amount}),d3.select("#fundinggiven-"+t+' input[name="fundgiven_year"]').text(function(){this.value=e.year})}),d3.select("#fundinggiven-"+l.length+" input[name='fundgiven']").on("keyup",function(){V(l.length)})}if(null!==e.investments_received){var o=e.investments_received;o.forEach(function(e,t){$("#investing-"+t).after('<div id="investing-'+(t+1)+'"><div class="invest-input input-control text" data-role="input-control">            <input type="text" name="invest" class="investor" placeholder="Investor" style="display:inline-block; width:50%;"/>            <input type="text" name="invest_amt" class="invest_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="invest_year" class="invest_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div></div>'),d3.select("#investing-"+t+' input[name="invest"]').on("keyup",null),d3.select("#investing-"+t+' input[name="invest"]').text(function(){this.value=e.entity}),d3.select("#investing-"+t+' input[name="invest_amt"]').text(function(){this.value=e.amount}),d3.select("#investing-"+t+' input[name="invest_year"]').text(function(){this.value=e.year})}),d3.select("#investing-"+o.length+" input[name='invest']").on("keyup",function(){H(o.length)})}if(null!==e.investments_made){var a=e.investments_made;a.forEach(function(e,t){$("#investmentmade-"+t).after('<div id="investmentmade-'+(t+1)+'"><div class="investmade-input input-control text" data-role="input-control">            <input type="text" name="investmade" class="investee" placeholder="Investee" style="display:inline-block; width:50%;"/>            <input type="text" name="investmade_amt" class="investmade_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>            <input type="text" name="investmade_year" class="investmade_year" placeholder="Year" style="display:inline-block; width: 20%;"/>            </div></div>'),d3.select("#investmentmade-"+t+' input[name="investmade"]').on("keyup",null),d3.select("#investmentmade-"+t+' input[name="investmade"]').text(function(){this.value=e.entity}),d3.select("#investmentmade-"+t+' input[name="investmade_amt"]').text(function(){this.value=e.amount}),d3.select("#investmentmade-"+t+' input[name="investmade_year"]').text(function(){this.value=e.year})}),d3.select("#investmentmade-"+a.length+" input[name='investmade']").on("keyup",function(){U(a.length)})}if(null!==e.data){var r=e.data;r.forEach(function(e,t){$("#data-"+t).after('<div id="data-'+(t+1)+'" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div>'),d3.select("#data-"+t+' input[name="data"]').on("keyup",null),d3.select("#data-"+t+' input[name="data"]').text(function(){this.value=e.entity})}),d3.select("#data-"+r.length+" input[name='data']").on("keyup",function(){Z(r.length)})}d3.selectAll("#submit-A").on("click",function(){d3.select("#name").style("border-color","#d9d9d9"),d3.select("#location").style("border-color","#d9d9d9"),K(),at(e)})}function at(e){if(d3.selectAll("#nickname").text(function(){this.value=e.nickname}),d3.selectAll("#twitterhandle").text(function(){this.value=e.twitter_handle}),d3.selectAll('input[name="influence-type"]').filter(function(){this.checked="local"===e.influence&&"Local Influence"===this.value?!0:"global"===e.influence&&"Global Influence"===this.value?!0:!1}),null!==e.collaborations){var t=e.collaborations;t.forEach(function(e,t){$("#collaboration-"+t).after('<div id="collaboration-'+(t+1)+'" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div>'),d3.select("#collaboration-"+t+' input[name="collaboration"]').on("keyup",null),d3.select("#collaboration-"+t+' input[name="collaboration"]').text(function(){this.value=e.entity})}),console.log(t.length),d3.select("#collaboration-"+t.length+' input[name="collaboration"]').on("keyup",function(){et(t.length)})}if(null!==e.expenses){var n=e.expenses;n.forEach(function(e,t){$("#expense-"+t).after('<div id="expense-'+(t+1)+'"><div class="expense-input input-control text" data-role="input-control">           <input type="text" name="expense_amt" class="expense_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/>          <input type="text" name="expense_year" class="expense_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#expense-"+t+' input[name="expense_amt"]').on("keyup",null),d3.select("#expense-"+t+' input[name="expense_amt"]').text(function(){this.value=e.amount}),d3.select("#expense-"+t+' input[name="expense_year"]').text(function(){this.value=e.year})}),d3.select("#expense-"+n.length+' input[name="expense_amt"]').on("keyup",function(){nt(n.length)})}if(null!==e.revenue){var i=e.revenue;i.forEach(function(e,t){$("#revenue-"+t).after('<div id="revenue-'+(t+1)+'"><div class="revenue-input input-control text" data-role="input-control">            <input type="text" name="revenue_amt" class="revenue_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/>          <input type="text" name="revenue_year" class="revenue_year" placeholder="Year" style="display:inline-block; width: 20%;"/>        </div></div>'),d3.select("#revenue-"+t+' input[name="revenue_amt"]').on("keyup",null),d3.select("#revenue-"+t+' input[name="revenue_amt"]').text(function(){this.value=e.amount}),d3.select("#revenue-"+t+' input[name="revenue_year"]').text(function(){this.value=e.year})}),d3.select("#revenue-"+i.length+' input[name="revenue_amt"]').on("keyup",function(){tt(i.length)})}}function rt(){for(var e="",t=[0,0,0,0],n=[],i=[],l=[],o=[],a=0;a<E.length;a++)"Individual"===E[a].type&&(o.push(E[a].name),Bt.push(E[a]),t[3]++),"Non-Profit"===E[a].type&&(i.push(E[a].name),At.push(E[a]),t[1]++),"For-Profit"===E[a].type&&(n.push(E[a].name),Et.push(E[a]),t[0]++),"Government"===E[a].type&&(l.push(E[a].name),It.push(E[a]),t[2]++);e+="<h3 style='padding-bottom:10px;'>The Data</h3>",d3.select("#info").html(e).style("list-style","square"),d3.select("#info").append("div").attr("id","breakdown").style("width","100%");var a=d3.scale.linear().domain([0,d3.max(t)]).range([0,$("#breakdown").width()]),r=0,c=0;d3.select("#breakdown").selectAll("div").data(t).enter().append("div").style("width",function(e){return a(e)/5+"%"}).style("height","20px").style("font","8px sans-serif").style("background-color",function(){return 0===r?(r++,"rgb(127,186,0)"):1===r?(r++,"rgb(0,164,239)"):2===r?(r++,"rgb(242,80,34)"):3===r?(r++,"rgb(255,185,0)"):void 0}).style("text-align","right").style("padding","3px").style("margin","1px").style("color","white").text(function(){return 0===c?void c++:1===c?void c++:2===c?void c++:3===c?void c++:void 0});var s="";s+="<h3 style='padding-top:15px; color:rgb(127,186,0);'>For-Profit ("+t[0]+"):</h3> ";for(var a=0;a<n.length;a++)s+=a===n.length-1?"<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+n[a]+"</a>":"<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+n[a]+", </a>";s+="<h3 style='padding-top:15px; color:rgb(0,164,239);'>Non-Profit ("+t[1]+"):</h3> ";for(var a=0;a<i.length;a++)s+=a===i.length-1?"<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+i[a]+"</a>":"<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+i[a]+", </a>";s+="<h3 style='padding-top:15px; color:rgb(242,80,34);'>Government ("+t[2]+"):</h3> ";for(var a=0;a<l.length;a++)s+=a===l.length-1?"<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+l[a]+"</a>":"<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+l[a]+", </a>";s+="<h3 style='padding-top:15px; color:rgb(255,185,0);'>Individual ("+t[3]+"):</h3> ";for(var a=0;a<o.length;a++)s+=a===o.length-1?"<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+o[a]+"</a>":"<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+o[a]+", </a>";d3.select("#info").append("text").style("padding-bottom","20px").html(s)}function ct(){var e="";E.forEach(function(e){if(Ot.push(e.name.toLowerCase()),Pt.push(e.location.toLowerCase()),$t.push(e.nickname.toLowerCase()),-1===Ft.indexOf(e.name)&&null!==e.name&&Ft.push(e.name),-1===Ft.indexOf(e.nickname)&&null!==e.nickname&&Nt.push(e.nickname),-1===Tt.indexOf(e.location)&&null!==e.location){var t=e.location.split("; ");t.forEach(function(e){-1===Tt.indexOf(e)&&Tt.push(e)})}}),Ct=Ct.concat(Tt),Ct=Ct.concat(Nt),Ct=Ct.concat(Ft),Ct=Ct.sort();for(var t=0;t<Ct.length;t++)e+='<option value="'+Ct[t]+'">';d3.select(".filter-name-location datalist").html(e)}function st(e){var t=[],n=0;if(e=e.toLowerCase(),-1!==Ot.indexOf(e))Ot.forEach(function(t){if(t===e&&t.length===e.length){var n=Ot.indexOf(e);f.filter(function(e,t){t===n&&pt(e)})}});else if(-1!==$t.indexOf(e))$t.forEach(function(t){if(t===e&&t.length===e.length){var n=$t.indexOf(e);f.filter(function(e,t){t===n&&pt(e)})}});else{Pt.forEach(function(i){if(null!==i){var l=i.split("; ");-1!==l.indexOf(e)&&t.push(n)}n++});P.style("opacity",function(t){return t.source.location===e&&t.target.location===e?"1":"0.05"}),F.style("opacity",function(t){return t.source.location===e&&t.target.location===e?"1":"0.05"}),N.style("opacity",function(t){return t.source.location===e&&t.target.location===e?"1":"0.05"}),T.style("opacity",function(t){return t.source.location===e&&t.target.location===e?"1":"0.05"}),d3.selectAll(".node").style("opacity",function(e,n){return-1===t.indexOf(n)?.05:1}).on("mouseover",null),h.on("mouseout",null).on("mouseover",null).on("click",null),h.filter(function(e,t){return 1==f[0][t].style.opacity?e:void 0}).on("mouseout",null).on("mouseover",Y).on("click",null)}}function ut(e){console.log("Inside node hover");var t=j(e);webform=Q(e),d3.select("#edit").html(webform),d3.select("#info").html(t).style("list-style","square"),P.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),F.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),N.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),T.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"});var n=function(e,t){return e.target.index===t.index},i=function(e,t){return e.source.index===t.index},l={};l[e.ID]=1,B.forEach(function(t){i(t,e)&&(l[t.target.index]=1),n(t,e)&&(l[t.source.index]=1)}),O.forEach(function(t){i(t,e)&&(l[t.target.index]=1),n(t,e)&&(l[t.source.index]=1)}),A.forEach(function(t){i(t,e)&&(l[t.target.index]=1),n(t,e)&&(l[t.source.index]=1)}),I.forEach(function(t){i(t,e)&&(l[t.target.index]=1),n(t,e)&&(l[t.source.index]=1)}),d3.select(this).style("stroke","rgba(0,0,0,0.6)"),G.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(e){return e.ID in l?"1":"0.05"}).select("text").style("opacity",1),d3.select(this.parentNode).select("text").transition().duration(350).delay(0).style("opacity",1).style("font-weight","bold")}function dt(){h.style("stroke","white").on("mouseover",ut).on("mouseout",dt).on("click",pt),P.transition().duration(350).delay(0).style("stroke","rgb(111,93,168)").style("opacity","0.2").style("stroke-width","1px"),F.transition().duration(350).delay(0).style("stroke","rgb(38,114,114)").style("opacity","0.2").style("stroke-width","1px"),N.transition().duration(350).delay(0).style("stroke","rgb(235,232,38)").style("opacity","0.2").style("stroke-width","1px"),T.transition().duration(350).delay(0).style("stroke","rgb(191,72,150)").style("opacity","0.2").style("stroke-width","1px"),d3.selectAll(".node").transition().duration(350).delay(0).style("opacity","1"),d3.selectAll(".node").selectAll("text").transition().duration(350).delay(0).style("opacity",function(e){var t;return"For-Profit"===e.type&&(t=y.hasOwnProperty(e.name)?1:0),"Non-Profit"===e.type&&(t=m.hasOwnProperty(e.name)?1:0),"Individual"===e.type&&(t=v.hasOwnProperty(e.name)?1:0),"Government"===e.type&&(t=g.hasOwnProperty(e.name)?1:0),t}).style("font-size","14px")}function pt(e){b=0,console.log("Clicked on node first"),Y(e),P.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),F.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),N.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),T.transition().duration(350).delay(0).style("opacity",function(t){return e===t.source||e===t.target?"1":"0.05"}),h.style("stroke",function(t){return t!==e?"white":"black"}).on("mouseout",null),h.filter(function(t){return t!==e?t:void 0}).on("mouseover",null);var t=S.funding_connections.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index}),n=S.investment_connections.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index}),i=S.collaboration_connections.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index}),l=S.data_connections.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});G.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(o){return t.indexOf(o.index)>-1||n.indexOf(o.index)>-1||i.indexOf(o.index)>-1||l.indexOf(o.index)>-1||o===e?1:.05}),h.filter(function(o){return t.indexOf(o.index)>-1||n.indexOf(o.index)>-1||i.indexOf(o.index)>-1||l.indexOf(o.index)>-1||o===e}).on("mouseover",Y).on("click",function(){})}function ft(){h.on("mouseover",null).on("mouseout",null).on("click",null)}function ht(){d3.select(this).classed("fixed",function(e){e.fixed=!0}),h.on("mouseover",ut).on("mouseout",dt).on("click",pt)}function yt(e){var n=8*e.alpha;E.forEach(function(e){null!==e.type&&("Individual"===e.type&&(e.x+=n+n,e.y+=n+n),"Non-Profit"===e.type&&(e.x+=-n-n,e.y+=n+n),"For-Profit"===e.type&&(e.x+=n+n,e.y+=-n-n),"Government"===e.type&&(e.x+=-n-n,e.y+=-n-n))}),_.isEmpty(C)?(P.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),F.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),N.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),T.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),h.attr("cx",function(e){return e.x=e.x}).attr("cy",function(e){return e.y=e.y}),c.attr("transform",t)):(P.attr("x1",function(e){return e.source===C?(e.source.x=C.x,console.log("Test"),e.source.x):e.source.x}).attr("y1",function(e){return e.source===C?(e.source.y=C.y,console.log("Test"),e.source.y):e.source.y}).attr("x2",function(e){return e.target===C?(e.target.x=C.x,console.log("Test"),e.target.x):e.target.x}).attr("y2",function(e){return e.target===C?(e.target.y=C.y,console.log("Test"),e.target.y):e.target.y}),F.attr("x1",function(e){return e.source===C?(e.source.x=C.x,console.log("Test"),e.source.x):e.source.x}).attr("y1",function(e){return e.source===C?(e.source.y=C.y,console.log("Test"),e.source.y):e.source.y}).attr("x2",function(e){return e.target===C?(e.target.x=C.x,console.log("Test"),e.target.x):e.target.x}).attr("y2",function(e){return e.target===C?(e.target.y=C.y,console.log("Test"),e.target.y):e.target.y}),N.attr("x1",function(e){return e.source===C?(e.source.x=C.x,console.log("Test"),e.source.x):e.source.x}).attr("y1",function(e){return e.source===C?(e.source.y=C.y,console.log("Test"),e.source.y):e.source.y}).attr("x2",function(e){return e.target===C?(e.target.x=C.x,console.log("Test"),e.target.x):e.target.x}).attr("y2",function(e){return e.target===C?(e.target.y=C.y,console.log("Test"),e.target.y):e.target.y}),T.attr("x1",function(e){return e.source===C?(e.source.x=C.x,console.log("Test"),e.source.x):e.source.x}).attr("y1",function(e){return e.source===C?(e.source.y=C.y,console.log("Test"),e.source.y):e.source.y}).attr("x2",function(e){return e.target===C?(e.target.x=C.x,console.log("Test"),e.target.x):e.target.x}).attr("y2",function(e){return e.target===C?(e.target.y=C.y,console.log("Test"),e.target.y):e.target.y}),h.attr("cx",function(e,t){return d3.select(h)[0][0].data()[t].name===C.name?(e.x=C.x,e.x):e.x=e.x}).attr("cy",function(e,t){return d3.select(h)[0][0].data()[t].name===C.name?(e.y=C.y,e.y):e.y=e.y}),c.attr("transform",t))}function mt(){for(var e=[],t=0;t<f[0].length;t++)"visible"===f[0][t].style.visibility&&e.push(t);var n=[];return f.filter(function(t,i){e.indexOf(i)>-1&&n.push(t)}),n}var vt=S.nodes,gt=S.funding_connections,bt=S.investment_connections,xt=S.collaboration_connections,kt=S.data_connections,_t=gt.concat(bt).concat(xt).concat(kt);E=vt.filter(function(e){return 1===e.render}),B=gt.filter(function(e){return 1===e.render}),O=bt.filter(function(e){return 1===e.render}),A=xt.filter(function(e){return 1===e.render}),I=kt.filter(function(e){return 1===e.render}),d=B.concat(O).concat(A).concat(I);var wt=d3.layout.force().nodes(vt).size([k,w]).links(_t).linkStrength(0).charge(function(e){return null!==e.employees?-6*z(e.employees):-25}).on("tick",yt).start(),ft=wt.drag().on("dragstart",ft).on("drag",ft).on("dragend",ht);for(P=G.selectAll(".fund").data(B).enter().append("line").attr("class","fund").style("stroke","rgb(111,93,168)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),F=G.selectAll(".invest").data(O).enter().append("line").attr("class","invest").style("stroke","rgb(38,114,114)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),N=G.selectAll(".porucs").data(A).enter().append("line").attr("class","porucs").style("stroke","rgb(235,232,38)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),T=G.selectAll(".data").data(I).enter().append("line").attr("class","data").style("stroke","rgb(191,72,150)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),f=G.selectAll(".node").data(E).enter().append("g").attr("class","node").style("visibility","visible").on("dblclick",q).call(ft),l=G.selectAll(".node").filter(function(e){return"For-Profit"===e.type}).sort(function(e,t){return e.weight-t.weight}),o=G.selectAll(".node").filter(function(e){return"Non-Profit"===e.type}).sort(function(e,t){return e.weight-t.weight}),a=G.selectAll(".node").filter(function(e){return"Individual"===e.type}).sort(function(e,t){return e.weight-t.weight}),r=G.selectAll(".node").filter(function(e){return"Government"===e.type}).sort(function(e,t){return e.weight-t.weight}),l.each(function(e,t){t>=l[0].length-5&&(y[e.name]=e.weight)}),o.each(function(e,t){t>=o[0].length-5&&(m[e.name]=e.weight)}),a.each(function(e,t){t>=a[0].length-5&&(v[e.name]=e.weight)}),r.each(function(e,t){t>=r[0].length-5&&(g[e.name]=e.weight)}),c=G.selectAll(".node").append("text").text(function(e){return e.nickname}).attr("x",0).attr("dy","0.1em").attr("y",function(e){return null!==e.employees?z(e.employees)+10:17}).style("opacity",function(e){var t;return"For-Profit"===e.type&&(t=y.hasOwnProperty(e.name)?1:0),"Non-Profit"===e.type&&(t=m.hasOwnProperty(e.name)?1:0),"Individual"===e.type&&(t=v.hasOwnProperty(e.name)?1:0),"Government"===e.type&&(t=g.hasOwnProperty(e.name)?1:0),t}).style("font-size","14px").style("color","#FFFFFF").style("pointer-events","none"),h=f.append("circle").attr("r",function(e){return null!==e.employees?z(e.employees):"7"}).style("fill",function(e){if(null!==e.type){if("Individual"===e.type)return"rgb(255,185,0)";if("Non-Profit"===e.type)return"rgb(0,164,239)";if("For-Profit"===e.type)return"rgb(127,186,0)";if("Government"===e.type)return"rgb(242,80,34)"}}).attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).style("stroke-width","1.5px").style("stroke","white").on("mouseover",ut).on("mouseout",dt).on("click",pt),c.call(e,80);wt.alpha()>.025;)wt.tick();d3.selectAll("#edit").on("click",L);var Et=[],At=[],It=[],Bt=[];rt(),d3.selectAll(".for-profit-entity").on("click",function(e,t){pt(Et[t])}),d3.selectAll(".non-profit-entity").on("click",function(e,t){pt(At[t])}),d3.selectAll(".individual-entity").on("click",function(e,t){pt(Bt[t])}),d3.selectAll(".government-entity").on("click",function(e,t){pt(It[t])}),d3.selectAll(".click-location").on("click",function(){st(this.innerHTML)});var Ot=[],Pt=[],$t=[],Ft=[],Nt=[],Tt=[],Ct=[];ct(),d3.selectAll("#search-text").on("keydown",function(){if(13===d3.event.keyCode){var e=document.getElementById("search-text").value;st(e)}}),d3.selectAll("option").on("keydown",function(e,t){if(console.log("Hello"),13===d3.event.keyCode){var n=d3.selectAll("option")[0][t].value;st(n)}}),d3.selectAll("#cb_fund").on("click",function(){var e=mt();if(document.getElementById("cb_fund").checked){var t=0;d3.selectAll(".fund").style("visibility",function(n){return e.indexOf(n.source)>-1&&e.indexOf(n.target)>-1&&"hidden"===this.style.visibility?(t++,"visible"):"hidden"})}document.getElementById("cb_fund").checked||d3.selectAll(".fund").style("visibility",function(){return"hidden"}),0!==e.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_fund").checked=!1)}),d3.selectAll("#cb_invest").on("click",function(){var e=mt();document.getElementById("cb_invest").checked&&d3.selectAll(".invest").style("visibility",function(t){return e.indexOf(t.source)>-1&&e.indexOf(t.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_invest").checked||d3.selectAll(".invest").style("visibility",function(){return"hidden"}),0!==e.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_invest").checked=!1)}),d3.selectAll("#cb_porucs").on("click",function(){var e=mt();document.getElementById("cb_porucs").checked&&d3.selectAll(".porucs").style("visibility",function(t){return e.indexOf(t.source)>-1&&e.indexOf(t.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_porucs").checked||d3.selectAll(".porucs").style("visibility",function(){return"hidden"}),0!==e.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_porucs").checked=!1)}),d3.selectAll("#cb_data").on("click",function(){var e=mt();document.getElementById("cb_data").checked&&d3.selectAll(".data").style("visibility",function(t){return e.indexOf(t.source)>-1&&e.indexOf(t.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_data").checked||d3.selectAll(".data").style("visibility",function(){return"hidden"}),0!==e.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_data").checked=!1)}),d3.selectAll("#cb_individ, #cb_nonpro, #cb_forpro, #cb_gov").on("click",function(){function e(){for(var e=arguments,t={},n=[],i=0;i<e.length;i++)for(var l=0;l<e[i].length;l++)t[e[i][l]]!==!0&&(n[n.length]=e[i][l],t[e[i][l]]=!0);return n}var t=[],n=[],i=[],l=[],o=[],a=[],r=[],c=[],s=[],u=[],d=[],p=[],f=[],h=[],y=[],m=[],v=[],g=[],b=[],x=[],k=[],_=[],w=[],$=[],C=[],G=[],S=[],q=[],Y=[],R=[],z=[],D=[],Q=[],j=[],L=[],W=[],M=[],K=[],X=[],J=[];document.getElementById("cb_individ").checked&&(d3.selectAll(".node").filter(function(e){return"Individual"===e.type?this:void 0}).style("visibility","visible"),o=0,E.forEach(function(e){"Individual"===e.type&&(B.forEach(function(n){(e===n.source||e===n.target)&&t.push(o),o++}),o=0)}),o=0,E.forEach(function(e){"Individual"===e.type&&(O.forEach(function(t){(e===t.source||e===t.target)&&n.push(o),o++}),o=0)}),o=0,E.forEach(function(e){"Individual"===e.type&&(A.forEach(function(t){(e===t.source||e===t.target)&&i.push(o),o++}),o=0)}),countIndex0=0,E.forEach(function(e){"Individual"===e.type&&(I.forEach(function(t){(e===t.source||e===t.target)&&l.push(countIndex0),countIndex0++}),countIndex0=0)})),document.getElementById("cb_individ").checked||(d3.selectAll(".node").filter(function(e){return"Individual"===e.type?this:void 0}).style("visibility","hidden"),C=0,E.forEach(function(e){"Individual"===e.type&&(B.forEach(function(t){(e===t.source||e===t.target)&&k.push(C),C++}),C=0)}),C=0,E.forEach(function(e){"Individual"===e.type&&(O.forEach(function(t){(e===t.source||e===t.target)&&_.push(C),C++}),C=0)}),C=0,E.forEach(function(e){"Individual"===e.type&&(A.forEach(function(t){(e===t.source||e===t.target)&&w.push(C),C++}),C=0)}),C=0,E.forEach(function(e){"Individual"===e.type&&(I.forEach(function(t){(e===t.source||e===t.target)&&$.push(C),C++}),C=0)})),document.getElementById("cb_nonpro").checked&&(d3.selectAll(".node").filter(function(e){return"Non-Profit"===e.type?this:void 0}).style("visibility","visible"),u=0,E.forEach(function(e){"Non-Profit"===e.type&&(B.forEach(function(t){e!==t.source&&e!==t.target||-1!==a.indexOf(u)||a.push(u),u++}),u=0)}),u=0,E.forEach(function(e){"Non-Profit"===e.type&&(O.forEach(function(t){e!==t.source&&e!==t.target||-1!==r.indexOf(u)||r.push(u),u++}),u=0)}),u=0,E.forEach(function(e){"Non-Profit"===e.type&&(A.forEach(function(t){e!==t.source&&e!==t.target||-1!==c.indexOf(u)||c.push(u),u++}),u=0)}),u=0,E.forEach(function(e){"Non-Profit"===e.type&&(I.forEach(function(t){e!==t.source&&e!==t.target||-1!==s.indexOf(u)||s.push(u),u++}),u=0)})),document.getElementById("cb_nonpro").checked||(d3.selectAll(".node").filter(function(e){return"Non-Profit"===e.type?this:void 0}).style("visibility","hidden"),R=0,E.forEach(function(e){"Non-Profit"===e.type&&(B.forEach(function(t){e!==t.source&&e!==t.target||-1!==G.indexOf(R)||G.push(R),R++}),R=0)}),R=0,E.forEach(function(e){"Non-Profit"===e.type&&(O.forEach(function(t){e!==t.source&&e!==t.target||-1!==S.indexOf(R)||S.push(R),R++}),R=0)}),R=0,E.forEach(function(e){"Non-Profit"===e.type&&(A.forEach(function(t){e!==t.source&&e!==t.target||-1!==q.indexOf(R)||q.push(R),R++}),R=0)}),R=0,E.forEach(function(e){"Non-Profit"===e.type&&(I.forEach(function(t){e!==t.source&&e!==t.target||-1!==Y.indexOf(R)||Y.push(R),R++}),R=0)})),document.getElementById("cb_forpro").checked&&(d3.selectAll(".node").filter(function(e){return"For-Profit"===e.type?this:void 0}).style("visibility","visible"),y=0,E.forEach(function(e){"For-Profit"===e.type&&(B.forEach(function(t){e!==t.source&&e!==t.target||-1!==d.indexOf(y)||d.push(y),y++}),y=0)}),y=0,E.forEach(function(e){"For-Profit"===e.type&&(O.forEach(function(t){e!==t.source&&e!==t.target||-1!==p.indexOf(y)||p.push(y),y++}),y=0)}),y=0,E.forEach(function(e){"For-Profit"===e.type&&(A.forEach(function(t){e!==t.source&&e!==t.target||-1!==f.indexOf(y)||f.push(y),y++}),y=0)}),y=0,E.forEach(function(e){"For-Profit"===e.type&&(I.forEach(function(t){e!==t.source&&e!==t.target||-1!==h.indexOf(y)||h.push(y),y++}),y=0)})),document.getElementById("cb_forpro").checked||(d3.selectAll(".node").filter(function(e){return"For-Profit"===e.type?this:void 0}).style("visibility","hidden"),L=0,E.forEach(function(e){"For-Profit"===e.type&&(B.forEach(function(t){e!==t.source&&e!==t.target||-1!==z.indexOf(L)||z.push(L),L++}),L=0)}),L=0,E.forEach(function(e){"For-Profit"===e.type&&(O.forEach(function(t){e!==t.source&&e!==t.target||-1!==D.indexOf(L)||D.push(L),L++}),L=0)}),L=0,E.forEach(function(e){"For-Profit"===e.type&&(A.forEach(function(t){e!==t.source&&e!==t.target||-1!==Q.indexOf(L)||Q.push(L),L++
}),L=0)}),L=0,E.forEach(function(e){"For-Profit"===e.type&&(I.forEach(function(t){e!==t.source&&e!==t.target||-1!==j.indexOf(L)||j.push(L),L++}),L=0)})),document.getElementById("cb_gov").checked&&(d3.selectAll(".node").filter(function(e){return"Government"===e.type?this:void 0}).style("visibility","visible"),x=0,E.forEach(function(e){"Government"===e.type&&(B.forEach(function(t){e!==t.source&&e!==t.target||-1!==m.indexOf(x)||m.push(x),x++}),x=0)}),x=0,E.forEach(function(e){"Government"===e.type&&(O.forEach(function(t){e!==t.source&&e!==t.target||-1!==v.indexOf(x)||v.push(x),x++}),x=0)}),x=0,E.forEach(function(e){"Government"===e.type&&(A.forEach(function(t){e!==t.source&&e!==t.target||-1!==g.indexOf(x)||g.push(x),x++}),x=0)}),x=0,E.forEach(function(e){"Government"===e.type&&(I.forEach(function(t){e!==t.source&&e!==t.target||-1!==b.indexOf(x)||b.push(x),x++}),x=0)})),document.getElementById("cb_gov").checked||(d3.selectAll(".node").filter(function(e){return"Government"===e.type?this:void 0}).style("visibility","hidden"),J=0,E.forEach(function(e){"Government"===e.type&&(B.forEach(function(t){e!==t.source&&e!==t.target||-1!==W.indexOf(J)||W.push(J),J++}),J=0)}),J=0,E.forEach(function(e){"Government"===e.type&&(O.forEach(function(t){e!==t.source&&e!==t.target||-1!==M.indexOf(J)||M.push(J),J++}),J=0)}),J=0,E.forEach(function(e){"Government"===e.type&&(A.forEach(function(t){e!==t.source&&e!==t.target||-1!==K.indexOf(J)||K.push(J),J++}),J=0)}),J=0,E.forEach(function(e){"Government"===e.type&&(I.forEach(function(t){e!==t.source&&e!==t.target||-1!==X.indexOf(J)||X.push(J),J++}),J=0)}));var H=[],V=[],U=[],Z=[];0!==t.length&&(H=e(H,t)),0!==a.length&&(H=H=e(H,a)),0!==d.length&&(H=e(H,d)),0!==m.length&&(H=e(H,m)),0!==n.length&&(V=e(V,n)),0!==r.length&&(V=e(V,r)),0!==p.length&&(V=e(V,p)),0!==v.length&&(V=e(V,v)),0!==i.length&&(U=e(U,i)),0!==c.length&&(U=e(U,c)),0!==f.length&&(U=e(U,f)),0!==g.length&&(U=e(U,g)),0!==l.length&&(Z=e(Z,l)),0!==s.length&&(Z=e(Z,s)),0!==h.length&&(Z=e(Z,h)),0!==b.length&&(Z=e(Z,b));var et=[],tt=[],nt=[],it=[];0!==k.length&&(et=e(et,k)),0!==G.length&&(et=e(et,G)),0!==z.length&&(et=e(et,z)),0!==W.length&&(et=e(et,W)),0!==_.length&&(tt=e(tt,_)),0!==S.length&&(tt=e(tt,S)),0!==D.length&&(tt=e(tt,D)),0!==M.length&&(tt=e(tt,M)),0!==w.length&&(nt=e(nt,w)),0!==q.length&&(nt=e(nt,q)),0!==Q.length&&(nt=e(nt,Q)),0!==K.length&&(nt=e(nt,K)),0!==$.length&&(it=e(it,$)),0!==Y.length&&(it=e(it,Y)),0!==j.length&&(it=e(it,j)),0!==X.length&&(it=e(it,X));var lt=[],ot=[],at=[],rt=[];document.getElementById("cb_fund").checked||P.filter(function(e,t){"hidden"===P[0][t].style.visibility&&lt.push(t)}),document.getElementById("cb_invest").checked||F.filter(function(e,t){"hidden"===F[0][t].style.visibility&&ot.push(t)}),document.getElementById("cb_porucs").checked||N.filter(function(e,t){"hidden"===N[0][t].style.visibility&&at.push(t)}),document.getElementById("cb_data").checked||T.filter(function(e,t){"hidden"===T[0][t].style.visibility&&rt.push(t)}),d3.selectAll(".fund").style("visibility",function(e,t){return H.indexOf(t)>-1?"visible":"hidden"}),d3.selectAll(".invest").style("visibility",function(e,t){return V.indexOf(t)>-1?"visible":"hidden"}),d3.selectAll(".porucs").style("visibility",function(e,t){return U.indexOf(t)>-1?"visible":"hidden"}),d3.selectAll(".data").style("visibility",function(e,t){return Z.indexOf(t)>-1?"visible":"hidden"}),d3.selectAll(".fund").style("visibility",function(e,t){return et.indexOf(t)>-1||lt.indexOf(t)>-1?"hidden":"visible"}),d3.selectAll(".invest").style("visibility",function(e,t){return tt.indexOf(t)>-1||ot.indexOf(t)>-1?"hidden":"visible"}),d3.selectAll(".porucs").style("visibility",function(e,t){return nt.indexOf(t)>-1||at.indexOf(t)>-1?"hidden":"visible"}),d3.selectAll(".data").style("visibility",function(e,t){return it.indexOf(t)>-1||rt.indexOf(t)>-1?"hidden":"visible"});for(var ct=0,st=0;st<P[0].length;st++)"hidden"===P[0][st].style.visibility&&ct++;for(var ut=0,st=0;st<F[0].length;st++)"hidden"===F[0][st].style.visibility&&ut++;for(var dt=0,st=0;st<N[0].length;st++)"hidden"===N[0][st].style.visibility&&dt++;for(var pt=0,st=0;st<T[0].length;st++)"hidden"===T[0][st].style.visibility&&pt++;ct===P[0].length&&document.getElementById("cb_fund").checked&&(document.getElementById("cb_fund").checked=!1),ct!==P[0].length&&(document.getElementById("cb_fund").checked||(document.getElementById("cb_fund").checked=!0)),ut===F[0].length&&document.getElementById("cb_invest").checked&&(document.getElementById("cb_invest").checked=!1),ut!==F[0].length&&(document.getElementById("cb_invest").checked||(document.getElementById("cb_invest").checked=!0)),dt===N[0].length&&document.getElementById("cb_porucs").checked&&(document.getElementById("cb_porucs").checked=!1),dt!==N[0].length&&(document.getElementById("cb_porucs").checked||(document.getElementById("cb_porucs").checked=!0)),pt===T[0].length&&document.getElementById("cb_data").checked&&(document.getElementById("cb_data").checked=!1),pt!==T[0].length&&(document.getElementById("cb_data").checked||(document.getElementById("cb_data").checked=!0))}),d3.selectAll("#cb_emp, #cb_numtwit").on("click",function(){document.getElementById("cb_emp").checked&&(h.transition().duration(350).delay(0).attr("r",function(e){return null!==e.employees?z(e.employees):"7"}),c.attr("transform",function(e){return null!==e.employees?n(0,-z(e.employees)):n(0,-7)})),document.getElementById("cb_numtwit").checked&&(h.transition().duration(350).delay(0).attr("r",function(e){return null!==e.followers?e.followers>1e6?"50":D(e.followers):"7"}),c.attr("transform",function(e){return null!==e.followers?n(0,-D(e.followers)):n(0,-7)}))}),d3.select("svg").on("click",function(){console.log("Clicked on SVG");var e=d3.mouse(this);if(console.log(e),1===b){d3.event.preventDefault(),dt(),d3.selectAll("g").classed("fixed",function(e){e.fixed=!1}),d3.selectAll("g").call(ft),C=jQuery.extend(!0,{},{}),console.log(y);{d3.layout.force().nodes(vt).size([k,w]).links(_t).linkStrength(0).charge(function(e){return null!==e.employees?-6*z(e.employees):-25}).on("tick",yt).start()}}b=1})})}();