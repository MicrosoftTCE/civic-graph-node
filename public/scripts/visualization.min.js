!function(){function a(a,b){a.each(function(){var a,c=d3.select(this),d=c.text().split(/\s+/).reverse(),e=[],f=0,g=1.1,h=parseFloat(c.attr("dy")),i=d3.select(this)[0][0].__data__,j=c.text(null).append("tspan").attr("x",0).attr("y",function(){return null!==i.employees?M(i.employees)+10:17}).attr("dy",h+"em");for(console.log(c);a=d.pop();)e.push(a),j.text(e.join(" ")),j.node().getComputedTextLength()>b&&(e.pop(),j.text(e.join(" ")),e=[a],f++,j=c.append("tspan").attr("x",0).attr("y",function(){return null!==i.employees?M(i.employees)+5:12}).attr("dy",f*g+h+"em").text(a))})}function b(a){return"translate("+a.x+","+a.y+")"}function c(a,b){return"translate("+a+","+b+")"}function d(a){a+="",x=a.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var b=/(\d+)(\d{3})/;b.test(x1);)x1=x1.replace(b,"$1,$2");return x1+x2}d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var a=this.parentNode.firstChild;a&&this.parentNode.insertBefore(this,a)})};var e,f,g,h,i,j,k,l,m,n,o={},p={},q={},r={},t=1,u=(d3.scale.category20(),1e3),v=1e3,w={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H=d3.select(".content").append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("id","network").attr("height",v).attr("width",u);d3.select("body > nav > nav > div").append("div").attr("id","editBox").append("p").text("Edit").style("color","#2e92cf");var I=u/v,J=$("#network"),K=J.parent();$(window).on("resize",function(){var a=K.width();J.attr("width",a),J.attr("height",Math.round(a/I))}).trigger("resize");var L="0 0 "+u+" "+v;H.attr("viewBox",L).attr("preserveAspectRatio","xMidYMid");var M=d3.scale.sqrt().domain([10,13e4]).range([10,50]),N=d3.scale.sqrt().domain([10,1e6]).range([10,50]);d3.json("/athena",function(x,I){function J(a){d3.select(this).classed("fixed",function(a){a.fixed=!1}),d3.select(this).on("mousedown.drag",null),j=d3.select(this).data()[0];{var b=parseInt(H.style("width").substring(0,(H.style("width").length+1)/2)),c=parseInt(H.style("height").substring(0,(H.style("height").length+1)/2));parseInt(b/2),parseInt(c/2)}multiplierX=b/u,multiplierY=c/v,scaledDX=multiplierX*a.x,scaledDY=multiplierY*a.y,G=jQuery.extend(!0,{},a),G.x=u/2-10,G.y=v/2-60;d3.layout.force().nodes(rb).size([u,v]).links(wb).linkStrength(0).charge(function(a){return null!==a.employees?-6*M(a.employees):-25}).on("tick",pb).resume()}function K(a){s=P(a),webform=O(a),d3.select("#edit").html(webform),d3.select("#info").html(s).style("list-style","square"),d3.selectAll("#editCurrentInfo").on("click",function(){L(a)}).on("mouseover",function(){return d3.select(this).style("cursor","pointer"),d3.select("#editBox").style("visibility","visible")}).on("mousemove",function(){return console.log(d3.event.pageY),console.log(d3.event.pageX),d3.select("#editBox").style("top",d3.event.pageY+4+"px").style("left",d3.event.pageX+16+"px")}).on("mouseout",function(){return d3.select("#editBox").style("visibility","hidden")})}function L(a){console.log(a),Q(),fb(a)}function O(){var a="";return a+='<h1 id="edit-add-info"><i class="icon-plus on-left"></i>Add Information</h1>'}function P(a){var b="";if(b+='<div style="height:30px"><a style="float:right;"><i id="editCurrentInfo" class="icon-pencil on-left"></i></a></div>',b+='<h1><a href="'+a.url+'" target="_blank">'+a.name+"</a></h1>",b+="<h6>Type of Entity: </h6> <h5>"+a.type+"</h5>",null!==a.location){b+="<br/><h6> Location:  </h6>";var c=[];if(-1!==a.location.indexOf("; ")){b+="<br/> <h5><ul>",c=a.location.split("; ");for(var e=0;e<c.length;e++)b+='<li style="display:block;"><h5><a class="click-location" style="cursor:pointer;">'+c[e]+"</h5></a></li>"}else b+="<h5><ul>",b+='<li style="display:inline-block;"><h5><a class="click-location" style="cursor:pointer;">'+a.location+"</h5></a></li>";b+="</h5></ul><br/>"}else b+="<br/><h6> Location:  </h6> <h5>N/A</h5><br/>";if("Individual"!==a.type&&(b+=null!==a.employees?"<h6>Employees: </h6> <h5>"+d(a.employees.toString())+"</h5><br/>":"<h6>Employees: </h6> <h5>N/A</h5><br/>"),null===a.twitter_handle)b+="<h6>Twitter:  </h6> <h5>N/A</h5><br/>",b+="<h6>Twitter Followers: </h6> <h5>N/A</h5><br/>";else{var f=a.twitter_handle.replace("@","");f="https://twitter.com/"+f,b+='<h6>Twitter:  </h6> <h5><a href="'+f+'" target="_blank">'+a.twitter_handle+"</h5></a><br/>",b+=null!==a.followers?"<h6>Twitter Followers:  </h6> <h5>"+d(a.followers.toString())+"</h5><br/>":"<h6>Twitter Followers:  </h6> <h5>N/A</h5><br/>"}if(null!==a.key_people){b+="<br/><h6>Key People:</h6><ul><h5>";for(var e=0;e<a.key_people.length;e++)b+='<li><a href="http://www.bing.com/search?q='+a.key_people[e].replace(" ","%20")+"%20"+a.nickname.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.key_people[e]+"</a></li>";b+="</h5></ul>"}return null===a.funding_received?b+="<br/><h6>No known funding received.</h6><br/>":(b+="<br/><h6>Received funding from:</h6><ul>",a.funding_received.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.funding_given?b+="<br/><h6>No known funding provided.</h6><br/>":(b+="<br/><h6>Gave funding to:</h6><ul>",a.funding_given.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.investments_received?b+="<br/><h6>No known investments received.</h6><br/>":(b+="<br/><h6>Received investments from:</h6><ul>",a.investments_received.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.investments_made?b+="<br/><h6>No known investments made.</h6><br/>":(b+="<br/><h6>Invested in:</h6><ul>",a.investments_made.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.collaborations?b+="<br/><h6>No known collaborations.</h6><br/>":(b+="<br/><h6>Collaborated with:</h6><ul>",a.collaborations.forEach(function(a){b+='<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+"</a></h5></li>"}),b+="</ul>"),null===a.data?b+="<br/><h6>No known external data usage.</h6><br/>":(b+="<br/><h6>Obtained data from:</h6><ul>",a.data.forEach(function(a){b+='<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+"</a></h5></li>"}),b+="</ul>"),db(a),b}function Q(){d3.select("#edit-add-info").html('<i class=" icon-file on-left"></i>Reset Form').on("click",Q),n.on("mouseover",null),sa=db(),d3.select("#info").html(sa),d3.select('#key-people-0 input[name="kpeople"]').on("keyup",function(){U(0)}),d3.select('#funding-0 input[name="fund"]').on("keyup",function(){V(0)}),d3.select('#investing-0 input[name="invest"]').on("keyup",function(){W(0)}),d3.select('#fundinggiven-0 input[name="fundgiven"]').on("keyup",function(){X(0)}),d3.select('#investmentmade-0 input[name="investmade"]').on("keyup",function(){Y(0)}),d3.select('#data-0 input[name="data"]').on("keyup",function(){Z(0)}),d3.select("#toFormC").on("click",function(){displayFormC()}),d3.selectAll("#submit-A").on("click",function(){d3.select("#name").style("border-color","#d9d9d9"),d3.select("#location").style("border-color","#d9d9d9"),T()})}function R(){var a={type:null,categories:null,name:null,nickname:null,location:null,url:null,employees:null,key_people:null,twitter_handle:null,followers:null,relations:null,funding_received:null,investments_received:null,funding_given:null,investments_made:null,collaborations:null,data:null,revenue:null,expenses:null,influence:null};if(""===$('input[name="name"]').val()&&""===$('input[name="location"]').val())return console.log("The entity name and location have not been filled out."),{name:null,location:null,errorMessage:"The entity name and location have not been filled out."};if(""===$('input[name="name"]').val())return console.log("The entity name has not been filled out."),{name:null,errorMessage:"The entity name has not been filled out."};if(""===$('input[name="location"]').val())return console.log("The location has not been filled out."),{location:null,errorMessage:"The location has not been filled out."};a.type=$("input#rb_forpro").is(":checked")?"For-Profit":$("input#rb_nonpro").is(":checked")?"Non-Profit":$("input#rb_gov").is(":checked")?"Government":"Individual",a.name=d3.select(".webform-content input[name='name']")[0][0].value,a.categories=[],d3.selectAll(".webform-categories input").filter(function(){if(this.checked===!0)switch(this.value){case"General":a.categories.push("General");break;case"DataTrans":a.categories.push("Data Transparency");break;case"CJobsOpp":a.categories.push("21st Century Jobs and Opportunities");break;case"SRCities":a.categories.push("Smart and Resilient Cities")}}),0===a.categories.length&&(a.categories=null),a.location=d3.select("input[name='location']")[0][0].value,a.url="",a.url=""===d3.select("input[name='website']")[0][0].value?null:d3.select("input[name='website']")[0][0].value,a.employees="",a.employees=""===d3.select("input[name='employees']")[0][0].value?null:parseInt(d3.select("input[name='employees']")[0][0].value),a.key_people=[],d3.selectAll(".kpeople").filter(function(){""!==this.value&&a.key_people.push(this.value)}),0===a.key_people.length&&(a.key_people=null),a.funding_received=[];var b;d3.selectAll(".fund-input .funder").filter(function(c,d){this.value&&(d3.selectAll(".fund_amt")[0][d].value?(b=d3.selectAll(".fund_amt")[0][d].value,a.funding_received.push(d3.selectAll(".fund_year")[0][d].value?{name:this.value,amount:b,year:d3.selectAll(".fund_year")[0][d].value}:{name:this.value,amount:b,year:null})):(b=null,a.funding_received.push(d3.selectAll(".fund_year")[0][d].value?{name:this.value,amount:b,year:d3.selectAll(".fund_year")[0][d].value}:{name:this.value,amount:b,year:null})))}),0===a.funding_received.length&&(a.funding_received=null),a.funding_given=[];var c;d3.selectAll(".fundgiven-input .fundee").filter(function(b,d){this.value&&(d3.selectAll(".fundgiven_amt")[0][d].value?(c=d3.selectAll(".fundgiven_amt")[0][d].value,a.funding_given.push(d3.selectAll(".fundgiven_year")[0][d].value?{name:this.value,amount:c,year:d3.selectAll(".fundgiven_year")[0][d].value}:{name:this.value,amount:c,year:null})):(c=null,a.funding_given.push(d3.selectAll(".fundgiven_year")[0][d].value?{name:this.value,amount:c,year:d3.selectAll(".fundgiven_year")[0][d].value}:{name:this.value,amount:c,year:null})))}),0===a.funding_given.length&&(a.funding_given=null),a.investments_received=[];var d;d3.selectAll(".invest-input .investor").filter(function(b,c){this.value&&(d3.selectAll(".invest_amt")[0][c].value?(d=d3.selectAll(".invest_amt")[0][c].value,a.investments_received.push(d3.selectAll(".invest_year")[0][c].value?{name:this.value,amount:d,year:d3.selectAll(".invest_year")[0][c].value}:{name:this.value,amount:d,year:null})):(d=null,a.investments_received.push(d3.selectAll(".invest_year")[0][c].value?{name:this.value,amount:d,year:d3.selectAll(".invest_year")[0][c].value}:{name:this.value,amount:d,year:null})))}),0===a.investments_received.length&&(a.investments_received=null),a.investments_made=[];var e;return d3.selectAll(".investmade-input .investee").filter(function(b,c){this.value&&(d3.selectAll(".investmade_amt")[0][c].value?(e=d3.selectAll(".investmade_amt")[0][c].value,a.investments_made.push(d3.selectAll(".investmade_year")[0][c].value?{name:this.value,amount:e,year:d3.selectAll(".investmade_year")[0][c].value}:{name:this.value,amount:e,year:null})):(e=null,a.investments_made.push(d3.selectAll(".investmade_year")[0][c].value?{name:this.value,amount:e,year:d3.selectAll(".investmade_year")[0][c].value}:{name:this.value,amount:e,year:null})))}),0===a.investments_made.length&&(a.investments_made=null),a.data=[],d3.selectAll(".data-entity").filter(function(){""!==this.value&&a.data.push(this.value)}),0===a.data.length&&(a.data=null),a}function S(a){a.nickname=d3.select(".webform-content input[name='nickname']")[0][0].value,a.nickname||(a.nickname=a.name),a.twitter_handle=d3.select(".webform-content input[name='twitterhandle']")[0][0].value,a.twitter_handle||(a.twitter_handle=null),a.influence=$(".webform-influence input#rb_local").is(":checked")?"local":"global",a.collaborations=[],d3.selectAll(".collaborator").filter(function(){this.value&&a.collaborations.push(this.value)}),0===a.collaborations.length&&(a.collaborations=null),a.revenue=[];var b;d3.selectAll(".revenue-input .revenue_amt").filter(function(c,d){this.value&&(b=d3.selectAll(".revenue-input .revenue_year")[0][d].value,a.revenue.push(b?{amount:this.value,year:b}:{amount:this.value,year:null}))}),0===a.revenue.length&&(a.revenue=null),a.expenses=[];var c;return d3.selectAll(".expense-input .expense_amt").filter(function(b,d){this.value&&(c=d3.selectAll(".expense-input .expense_year")[0][d].value,a.expenses.push(c?{amount:this.value,year:c}:{amount:this.value,year:null}))}),0===a.expenses.length&&(a.expenses=null),console.log(a),a}function T(){var a=R();a.location&&a.name?(counterKey=0,counterK=0,counterFund=0,counterF=0,s="",s+='<h2 id="webform-head">Information</h2><hr/> < div class = "webform-content" >                                 < div class = "input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "name"\n              id = "name"\n              placeholder = "Name of Entity" / >                 < /div> < h3 class = "form-header" > Entity Type < /h\n              3 >  < div class = "webform-entities" >                 < div data - role = "input-control"\n              class = "input-control radio default-style webform" >                 < label >                 < input id = "rb_forpro"\n              type = "radio"\n              name = "entitytype"\n              value = "For-Profit"\n              checked = "checked" / > < span class = "check" > < /span> < h4 class = "webform-labels" > For - Profit < /h\n              4 >  < /label> < /div >  < div data - role = "input-control"\n              class = "input-control radio default-style webform" >                 < label >                 < input id = "rb_nonpro"\n              type = "radio"\n              name = "entitytype"\n              value = "Non-Profit" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Non - Profit < /h\n              4 >  < /label> < /div >  < div data - role = "input-control"\n              class = "input-control radio default-style webform" >                 < label >                 < input id = "rb_gov"\n              type = "radio"\n              name = "entitytype"\n              value = "Government" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Government < /h\n              4 >  < /label> < /div >  < div data - role = "input-control"\n              class = "input-control radio default-style webform" >                 < label >                 < input id = "rb_individs"\n              type = "radio"\n              name = "entitytype"\n              value = "Individual" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Individual < /h\n              4 >  < /label> < /div >  < /div> < div class = "input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "location"\n              id = "location"\n              placeholder = "City, State" / >                 < /div>              ',s+='<hr/> < div class = "input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "nickname"\n              id = "nickname"\n              placeholder = "Nickname/Abbr." / >                 < /div> < div class = "input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "twitterhandle"\n              id = "twitterhandle"\n              placeholder = "Twitter Handle" / >                 < /div> < h3 class = "form-header"\n              style = "display:inline-block;" > Circle of Influence: < /h3> < div class = "webform-influence" >  < div data - role = "input-control"\n              class = "input-control radio default-style webform" >                 < label >                 < input id = "rb_local"\n              type = "radio"\n              name = "influence-type"\n              value = "Local Influence"\n              checked = "checked" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Local Influence < /h\n              4 >  < /label> < /div >  < div data - role = "input-control"\n              class = "input-control radio default-style webform" >                 < label >                 < input id = "rb_global"\n              type = "radio"\n              name = "influence-type"\n              value = "Global Influence"\n              checked = "checked" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Global Influence < /h\n              4 >  < /label> < /div >  < /div> < h3 class = "form-header" > Collaboration < /h\n              3 >  < div id = "collaboration-0"\n              class = "input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "collaboration"\n              class = "collaborator"\n              placeholder = "Collaborator" / >                 < /div> < h3 class = "form-header" > Revenue < /h\n              3 >  < div id = "revenue-0" >                 < div class = "revenue-input input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "revenue_amt"\n              class = "revenue_amt"\n              placeholder = "Amount"\n              style = "display:inline-block; width: 57%;" / >                 < input type = "text"\n              name = "revenue_year"\n              class = "revenue_year"\n              placeholder = "Year"\n              style = "display:inline-block; width: 20%;" / >                 < /div> < /div >  < h3 class = "form-header" > Expenses < /h3> < div id = "expense-0" >  < div class = "expense-input input-control text"\n              data - role = "input-control" >                 < input type = "text"\n              name = "expense_amt"\n              class = "expense_amt"\n              placeholder = "Amount"\n              style = "display:inline-block; width: 57%;" / >                 < input type = "text"\n              name = "expense_year"\n              class = "expense_year"\n              placeholder = "Year"\n              style = "display:inline-block; width: 20%;" / >                 < /div> < /div >  < button type = "button"\n              id = "submit-B"\n              href = "javascript: check_empty()" > Submit < /button> < /div > ',d3.select("#info").html(s),d3.selectAll("#name").text(function(){console.log(a.name),this.value=a.name}).attr("disabled",!0),d3.selectAll("#location").text(function(){this.value=a.location}).attr("disabled",!0).style("margin-top","10px"),d3.selectAll('input[name="entitytype"]').filter(function(){this.checked=this.value===a.type?!0:!1,this.disabled=!0}),d3.selectAll('input[name="collaboration"]').on("keyup",function(){ab(0)}),d3.selectAll('input[name="revenue_amt"]').on("keyup",function(){bb(0)}),d3.selectAll('input[name="expense_amt"]').on("keyup",function(){cb(0)}),d3.selectAll("#submit-B").on("click",function(){eb(a)})):a.name||a.location?a.name?d3.select("#location").style("border-color","#e51400"):d3.select("#name").style("border-color","#e51400"):(d3.select("#name").style("border-color","#e51400"),d3.select("#location").style("border-color","#e51400"))}function U(a){""!==$("#key-people-"+a+' input[name="kpeople"]').val()&&(d3.select("#key-people-"+a+' input[name="kpeople"]').on("keyup",null),a++,console.log(a),$("#key-people-"+(a-1)).after('<div id="key-people-'+a+'" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name"/></div>'),d3.select("#key-people-"+a+" input[name='kpeople']").on("keyup",function(){U(a)}))}function V(a){""!==$("#funding-"+a+' input[name="fund"]').val()&&(d3.select("#funding-"+a+' input[name="fund"]').on("keyup",null),a++,console.log(a),$("#funding-"+(a-1)).after('<div id="funding-'+a+'"><div class="fund-input input-control text" data-role="input-control"> < input type = "text"\n                  name = "fund"\n                  class = "funder"\n                  placeholder = "Funder"\n                  style = "display:inline-block; width:50%;" / >                   < input type = "text"\n                  name = "fund_amt"\n                  class = "fund_amt"\n                  placeholder = "Amount"\n                  style = "display:inline-block; width: 27%;" / >                   < input type = "text"\n                  name = "fund_year"\n                  class = "fund_year"\n                  placeholder = "Year"\n                  style = "display:inline-block; width: 20%;" / >                   < /div></div > '),d3.select("#funding-"+a+" input[name='fund']").on("keyup",function(){V(a)}))}function W(a){""!==$("#investing-"+a+' input[name="invest"]').val()&&(d3.select("#investing-"+a+' input[name="invest"]').on("keyup",null),a++,console.log(a),$("#investing-"+(a-1)).after('<div id="investing-'+a+'"><div class="invest-input input-control text" data-role="input-control"> < input type = "text"\n                      name = "invest"\n                      class = "investor"\n                      placeholder = "Investor"\n                      style = "display:inline-block; width:50%;" / >                       < input type = "text"\n                      name = "invest_amt"\n                      class = "invest_amt"\n                      placeholder = "Amount"\n                      style = "display:inline-block; width: 27%;" / >                       < input type = "text"\n                      name = "invest_year"\n                      class = "invest_year"\n                      placeholder = "Year"\n                      style = "display:inline-block; width: 20%;" / >                       < /div></div > '),d3.select("#investing-"+a+" input[name='invest']").on("keyup",function(){W(a)}))}function X(a){""!==$("#fundinggiven-"+a+' input[name="fundgiven"]').val()&&(d3.select("#fundinggiven-"+a+' input[name="fundgiven"]').on("keyup",null),a++,console.log(a),$("#fundinggiven-"+(a-1)).after('<div id="fundinggiven-'+a+'"><div class="fundgiven-input input-control text" data-role="input-control"> < input type = "text"\n                          name = "fundgiven"\n                          class = "fundee"\n                          placeholder = "Fundee"\n                          style = "display:inline-block; width:50%;" / >                           < input type = "text"\n                          name = "fundgiven_amt"\n                          class = "fundgiven_amt"\n                          placeholder = "Amount"\n                          style = "display:inline-block; width: 27%;" / >                           < input type = "text"\n                          name = "fundgiven_year"\n                          class = "fundgiven_year"\n                          placeholder = "Year"\n                          style = "display:inline-block; width: 20%;" / >                           < /div></div > '),d3.select("#fundinggiven-"+a+" input[name='fundgiven']").on("keyup",function(){X(a)}))}function Y(a){""!==$("#investmentmade-"+a+' input[name="investmade"]').val()&&(d3.select("#investmentmade-"+a+' input[name="investmade"]').on("keyup",null),a++,console.log(a),$("#investmentmade-"+(a-1)).after('<div id="investmentmade-'+a+'"><div class="investmade-input input-control text" data-role="input-control"> < input type = "text"\n                              name = "investmade"\n                              class = "investee"\n                              placeholder = "Investee"\n                              style = "display:inline-block; width:50%;" / >                               < input type = "text"\n                              name = "investmade_amt"\n                              class = "investmade_amt"\n                              placeholder = "Amount"\n                              style = "display:inline-block; width: 27%;" / >                               < input type = "text"\n                              name = "investmade_year"\n                              class = "investmade_year"\n                              placeholder = "Year"\n                              style = "display:inline-block; width: 20%;" / >                               < /div></div > '),d3.select("#investmentmade-"+a+" input[name='investmade']").on("keyup",function(){Y(a)}))}function Z(a){""!==$("#data-"+a+' input[name="data"]').val()&&(d3.select("#data-"+a+' input[name="data"]').on("keyup",null),a++,console.log(a),$("#data-"+(a-1)).after('<div id="data-'+a+'" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div>'),d3.select("#data-"+a+" input[name='data']").on("keyup",function(){Z(a)}))}function ab(a){""!==$("#collaboration-"+a+' input[name="collaboration"]').val()&&(d3.select("#collaboration-"+a+' input[name="collaboration"]').on("keyup",null),a++,console.log(a),$("#collaboration-"+(a-1)).after('<div id="collaboration-'+a+'" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div>'),d3.select("#collaboration-"+a+" input[name='collaboration']").on("keyup",function(){ab(a)}))}function bb(a){""!==$("#revenue-"+a+' input[name="revenue_amt"]').val()&&(d3.select("#revenue-"+a+' input[name="revenue_amt"]').on("keyup",null),a++,console.log(a),$("#revenue-"+(a-1)).after('<div id="revenue-'+a+'"><div class="revenue-input input-control text" data-role="input-control"> < input type = "text"\n                                  name = "revenue_amt"\n                                  class = "revenue_amt"\n                                  placeholder = "Amount"\n                                  style = "display:inline-block; width: 57%;" / >                                   < input type = "text"\n                                  name = "revenue_year"\n                                  class = "revenue_year"\n                                  placeholder = "Year"\n                                  style = "display:inline-block; width: 20%;" / >                                   < /div></div > '),d3.select("#revenue-"+a+" input[name=revenue_amt]").on("keyup",function(){bb(a)}))}function cb(a){""!==$("#expense-"+a+' input[name="expense_amt"]').val()&&(d3.select("#expense-"+a+' input[name="expense_amt"]').on("keyup",null),a++,console.log(a),$("#expense-"+(a-1)).after('<div id="expense-'+a+'"><div class="expense-input input-control text" data-role="input-control"> < input type = "text"\n                                      name = "expense_amt"\n                                      class = "expense_amt"\n                                      placeholder = "Amount"\n                                      style = "display:inline-block; width: 57%;" / >                                       < input type = "text"\n                                      name = "expense_year"\n                                      class = "expense_year"\n                                      placeholder = "Year"\n                                      style = "display:inline-block; width: 20%;" / >                                       < /div></div > '),d3.select("#expense-"+a+" input[name=expense_amt]").on("keyup",function(){cb(a)}))}function db(){return s="",s+='<h2 id="webform-head">Information</h2><hr/> < div class = "webform-content" >                                                                             < div class = "input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "name"\n                                    id = "name"\n                                    placeholder = "Name of Entity" / >                                       < /div> < h3 class = "form-header" > What type of entity ? < /h\n                                    3 >  < div class = "webform-entities" >                                       < div data - role = "input-control"\n                                    class = "input-control radio default-style webform" >                                       < label >                                       < input id = "rb_forpro"\n                                    type = "radio"\n                                    name = "entitytype"\n                                    value = "For-Profit"\n                                    checked = "checked" / > < span class = "check" > < /span> < h4 class = "webform-labels" > For - Profit < /h\n                                    4 >  < /label> < /div >  < div data - role = "input-control"\n                                    class = "input-control radio default-style webform" >                                       < label >                                       < input id = "rb_nonpro"\n                                    type = "radio"\n                                    name = "entitytype"\n                                    value = "Non-Profit" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Non - Profit < /h\n                                    4 >  < /label> < /div >  < div data - role = "input-control"\n                                    class = "input-control radio default-style webform" >                                       < label >                                       < input id = "rb_gov"\n                                    type = "radio"\n                                    name = "entitytype"\n                                    value = "Government" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Government < /h\n                                    4 >  < /label> < /div >  < div data - role = "input-control"\n                                    class = "input-control radio default-style webform" >                                       < label >                                       < input id = "rb_individs"\n                                    type = "radio"\n                                    name = "entitytype"\n                                    value = "Individual" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Individual < /h\n                                    4 >  < /label> < /div >  < /div> < h3 class = "form-header" > What type(s) of work do they do ? < /h\n                                    3 > < h4 > (Select All That Apply) < /h\n                                    4 >                                       <\n                                      div class = "webform-categories" >                                       < div data - role = "input-control"\n                                    class = "input-control checkbox webform" >                                       <\n                                      label >                                       < input id = "cb_gen"\n                                    type = "checkbox"\n                                    name = "gen"\n                                    data - show = "general"\n                                    value = "General" / > < span class = "check" > < /span> < h4 class = "webform-labels" > General < /h\n                                    4 >  < /label> < /div >  < div data - role = "input-control"\n                                    class = "input-control checkbox webform" >                                       < label >                                       < input id = "cb_datat"\n                                    type = "checkbox"\n                                    name = "datat"\n                                    data - show = "datatrans"\n                                    value = "DataTrans" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Data Transparency < /h\n                                    4 >  < /label> < /div >  < div data - role = "input-control"\n                                    class = "input-control checkbox webform" >                                       < label >                                       < input id = "cb_cjao"\n                                    type = "checkbox"\n                                    name = "cjao"\n                                    data - show = "cjobsopp"\n                                    value = "CJobsOpp" / > < span class = "check" > < /span> < h4 class = "webform-labels" > 21 st Century Jobs and Opportunities < /h\n                                    4 >  < /label> < /div >  < div data - role = "input-control"\n                                    class = "input-control checkbox webform" >                                       < label >                                       < input id = "cb_src"\n                                    type = "checkbox"\n                                    name = "src"\n                                    data - show = "srcities"\n                                    value = "SRCities" / > < span class = "check" > < /span> < h4 class = "webform-labels" > Smart and Resilient Cities < /h\n                                    4 >  < /label> < /div >  < /div> < div class = "input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "location"\n                                    id = "location"\n                                    placeholder = "City, State" / >                                       < /div> < div class = "input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "website"\n                                    id = "website"\n                                    placeholder = "Website" / >                                       < /div> < h3 class = "form-header"\n                                    style = "display:inline-block;" > Number of Employees < /h3> < div class = "input-control text"\n                                    data - role = "input-control"\n                                    style = "width:27% !important; display:inline-block; float:right; margin-top: 2%;" >                                       < input type = "text"\n                                    name = "employees"\n                                    id = "employee"\n                                    maxlength = "6"\n                                    style = "width:100% !important;" / >                                       < /div> < h3 class = "form-header" > Key People ? < /h\n                                    3 >  < div id = "key-people-0"\n                                    class = "input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "kpeople"\n                                    class = "kpeople"\n                                    placeholder = "Key Person\'s Name" / >                                       < /div> < h3 class = "form-header" > Who funds them via grants ? < /h\n                                    3 >  < div id = "funding-0" >                                       < div class = "fund-input input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "fund"\n                                    class = "funder"\n                                    placeholder = "Funder"\n                                    style = "display:inline-block; width:50%;" / >                                       < input type = "text"\n                                    name = "fund_amt"\n                                    class = "fund_amt"\n                                    placeholder = "Amount"\n                                    style = "display:inline-block; width: 27%;" / >                                       < input type = "text"\n                                    name = "fund_year"\n                                    class = "fund_year"\n                                    placeholder = "Year"\n                                    style = "display:inline-block; width: 20%;" / >                                       < /div> < /div >  < h3 class = "form-header" > Who invests in them via equity stakes(stock) ? < /h3> < div id = "investing-0" >  < div class = "invest-input input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "invest"\n                                    class = "investor"\n                                    placeholder = "Investor"\n                                    style = "display:inline-block; width:50%;" / >                                       < input type = "text"\n                                    name = "invest_amt"\n                                    class = "invest_amt"\n                                    placeholder = "Amount"\n                                    style = "display:inline-block; width: 27%;" / >                                       < input type = "text"\n                                    name = "invest_year"\n                                    class = "invest_year"\n                                    placeholder = "Year"\n                                    style = "display:inline-block; width: 20%;" / >                                       < /div> < /div >  < h3 class = "form-header" > Who do they fund via grants ? < /h3> < div id = "fundinggiven-0" >  < div class = "fundgiven-input input-control text"\n                                    data -\n                                      role = "input-control" >                                       < input type = "text"\n                                    name = "fundgiven"\n                                    class = "fundee"\n                                    placeholder = "Fundee"\n                                    style = "display:inline-block; width:50%;" / >                                       < input type = "text"\n                                    name = "fundgiven_amt"\n                                    class = "fundgiven_amt"\n                                    placeholder = "Amount"\n                                    style = "display:inline-block; width: 27%;" / >                                       < input type = "text"\n                                    name = "fundgiven_year"\n                                    class = "fundgiven_year"\n                                    placeholder = "Year"\n                                    style = "display:inline-block; width: 20%;" / >                                       < /div> < /div >  < h3 class = "form-header" > Who do they invest in via equity stakes(stock) ? < /h3> < div id = "investmentmade-0" >  < div class = "investmade-input input-control text"\n                                    data -\n                                      role = "input-control" >                                       < input type = "text"\n                                    name = "investmade"\n                                    class = "investee"\n                                    placeholder = "Investee"\n                                    style = "display:inline-block; width:50%;" / >                                       < input type = "text"\n                                    name = "investmade_amt"\n                                    class = "investmade_amt"\n                                    placeholder = "Amount"\n                                    style = "display:inline-block; width: 27%;" / >                                       < input type = "text"\n                                    name = "investmade_year"\n                                    class = "investmade_year"\n                                    placeholder = "Year"\n                                    style = "display:inline-block; width: 20%;" / >                                       < /div> < /div >  < h3 class = "form-header" > Who provides them with data ? < /h3> < div id = "data-0"\n                                    class = "input-control text"\n                                    data - role = "input-control" >                                       < input type = "text"\n                                    name = "data"\n                                    class = "data-entity"\n                                    placeholder = "Data Resource" / >                                       < /div> < div id = "nextPhase" > < span > Almost done... < /span > < button type = "button"\n                                    id = "submit-A"\n                                    href = "javascript: check_empty()" > Next < /button > < /div >  < /div> < hr / >                                       < div class = "webform-footer" >                                       < span id = "" > Some entities lack adequate information.Would you like to help ? < /span><br/ > < span id = "toFormC" > Click here! < /span> < /div > ',s
}function eb(a){var b=S(a);console.log(a);var c="";c+='<h2 id="webform-head">Information</h2><hr/> < div style = "text-align:center;"\n                                    class = "webform-content" >                                       < p > Thanks\n                                    for submitting information to Athena! < /p> < p > Might you be interested in helping with other entities ? < /p > ',c+='<ul id="suggestions">',c+="</ul> < /div>",d3.select("#info").html(c),d3.selectAll("#info ul a").on("click",function(a,b){mb(suggestions[b]),Q(),fb(suggestions[b])}),$.ajax({type:"POST",data:$.param(b),url:"/database/save",crossDomain:!0}).done(function(){})}function fb(a){if(l=a,d3.selectAll("#name").text(function(){this.value=a.name}),d3.selectAll("#location").text(function(){this.value=a.location}),d3.selectAll('input[name="entitytype"]').filter(function(){this.checked=this.value===a.type?!0:!1}),null!==a.categories&&d3.selectAll(".webform-categories input").filter(function(b,c){this.checked=a.categories.indexOf(d3.selectAll(".webform-categories h4")[0][c].textContent)>-1?!0:!1}),d3.selectAll("#website").text(function(){this.value=a.url}),d3.selectAll("#employee").text(function(){this.value=a.employees}),null!==a.key_people){for(var b=a.key_people,c=0;c<b.length;c++)$("#key-people-"+c).after('<div id="key-people-'+(c+1)+'" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name""/></div>'),d3.select("#key-people-"+c+' input[name="kpeople"]').on("keyup",null),d3.select("#key-people-"+c+' input[name="kpeople"]').text(function(){this.value=b[c]});d3.select("#key-people-"+b.length+' input[name="kpeople"]').on("keyup",function(){U(b.length)})}if(null!==a.funding_received){var d=a.funding_received;d.forEach(function(a,b){$("#funding-"+b).after('<div id="funding-'+(b+1)+'"><div class="fund-input input-control text" data-role="input-control"> < input type = "text"\n                                              name = "fund"\n                                              class = "funder"\n                                              placeholder = "Funder"\n                                              style = "display:inline-block; width:50%;" / >                                               < input type = "text"\n                                              name = "fund_amt"\n                                              class = "fund_amt"\n                                              placeholder = "Amount"\n                                              style = "display:inline-block; width: 27%;" / >                                               < input type = "text"\n                                              name = "fund_year"\n                                              class = "fund_year"\n                                              placeholder = "Year"\n                                              style = "display:inline-block; width: 20%;" / >                                               < /div></div > '),d3.select("#funding-"+b+' input[name="fund"]').on("keyup",null),d3.select("#funding-"+b+' input[name="fund"]').text(function(){this.value=a.entity}),d3.select("#funding-"+b+' input[name="fund_amt"]').text(function(){this.value=a.amount}),d3.select("#funding-"+b+' input[name="fund_year"]').text(function(){this.value=a.year})}),d3.select("#funding-"+d.length+" input[name='fund']").on("keyup",function(){V(d.length)})}if(null!==a.funding_given){var e=a.funding_given;e.forEach(function(a,b){$("#fundinggiven-"+b).after('<div id="fundinggiven-'+(b+1)+'"><div class="fundgiven-input input-control text" data-role="input-control"> < input type = "text"\n                                                name = "fundgiven"\n                                                class = "fundee"\n                                                placeholder = "Fundee"\n                                                style = "display:inline-block; width:50%;" / >                                                 < input type = "text"\n                                                name = "fundgiven_amt"\n                                                class = "fundgiven_amt"\n                                                placeholder = "Amount"\n                                                style = "display:inline-block; width: 27%;" / >                                                 < input type = "text"\n                                                name = "fundgiven_year"\n                                                class = "fundgiven_year"\n                                                placeholder = "Year"\n                                                style = "display:inline-block; width: 20%;" / >                                                 < /div></div > '),d3.select("#fundinggiven-"+b+' input[name="fundgiven"]').on("keyup",null),d3.select("#fundinggiven-"+b+' input[name="fundgiven"]').text(function(){this.value=a.entity}),d3.select("#fundinggiven-"+b+' input[name="fundgiven_amt"]').text(function(){this.value=a.amount}),d3.select("#fundinggiven-"+b+' input[name="fundgiven_year"]').text(function(){this.value=a.year})}),d3.select("#fundinggiven-"+e.length+" input[name='fundgiven']").on("keyup",function(){X(e.length)})}if(null!==a.investments_received){var f=a.investments_received;f.forEach(function(a,b){$("#investing-"+b).after('<div id="investing-'+(b+1)+'"><div class="invest-input input-control text" data-role="input-control"> < input type = "text"\n                                                  name = "invest"\n                                                  class = "investor"\n                                                  placeholder = "Investor"\n                                                  style = "display:inline-block; width:50%;" / >                                                   < input type = "text"\n                                                  name = "invest_amt"\n                                                  class = "invest_amt"\n                                                  placeholder = "Amount"\n                                                  style = "display:inline-block; width: 27%;" / >                                                   < input type = "text"\n                                                  name = "invest_year"\n                                                  class = "invest_year"\n                                                  placeholder = "Year"\n                                                  style = "display:inline-block; width: 20%;" / >                                                   < /div></div > '),d3.select("#investing-"+b+' input[name="invest"]').on("keyup",null),d3.select("#investing-"+b+' input[name="invest"]').text(function(){this.value=a.entity}),d3.select("#investing-"+b+' input[name="invest_amt"]').text(function(){this.value=a.amount}),d3.select("#investing-"+b+' input[name="invest_year"]').text(function(){this.value=a.year})}),d3.select("#investing-"+f.length+" input[name='invest']").on("keyup",function(){W(f.length)})}if(null!==a.investments_made){var g=a.investments_made;g.forEach(function(a,b){$("#investmentmade-"+b).after('<div id="investmentmade-'+(b+1)+'"><div class="investmade-input input-control text" data-role="input-control"> < input type = "text"\n                                                    name = "investmade"\n                                                    class = "investee"\n                                                    placeholder = "Investee"\n                                                    style = "display:inline-block; width:50%;" / >                                                     < input type = "text"\n                                                    name = "investmade_amt"\n                                                    class = "investmade_amt"\n                                                    placeholder = "Amount"\n                                                    style = "display:inline-block; width: 27%;" / >                                                     < input type = "text"\n                                                    name = "investmade_year"\n                                                    class = "investmade_year"\n                                                    placeholder = "Year"\n                                                    style = "display:inline-block; width: 20%;" / >                                                     < /div></div > '),d3.select("#investmentmade-"+b+' input[name="investmade"]').on("keyup",null),d3.select("#investmentmade-"+b+' input[name="investmade"]').text(function(){this.value=a.entity}),d3.select("#investmentmade-"+b+' input[name="investmade_amt"]').text(function(){this.value=a.amount}),d3.select("#investmentmade-"+b+' input[name="investmade_year"]').text(function(){this.value=a.year})}),d3.select("#investmentmade-"+g.length+" input[name='investmade']").on("keyup",function(){Y(g.length)})}if(null!==a.data){var h=a.data;h.forEach(function(a,b){$("#data-"+b).after('<div id="data-'+(b+1)+'" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div>'),d3.select("#data-"+b+' input[name="data"]').on("keyup",null),d3.select("#data-"+b+' input[name="data"]').text(function(){this.value=a.entity})}),d3.select("#data-"+h.length+" input[name='data']").on("keyup",function(){Z(h.length)})}d3.selectAll("#submit-A").on("click",function(){d3.select("#name").style("border-color","#d9d9d9"),d3.select("#location").style("border-color","#d9d9d9"),T(),gb(a)})}function gb(a){if(d3.selectAll("#nickname").text(function(){this.value=a.nickname}),d3.selectAll("#twitterhandle").text(function(){this.value=a.twitter_handle}),d3.selectAll('input[name="influence-type"]').filter(function(){this.checked="local"===a.influence&&"Local Influence"===this.value?!0:"global"===a.influence&&"Global Influence"===this.value?!0:!1}),null!==a.collaborations){var b=a.collaborations;b.forEach(function(a,b){$("#collaboration-"+b).after('<div id="collaboration-'+(b+1)+'" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div>'),d3.select("#collaboration-"+b+' input[name="collaboration"]').on("keyup",null),d3.select("#collaboration-"+b+' input[name="collaboration"]').text(function(){this.value=a.entity})}),console.log(b.length),d3.select("#collaboration-"+b.length+' input[name="collaboration"]').on("keyup",function(){ab(b.length)})}if(null!==a.expenses){var c=a.expenses;c.forEach(function(a,b){$("#expense-"+b).after('<div id="expense-'+(b+1)+'"><div class="expense-input input-control text" data-role="input-control"> < input type = "text"\n                                                      name = "expense_amt"\n                                                      class = "expense_amt"\n                                                      placeholder = "Amount"\n                                                      style = "display:inline-block; width: 57%;" / >                                                       < input type = "text"\n                                                      name = "expense_year"\n                                                      class = "expense_year"\n                                                      placeholder = "Year"\n                                                      style = "display:inline-block; width: 20%;" / >                                                       < /div></div > '),d3.select("#expense-"+b+' input[name="expense_amt"]').on("keyup",null),d3.select("#expense-"+b+' input[name="expense_amt"]').text(function(){this.value=a.amount}),d3.select("#expense-"+b+' input[name="expense_year"]').text(function(){this.value=a.year})}),d3.select("#expense-"+c.length+' input[name="expense_amt"]').on("keyup",function(){cb(c.length)})}if(null!==a.revenue){var d=a.revenue;d.forEach(function(a,b){$("#revenue-"+b).after('<div id="revenue-'+(b+1)+'"><div class="revenue-input input-control text" data-role="input-control"> < input type = "text"\n                                                        name = "revenue_amt"\n                                                        class = "revenue_amt"\n                                                        placeholder = "Amount"\n                                                        style = "display:inline-block; width: 57%;" / >                                                         < input type = "text"\n                                                        name = "revenue_year"\n                                                        class = "revenue_year"\n                                                        placeholder = "Year"\n                                                        style = "display:inline-block; width: 20%;" / >                                                         < /div></div > '),d3.select("#revenue-"+b+' input[name="revenue_amt"]').on("keyup",null),d3.select("#revenue-"+b+' input[name="revenue_amt"]').text(function(){this.value=a.amount}),d3.select("#revenue-"+b+' input[name="revenue_year"]').text(function(){this.value=a.year})}),d3.select("#revenue-"+d.length+' input[name="revenue_amt"]').on("keyup",function(){bb(d.length)})}}function hb(){for(var a="",b=[0,0,0,0],c=[],d=[],e=[],f=[],g=0;g<w.length;g++)"Individual"===w[g].type&&(f.push(w[g].name),Bb.push(w[g]),b[3]++),"Non-Profit"===w[g].type&&(d.push(w[g].name),zb.push(w[g]),b[1]++),"For-Profit"===w[g].type&&(c.push(w[g].name),yb.push(w[g]),b[0]++),"Government"===w[g].type&&(e.push(w[g].name),Ab.push(w[g]),b[2]++);a+="<h3 style='padding-bottom:10px;'>The Data</h3>",d3.select("#info").html(a).style("list-style","square"),d3.select("#info").append("div").attr("id","breakdown").style("width","100%");var g=d3.scale.linear().domain([0,d3.max(b)]).range([0,$("#breakdown").width()]),h=0,i=0;d3.select("#breakdown").selectAll("div").data(b).enter().append("div").style("width",function(a){return g(a)/5+"%"}).style("height","20px").style("font","8px sans-serif").style("background-color",function(){return 0===h?(h++,"rgb(127,186,0)"):1===h?(h++,"rgb(0,164,239)"):2===h?(h++,"rgb(242,80,34)"):3===h?(h++,"rgb(255,185,0)"):void 0}).style("text-align","right").style("padding","3px").style("margin","1px").style("color","white").text(function(){return 0===i?void i++:1===i?void i++:2===i?void i++:3===i?void i++:void 0});var j="";j+="<h3 style='padding-top:15px; color:rgb(127,186,0);'>For-Profit ("+b[0]+"):</h3> ";for(var g=0;g<c.length;g++)j+=g===c.length-1?"<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+c[g]+"</a>":"<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+c[g]+", </a>";j+="<h3 style='padding-top:15px; color:rgb(0,164,239);'>Non-Profit ("+b[1]+"):</h3> ";for(var g=0;g<d.length;g++)j+=g===d.length-1?"<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+d[g]+"</a>":"<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+d[g]+", </a>";j+="<h3 style='padding-top:15px; color:rgb(242,80,34);'>Government ("+b[2]+"):</h3> ";for(var g=0;g<e.length;g++)j+=g===e.length-1?"<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+e[g]+"</a>":"<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+e[g]+", </a>";j+="<h3 style='padding-top:15px; color:rgb(255,185,0);'>Individual ("+b[3]+"):</h3> ";for(var g=0;g<f.length;g++)j+=g===f.length-1?"<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+f[g]+"</a>":"<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+f[g]+", </a>";d3.select("#info").append("text").style("padding-bottom","20px").html(j)}function ib(){var a="";w.forEach(function(a){if(Cb.push(a.name.toLowerCase()),Db.push(a.location.toLowerCase()),Eb.push(a.nickname.toLowerCase()),-1===Fb.indexOf(a.name)&&null!==a.name&&Fb.push(a.name),-1===Fb.indexOf(a.nickname)&&null!==a.nickname&&Gb.push(a.nickname),-1===Hb.indexOf(a.location)&&null!==a.location){var b=a.location.split("; ");b.forEach(function(a){-1===Hb.indexOf(a)&&Hb.push(a)})}}),Ib=Ib.concat(Hb),Ib=Ib.concat(Gb),Ib=Ib.concat(Fb),Ib=Ib.sort();for(var b=0;b<Ib.length;b++)a+='<option value="'+Ib[b]+'">';d3.select(".filter-name-location datalist").html(a)}function jb(a){var b=[],c=0;if(a=a.toLowerCase(),-1!==Cb.indexOf(a))Cb.forEach(function(b){if(b===a&&b.length===a.length){var c=Cb.indexOf(a);m.filter(function(a,b){b===c&&mb(a)})}});else if(-1!==Eb.indexOf(a))Eb.forEach(function(b){if(b===a&&b.length===a.length){var c=Eb.indexOf(a);m.filter(function(a,b){b===c&&mb(a)})}});else{Db.forEach(function(d){if(null!==d){var e=d.split("; ");-1!==e.indexOf(a)&&b.push(c)}c++});C.style("opacity",function(b){return b.source.location===a&&b.target.location===a?"1":"0.05"}),D.style("opacity",function(b){return b.source.location===a&&b.target.location===a?"1":"0.05"}),E.style("opacity",function(b){return b.source.location===a&&b.target.location===a?"1":"0.05"}),F.style("opacity",function(b){return b.source.location===a&&b.target.location===a?"1":"0.05"}),d3.selectAll(".node").style("opacity",function(a,c){return-1===b.indexOf(c)?.05:1}).on("mouseover",null),n.on("mouseout",null).on("mouseover",null).on("click",null),n.filter(function(a,b){return 1==m[0][b].style.opacity?a:void 0}).on("mouseout",null).on("mouseover",K).on("click",null)}}function kb(a){console.log("Inside node hover");var b=P(a);webform=O(a),d3.select("#edit").html(webform),d3.select("#info").html(b).style("list-style","square"),C.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),D.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),E.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),F.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"});var c=function(a,b){return a.target.index===b.index},d=function(a,b){return a.source.index===b.index},e={};e[a.ID]=1,A.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),B.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),y.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),z.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),d3.select(this).style("stroke","rgba(0,0,0,0.6)"),H.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(a){return a.ID in e?"1":"0.05"}).select("text").style("opacity",1),d3.select(this.parentNode).select("text").transition().duration(350).delay(0).style("opacity",1).style("font-weight","bold")}function lb(){n.style("stroke","white").on("mouseover",kb).on("mouseout",lb).on("click",mb),C.transition().duration(350).delay(0).style("stroke","rgb(111,93,168)").style("opacity","0.2").style("stroke-width","1px"),D.transition().duration(350).delay(0).style("stroke","rgb(38,114,114)").style("opacity","0.2").style("stroke-width","1px"),E.transition().duration(350).delay(0).style("stroke","rgb(235,232,38)").style("opacity","0.2").style("stroke-width","1px"),F.transition().duration(350).delay(0).style("stroke","rgb(191,72,150)").style("opacity","0.2").style("stroke-width","1px"),d3.selectAll(".node").transition().duration(350).delay(0).style("opacity","1"),d3.selectAll(".node").selectAll("text").transition().duration(350).delay(0).style("opacity",function(a){var b;return"For-Profit"===a.type&&(b=o.hasOwnProperty(a.name)?1:0),"Non-Profit"===a.type&&(b=p.hasOwnProperty(a.name)?1:0),"Individual"===a.type&&(b=q.hasOwnProperty(a.name)?1:0),"Government"===a.type&&(b=r.hasOwnProperty(a.name)?1:0),b}).style("font-size","14px")}function mb(a){t=0,console.log("Clicked on node first"),K(a),C.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),D.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),E.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),F.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),n.style("stroke",function(b){return b!==a?"white":"black"}).on("mouseout",null),n.filter(function(b){return b!==a?b:void 0}).on("mouseover",null);var b=I.funding_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index}),c=I.investment_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index}),d=I.collaboration_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index}),e=I.data_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index});H.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(f){return b.indexOf(f.index)>-1||c.indexOf(f.index)>-1||d.indexOf(f.index)>-1||e.indexOf(f.index)>-1||f===a?1:.05}),n.filter(function(f){return b.indexOf(f.index)>-1||c.indexOf(f.index)>-1||d.indexOf(f.index)>-1||e.indexOf(f.index)>-1||f===a}).on("mouseover",K).on("click",function(){})}function nb(){n.on("mouseover",null).on("mouseout",null).on("click",null)}function ob(){d3.select(this).classed("fixed",function(a){a.fixed=!0}),n.on("mouseover",kb).on("mouseout",lb).on("click",mb)}function pb(a){var c=8*a.alpha;w.forEach(function(a){null!==a.type&&("Individual"===a.type&&(a.x+=c+c,a.y+=c+c),"Non-Profit"===a.type&&(a.x+=-c-c,a.y+=c+c),"For-Profit"===a.type&&(a.x+=c+c,a.y+=-c-c),"Government"===a.type&&(a.x+=-c-c,a.y+=-c-c))}),_.isEmpty(G)?(C.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),D.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),E.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),F.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),n.attr("cx",function(a){return a.x=a.x}).attr("cy",function(a){return a.y=a.y}),i.attr("transform",b)):(C.attr("x1",function(a){return a.source===G?(a.source.x=G.x,console.log("Test"),a.source.x):a.source.x}).attr("y1",function(a){return a.source===G?(a.source.y=G.y,console.log("Test"),a.source.y):a.source.y}).attr("x2",function(a){return a.target===G?(a.target.x=G.x,console.log("Test"),a.target.x):a.target.x}).attr("y2",function(a){return a.target===G?(a.target.y=G.y,console.log("Test"),a.target.y):a.target.y}),D.attr("x1",function(a){return a.source===G?(a.source.x=G.x,console.log("Test"),a.source.x):a.source.x}).attr("y1",function(a){return a.source===G?(a.source.y=G.y,console.log("Test"),a.source.y):a.source.y}).attr("x2",function(a){return a.target===G?(a.target.x=G.x,console.log("Test"),a.target.x):a.target.x}).attr("y2",function(a){return a.target===G?(a.target.y=G.y,console.log("Test"),a.target.y):a.target.y}),E.attr("x1",function(a){return a.source===G?(a.source.x=G.x,console.log("Test"),a.source.x):a.source.x}).attr("y1",function(a){return a.source===G?(a.source.y=G.y,console.log("Test"),a.source.y):a.source.y}).attr("x2",function(a){return a.target===G?(a.target.x=G.x,console.log("Test"),a.target.x):a.target.x}).attr("y2",function(a){return a.target===G?(a.target.y=G.y,console.log("Test"),a.target.y):a.target.y}),F.attr("x1",function(a){return a.source===G?(a.source.x=G.x,console.log("Test"),a.source.x):a.source.x}).attr("y1",function(a){return a.source===G?(a.source.y=G.y,console.log("Test"),a.source.y):a.source.y}).attr("x2",function(a){return a.target===G?(a.target.x=G.x,console.log("Test"),a.target.x):a.target.x}).attr("y2",function(a){return a.target===G?(a.target.y=G.y,console.log("Test"),a.target.y):a.target.y}),n.attr("cx",function(a,b){return d3.select(n)[0][0].data()[b].name===G.name?(a.x=G.x,a.x):a.x=a.x}).attr("cy",function(a,b){return d3.select(n)[0][0].data()[b].name===G.name?(a.y=G.y,a.y):a.y=a.y}),i.attr("transform",b))}function qb(){for(var a=[],b=0;b<m[0].length;b++)"visible"===m[0][b].style.visibility&&a.push(b);var c=[];return m.filter(function(b,d){a.indexOf(d)>-1&&c.push(b)}),c}var rb=I.nodes,sb=I.funding_connections,tb=I.investment_connections,ub=I.collaboration_connections,vb=I.data_connections,wb=sb.concat(tb).concat(ub).concat(vb);w=rb.filter(function(a){return 1===a.render}),A=sb.filter(function(a){return 1===a.render}),B=tb.filter(function(a){return 1===a.render}),y=ub.filter(function(a){return 1===a.render}),z=vb.filter(function(a){return 1===a.render}),k=A.concat(B).concat(y).concat(z);var xb=d3.layout.force().nodes(rb).size([u,v]).links(wb).linkStrength(0).charge(function(a){return null!==a.employees?-6*M(a.employees):-25}).on("tick",pb).start(),nb=xb.drag().on("dragstart",nb).on("drag",nb).on("dragend",ob);for(C=H.selectAll(".fund").data(A).enter().append("line").attr("class","fund").style("stroke","rgb(111,93,168)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),D=H.selectAll(".invest").data(B).enter().append("line").attr("class","invest").style("stroke","rgb(38,114,114)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),E=H.selectAll(".porucs").data(y).enter().append("line").attr("class","porucs").style("stroke","rgb(235,232,38)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),F=H.selectAll(".data").data(z).enter().append("line").attr("class","data").style("stroke","rgb(191,72,150)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),m=H.selectAll(".node").data(w).enter().append("g").attr("class","node").style("visibility","visible").on("dblclick",J).call(nb),e=H.selectAll(".node").filter(function(a){return"For-Profit"===a.type}).sort(function(a,b){return a.weight-b.weight}),f=H.selectAll(".node").filter(function(a){return"Non-Profit"===a.type}).sort(function(a,b){return a.weight-b.weight}),g=H.selectAll(".node").filter(function(a){return"Individual"===a.type}).sort(function(a,b){return a.weight-b.weight}),h=H.selectAll(".node").filter(function(a){return"Government"===a.type}).sort(function(a,b){return a.weight-b.weight}),e.each(function(a,b){b>=e[0].length-5&&(o[a.name]=a.weight)}),f.each(function(a,b){b>=f[0].length-5&&(p[a.name]=a.weight)}),g.each(function(a,b){b>=g[0].length-5&&(q[a.name]=a.weight)}),h.each(function(a,b){b>=h[0].length-5&&(r[a.name]=a.weight)}),i=H.selectAll(".node").append("text").text(function(a){return a.nickname}).attr("x",0).attr("dy","0.1em").attr("y",function(a){return null!==a.employees?M(a.employees)+10:17}).style("opacity",function(a){var b;return"For-Profit"===a.type&&(b=o.hasOwnProperty(a.name)?1:0),"Non-Profit"===a.type&&(b=p.hasOwnProperty(a.name)?1:0),"Individual"===a.type&&(b=q.hasOwnProperty(a.name)?1:0),"Government"===a.type&&(b=r.hasOwnProperty(a.name)?1:0),b}).style("font-size","14px").style("color","#FFFFFF").style("pointer-events","none"),n=m.append("circle").attr("r",function(a){return null!==a.employees?M(a.employees):"7"}).style("fill",function(a){if(null!==a.type){if("Individual"===a.type)return"rgb(255,185,0)";if("Non-Profit"===a.type)return"rgb(0,164,239)";if("For-Profit"===a.type)return"rgb(127,186,0)";if("Government"===a.type)return"rgb(242,80,34)"}}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).style("stroke-width","1.5px").style("stroke","white").on("mouseover",kb).on("mouseout",lb).on("click",mb),i.call(a,80);xb.alpha()>.025;)xb.tick();d3.selectAll("#edit").on("click",Q);var yb=[],zb=[],Ab=[],Bb=[];hb(),d3.selectAll(".for-profit-entity").on("click",function(a,b){mb(yb[b])}),d3.selectAll(".non-profit-entity").on("click",function(a,b){mb(zb[b])}),d3.selectAll(".individual-entity").on("click",function(a,b){mb(Bb[b])}),d3.selectAll(".government-entity").on("click",function(a,b){mb(Ab[b])}),d3.selectAll(".click-location").on("click",function(){jb(this.innerHTML)});var Cb=[],Db=[],Eb=[],Fb=[],Gb=[],Hb=[],Ib=[];ib(),d3.selectAll("#search-text").on("keydown",function(){if(13===d3.event.keyCode){var a=document.getElementById("search-text").value;jb(a)}}),d3.selectAll("option").on("keydown",function(a,b){if(console.log("Hello"),13===d3.event.keyCode){var c=d3.selectAll("option")[0][b].value;jb(c)}}),d3.selectAll("#cb_fund").on("click",function(){var a=qb();if(document.getElementById("cb_fund").checked){var b=0;d3.selectAll(".fund").style("visibility",function(c){return a.indexOf(c.source)>-1&&a.indexOf(c.target)>-1&&"hidden"===this.style.visibility?(b++,"visible"):"hidden"})}document.getElementById("cb_fund").checked||d3.selectAll(".fund").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_fund").checked=!1)}),d3.selectAll("#cb_invest").on("click",function(){var a=qb();document.getElementById("cb_invest").checked&&d3.selectAll(".invest").style("visibility",function(b){return a.indexOf(b.source)>-1&&a.indexOf(b.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_invest").checked||d3.selectAll(".invest").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_invest").checked=!1)}),d3.selectAll("#cb_porucs").on("click",function(){var a=qb();document.getElementById("cb_porucs").checked&&d3.selectAll(".porucs").style("visibility",function(b){return a.indexOf(b.source)>-1&&a.indexOf(b.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_porucs").checked||d3.selectAll(".porucs").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_porucs").checked=!1)}),d3.selectAll("#cb_data").on("click",function(){var a=qb();document.getElementById("cb_data").checked&&d3.selectAll(".data").style("visibility",function(b){return a.indexOf(b.source)>-1&&a.indexOf(b.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_data").checked||d3.selectAll(".data").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_data").checked=!1)}),d3.selectAll("#cb_individ, #cb_nonpro, #cb_forpro, #cb_gov").on("click",function(){function a(){for(var a=arguments,b={},c=[],d=0;d<a.length;d++)for(var e=0;e<a[d].length;e++)b[a[d][e]]!==!0&&(c[c.length]=a[d][e],b[a[d][e]]=!0);return c}var b=[],c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=[],q=[],r=[],s=[],t=[],u=[],v=[],x=[],G=[],H=[],I=[],J=[],K=[],L=[],M=[],N=[],O=[],P=[],Q=[],R=[],S=[],T=[],U=[],V=[],W=[],X=[];
document.getElementById("cb_individ").checked&&(d3.selectAll(".node").filter(function(a){return"Individual"===a.type?this:void 0}).style("visibility","visible"),f=0,w.forEach(function(a){"Individual"===a.type&&(A.forEach(function(c){(a===c.source||a===c.target)&&b.push(f),f++}),f=0)}),f=0,w.forEach(function(a){"Individual"===a.type&&(B.forEach(function(b){(a===b.source||a===b.target)&&c.push(f),f++}),f=0)}),f=0,w.forEach(function(a){"Individual"===a.type&&(y.forEach(function(b){(a===b.source||a===b.target)&&d.push(f),f++}),f=0)}),countIndex0=0,w.forEach(function(a){"Individual"===a.type&&(z.forEach(function(b){(a===b.source||a===b.target)&&e.push(countIndex0),countIndex0++}),countIndex0=0)})),document.getElementById("cb_individ").checked||(d3.selectAll(".node").filter(function(a){return"Individual"===a.type?this:void 0}).style("visibility","hidden"),I=0,w.forEach(function(a){"Individual"===a.type&&(A.forEach(function(b){(a===b.source||a===b.target)&&v.push(I),I++}),I=0)}),I=0,w.forEach(function(a){"Individual"===a.type&&(B.forEach(function(b){(a===b.source||a===b.target)&&x.push(I),I++}),I=0)}),I=0,w.forEach(function(a){"Individual"===a.type&&(y.forEach(function(b){(a===b.source||a===b.target)&&G.push(I),I++}),I=0)}),I=0,w.forEach(function(a){"Individual"===a.type&&(z.forEach(function(b){(a===b.source||a===b.target)&&H.push(I),I++}),I=0)})),document.getElementById("cb_nonpro").checked&&(d3.selectAll(".node").filter(function(a){return"Non-Profit"===a.type?this:void 0}).style("visibility","visible"),k=0,w.forEach(function(a){"Non-Profit"===a.type&&(A.forEach(function(b){a!==b.source&&a!==b.target||-1!==g.indexOf(k)||g.push(k),k++}),k=0)}),k=0,w.forEach(function(a){"Non-Profit"===a.type&&(B.forEach(function(b){a!==b.source&&a!==b.target||-1!==h.indexOf(k)||h.push(k),k++}),k=0)}),k=0,w.forEach(function(a){"Non-Profit"===a.type&&(y.forEach(function(b){a!==b.source&&a!==b.target||-1!==i.indexOf(k)||i.push(k),k++}),k=0)}),k=0,w.forEach(function(a){"Non-Profit"===a.type&&(z.forEach(function(b){a!==b.source&&a!==b.target||-1!==j.indexOf(k)||j.push(k),k++}),k=0)})),document.getElementById("cb_nonpro").checked||(d3.selectAll(".node").filter(function(a){return"Non-Profit"===a.type?this:void 0}).style("visibility","hidden"),N=0,w.forEach(function(a){"Non-Profit"===a.type&&(A.forEach(function(b){a!==b.source&&a!==b.target||-1!==J.indexOf(N)||J.push(N),N++}),N=0)}),N=0,w.forEach(function(a){"Non-Profit"===a.type&&(B.forEach(function(b){a!==b.source&&a!==b.target||-1!==K.indexOf(N)||K.push(N),N++}),N=0)}),N=0,w.forEach(function(a){"Non-Profit"===a.type&&(y.forEach(function(b){a!==b.source&&a!==b.target||-1!==L.indexOf(N)||L.push(N),N++}),N=0)}),N=0,w.forEach(function(a){"Non-Profit"===a.type&&(z.forEach(function(b){a!==b.source&&a!==b.target||-1!==M.indexOf(N)||M.push(N),N++}),N=0)})),document.getElementById("cb_forpro").checked&&(d3.selectAll(".node").filter(function(a){return"For-Profit"===a.type?this:void 0}).style("visibility","visible"),p=0,w.forEach(function(a){"For-Profit"===a.type&&(A.forEach(function(b){a!==b.source&&a!==b.target||-1!==l.indexOf(p)||l.push(p),p++}),p=0)}),p=0,w.forEach(function(a){"For-Profit"===a.type&&(B.forEach(function(b){a!==b.source&&a!==b.target||-1!==m.indexOf(p)||m.push(p),p++}),p=0)}),p=0,w.forEach(function(a){"For-Profit"===a.type&&(y.forEach(function(b){a!==b.source&&a!==b.target||-1!==n.indexOf(p)||n.push(p),p++}),p=0)}),p=0,w.forEach(function(a){"For-Profit"===a.type&&(z.forEach(function(b){a!==b.source&&a!==b.target||-1!==o.indexOf(p)||o.push(p),p++}),p=0)})),document.getElementById("cb_forpro").checked||(d3.selectAll(".node").filter(function(a){return"For-Profit"===a.type?this:void 0}).style("visibility","hidden"),S=0,w.forEach(function(a){"For-Profit"===a.type&&(A.forEach(function(b){a!==b.source&&a!==b.target||-1!==O.indexOf(S)||O.push(S),S++}),S=0)}),S=0,w.forEach(function(a){"For-Profit"===a.type&&(B.forEach(function(b){a!==b.source&&a!==b.target||-1!==P.indexOf(S)||P.push(S),S++}),S=0)}),S=0,w.forEach(function(a){"For-Profit"===a.type&&(y.forEach(function(b){a!==b.source&&a!==b.target||-1!==Q.indexOf(S)||Q.push(S),S++}),S=0)}),S=0,w.forEach(function(a){"For-Profit"===a.type&&(z.forEach(function(b){a!==b.source&&a!==b.target||-1!==R.indexOf(S)||R.push(S),S++}),S=0)})),document.getElementById("cb_gov").checked&&(d3.selectAll(".node").filter(function(a){return"Government"===a.type?this:void 0}).style("visibility","visible"),u=0,w.forEach(function(a){"Government"===a.type&&(A.forEach(function(b){a!==b.source&&a!==b.target||-1!==q.indexOf(u)||q.push(u),u++}),u=0)}),u=0,w.forEach(function(a){"Government"===a.type&&(B.forEach(function(b){a!==b.source&&a!==b.target||-1!==r.indexOf(u)||r.push(u),u++}),u=0)}),u=0,w.forEach(function(a){"Government"===a.type&&(y.forEach(function(b){a!==b.source&&a!==b.target||-1!==s.indexOf(u)||s.push(u),u++}),u=0)}),u=0,w.forEach(function(a){"Government"===a.type&&(z.forEach(function(b){a!==b.source&&a!==b.target||-1!==t.indexOf(u)||t.push(u),u++}),u=0)})),document.getElementById("cb_gov").checked||(d3.selectAll(".node").filter(function(a){return"Government"===a.type?this:void 0}).style("visibility","hidden"),X=0,w.forEach(function(a){"Government"===a.type&&(A.forEach(function(b){a!==b.source&&a!==b.target||-1!==T.indexOf(X)||T.push(X),X++}),X=0)}),X=0,w.forEach(function(a){"Government"===a.type&&(B.forEach(function(b){a!==b.source&&a!==b.target||-1!==U.indexOf(X)||U.push(X),X++}),X=0)}),X=0,w.forEach(function(a){"Government"===a.type&&(y.forEach(function(b){a!==b.source&&a!==b.target||-1!==V.indexOf(X)||V.push(X),X++}),X=0)}),X=0,w.forEach(function(a){"Government"===a.type&&(z.forEach(function(b){a!==b.source&&a!==b.target||-1!==W.indexOf(X)||W.push(X),X++}),X=0)}));var Y=[],Z=[],$=[],_=[];0!==b.length&&(Y=a(Y,b)),0!==g.length&&(Y=Y=a(Y,g)),0!==l.length&&(Y=a(Y,l)),0!==q.length&&(Y=a(Y,q)),0!==c.length&&(Z=a(Z,c)),0!==h.length&&(Z=a(Z,h)),0!==m.length&&(Z=a(Z,m)),0!==r.length&&(Z=a(Z,r)),0!==d.length&&($=a($,d)),0!==i.length&&($=a($,i)),0!==n.length&&($=a($,n)),0!==s.length&&($=a($,s)),0!==e.length&&(_=a(_,e)),0!==j.length&&(_=a(_,j)),0!==o.length&&(_=a(_,o)),0!==t.length&&(_=a(_,t));var ab=[],bb=[],cb=[],db=[];0!==v.length&&(ab=a(ab,v)),0!==J.length&&(ab=a(ab,J)),0!==O.length&&(ab=a(ab,O)),0!==T.length&&(ab=a(ab,T)),0!==x.length&&(bb=a(bb,x)),0!==K.length&&(bb=a(bb,K)),0!==P.length&&(bb=a(bb,P)),0!==U.length&&(bb=a(bb,U)),0!==G.length&&(cb=a(cb,G)),0!==L.length&&(cb=a(cb,L)),0!==Q.length&&(cb=a(cb,Q)),0!==V.length&&(cb=a(cb,V)),0!==H.length&&(db=a(db,H)),0!==M.length&&(db=a(db,M)),0!==R.length&&(db=a(db,R)),0!==W.length&&(db=a(db,W));var eb=[],fb=[],gb=[],hb=[];document.getElementById("cb_fund").checked||C.filter(function(a,b){"hidden"===C[0][b].style.visibility&&eb.push(b)}),document.getElementById("cb_invest").checked||D.filter(function(a,b){"hidden"===D[0][b].style.visibility&&fb.push(b)}),document.getElementById("cb_porucs").checked||E.filter(function(a,b){"hidden"===E[0][b].style.visibility&&gb.push(b)}),document.getElementById("cb_data").checked||F.filter(function(a,b){"hidden"===F[0][b].style.visibility&&hb.push(b)}),d3.selectAll(".fund").style("visibility",function(a,b){return Y.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".invest").style("visibility",function(a,b){return Z.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".porucs").style("visibility",function(a,b){return $.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".data").style("visibility",function(a,b){return _.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".fund").style("visibility",function(a,b){return ab.indexOf(b)>-1||eb.indexOf(b)>-1?"hidden":"visible"}),d3.selectAll(".invest").style("visibility",function(a,b){return bb.indexOf(b)>-1||fb.indexOf(b)>-1?"hidden":"visible"}),d3.selectAll(".porucs").style("visibility",function(a,b){return cb.indexOf(b)>-1||gb.indexOf(b)>-1?"hidden":"visible"}),d3.selectAll(".data").style("visibility",function(a,b){return db.indexOf(b)>-1||hb.indexOf(b)>-1?"hidden":"visible"});for(var ib=0,jb=0;jb<C[0].length;jb++)"hidden"===C[0][jb].style.visibility&&ib++;for(var kb=0,jb=0;jb<D[0].length;jb++)"hidden"===D[0][jb].style.visibility&&kb++;for(var lb=0,jb=0;jb<E[0].length;jb++)"hidden"===E[0][jb].style.visibility&&lb++;for(var mb=0,jb=0;jb<F[0].length;jb++)"hidden"===F[0][jb].style.visibility&&mb++;ib===C[0].length&&document.getElementById("cb_fund").checked&&(document.getElementById("cb_fund").checked=!1),ib!==C[0].length&&(document.getElementById("cb_fund").checked||(document.getElementById("cb_fund").checked=!0)),kb===D[0].length&&document.getElementById("cb_invest").checked&&(document.getElementById("cb_invest").checked=!1),kb!==D[0].length&&(document.getElementById("cb_invest").checked||(document.getElementById("cb_invest").checked=!0)),lb===E[0].length&&document.getElementById("cb_porucs").checked&&(document.getElementById("cb_porucs").checked=!1),lb!==E[0].length&&(document.getElementById("cb_porucs").checked||(document.getElementById("cb_porucs").checked=!0)),mb===F[0].length&&document.getElementById("cb_data").checked&&(document.getElementById("cb_data").checked=!1),mb!==F[0].length&&(document.getElementById("cb_data").checked||(document.getElementById("cb_data").checked=!0))}),d3.selectAll("#cb_emp, #cb_numtwit").on("click",function(){document.getElementById("cb_emp").checked&&(n.transition().duration(350).delay(0).attr("r",function(a){return null!==a.employees?M(a.employees):"7"}),i.attr("transform",function(a){return null!==a.employees?c(0,-M(a.employees)):c(0,-7)})),document.getElementById("cb_numtwit").checked&&(n.transition().duration(350).delay(0).attr("r",function(a){return null!==a.followers?a.followers>1e6?"50":N(a.followers):"7"}),i.attr("transform",function(a){return null!==a.followers?c(0,-N(a.followers)):c(0,-7)}))}),d3.select("svg").on("click",function(){console.log("Clicked on SVG");var a=d3.mouse(this);if(console.log(a),1===t){d3.event.preventDefault(),lb(),d3.selectAll("g").classed("fixed",function(a){a.fixed=!1}),d3.selectAll("g").call(nb),G=jQuery.extend(!0,{},{}),console.log(o);{d3.layout.force().nodes(rb).size([u,v]).links(wb).linkStrength(0).charge(function(a){return null!==a.employees?-6*M(a.employees):-25}).on("tick",pb).resume()}}t=1})})}();