!function(){function a(a,b){a.each(function(){for(var a,c=d3.select(this),d=c.text().split(/\s+/).reverse(),e=[],f=0,g=1.1,h=parseFloat(c.attr("dy")),i=d3.select(this)[0][0].__data__,j=c.text(null).append("tspan").attr("x",0).attr("y",function(){return null!==i.employees?E(i.employees)+10:17}).attr("dy",h+"em");a=d.pop();)e.push(a),j.text(e.join(" ")),j.node().getComputedTextLength()>b&&(e.pop(),j.text(e.join(" ")),e=[a],f++,j=c.append("tspan").attr("x",0).attr("y",function(){return null!==i.employees?E(i.employees)+5:12}).attr("dy",f*g+h+"em").text(a))})}function b(a){return"translate("+a.x+","+a.y+")"}function c(a,b){return"translate("+a+","+b+")"}function d(a){a+="",x=a.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var b=/(\d+)(\d{3})/;b.test(x1);)x1=x1.replace(b,"$1,$2");return x1+x2}d3.selection.prototype.moveToFront=function(){return this.each(function(){this.parentNode.appendChild(this)})},d3.selection.prototype.moveToBack=function(){return this.each(function(){var a=this.parentNode.firstChild;a&&this.parentNode.insertBefore(this,a)})};var e,f,g,h,i=1e3,j=1e3,k={},l={},m={},n={},o=1,p={},q={},r={},t={},u={},v={},w={},y={},z=d3.select(".content").append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("id","network").attr("height",j).attr("width",i);d3.select("body > nav > nav > div").append("div").attr("id","editBox").append("p").text("Edit").style("color","#2e92cf");var A=i/j,B=$("#network"),C=B.parent();$(window).on("resize",function(){var a=C.width();B.attr("width",a),B.attr("height",Math.round(a/A))}).trigger("resize");var D="0 0 "+i+" "+j;z.attr("viewBox",D).attr("preserveAspectRatio","xMidYMid");var E=d3.scale.sqrt().domain([10,13e4]).range([10,50]),F=d3.scale.sqrt().domain([10,1e6]).range([10,50]);d3.json("/athena",function(x,A){function B(a){d3.select(this).classed("fixed",function(a){a.fixed=!1}),d3.select(this).on("mousedown.drag",null);{var b=(d3.select(this).data()[0],parseInt(z.style("width").substring(0,(z.style("width").length+1)/2))),c=parseInt(z.style("height").substring(0,(z.style("height").length+1)/2));parseInt(b/2),parseInt(c/2)}multiplierX=b/i,multiplierY=c/j,scaledDX=multiplierX*a.x,scaledDY=multiplierY*a.y,v=jQuery.extend(!0,{},a),v.x=i/2-10,v.y=j/2-60;d3.layout.force().nodes(kb).size([i,j]).links(pb).linkStrength(0).charge(function(a){return null!==a.employees?-6*E(a.employees):-25}).linkDistance(50).on("tick",ib).start()}function C(a){s=H(a),webform=G(a),d3.select("#edit").html(webform),d3.select("#info").html(s).style("list-style","square"),d3.selectAll("#editCurrentInfo").on("click",function(){D(a)}).on("mouseover",function(){return d3.select(this).style("cursor","pointer"),d3.select("#editBox").style("visibility","visible")}).on("mousemove",function(){return d3.select("#editBox").style("top",d3.event.pageY+4+"px").style("left",d3.event.pageX+16+"px")}).on("mouseout",function(){return d3.select("#editBox").style("visibility","hidden")})}function D(a){I(),Y(a)}function G(){var a="";return a+='<h1 id="edit-add-info"><i class="icon-plus on-left"></i>Add Information</h1>'}function H(a){var b="";if(b+='<div style="height:30px"><a style="float:right;"><i id="editCurrentInfo" class="icon-pencil on-left"></i></a></div>',b+='<h1><a href="'+a.url+'" target="_blank">'+a.name+"</a></h1>",b+="<h6>Type of Entity: </h6> <h5>"+a.type+"</h5>",null!==a.location){b+="<br/><h6> Location:  </h6>";var c=[];if(-1!==a.location.indexOf("; ")){b+="<br/> <h5><ul>",c=a.location.split("; ");for(var e=0;e<c.length;e++)b+='<li style="display:block;"><h5><a class="click-location" style="cursor:pointer;">'+c[e]+"</h5></a></li>"}else b+="<h5><ul>",b+='<li style="display:inline-block;"><h5><a class="click-location" style="cursor:pointer;">'+a.location+"</h5></a></li>";b+="</h5></ul><br/>"}else b+="<br/><h6> Location:  </h6> <h5>N/A</h5><br/>";if("Individual"!==a.type&&(b+=null!==a.employees?"<h6>Employees: </h6> <h5>"+d(a.employees.toString())+"</h5><br/>":"<h6>Employees: </h6> <h5>N/A</h5><br/>"),null===a.twitter_handle)b+="<h6>Twitter:  </h6> <h5>N/A</h5><br/>",b+="<h6>Twitter Followers: </h6> <h5>N/A</h5><br/>";else{var f=a.twitter_handle.replace("@","");f="https://twitter.com/"+f,b+='<h6>Twitter:  </h6> <h5><a href="'+f+'" target="_blank">'+a.twitter_handle+"</h5></a><br/>",b+=null!==a.followers?"<h6>Twitter Followers:  </h6> <h5>"+d(a.followers.toString())+"</h5><br/>":"<h6>Twitter Followers:  </h6> <h5>N/A</h5><br/>"}if(null!==a.key_people){b+="<br/><h6>Key People:</h6><ul><h5>";for(var e=0;e<a.key_people.length;e++)b+='<li><a href="http://www.bing.com/search?q='+a.key_people[e].replace(" ","%20")+"%20"+a.nickname.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.key_people[e]+"</a></li>";b+="</h5></ul>"}return null===a.funding_received?b+="<br/><h6>No known funding received.</h6><br/>":(b+="<br/><h6>Received funding from:</h6><ul>",a.funding_received.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.funding_given?b+="<br/><h6>No known funding provided.</h6><br/>":(b+="<br/><h6>Gave funding to:</h6><ul>",a.funding_given.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.investments_received?b+="<br/><h6>No known investments received.</h6><br/>":(b+="<br/><h6>Received investments from:</h6><ul>",a.investments_received.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.investments_made?b+="<br/><h6>No known investments made.</h6><br/>":(b+="<br/><h6>Invested in:</h6><ul>",a.investments_made.forEach(function(a){b+=0===a.amount||null===a.amount?'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':'<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+'</a></h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>",null===a.year}),b+="</ul>"),null===a.collaborations?b+="<br/><h6>No known collaborations.</h6><br/>":(b+="<br/><h6>Collaborated with:</h6><ul>",a.collaborations.forEach(function(a){b+='<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+"</a></h5></li>"}),b+="</ul>"),null===a.data?b+="<br/><h6>No known external data usage.</h6><br/>":(b+="<br/><h6>Obtained data from:</h6><ul>",a.data.forEach(function(a){b+='<li><h5><a href="http://www.bing.com/search?q='+a.entity.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+a.entity+"</a></h5></li>"}),b+="</ul>"),null===a.revenue?b+="<br/><h6>No known revenue information.</h6><br/>":(b+="<br/><h6>Revenue:</h6><ul>",a.revenue.forEach(function(a){b+=0===a.amount||null===a.amount?null===a.year?'<li><h5>Unknown Year</h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':"<li><h5>"+a.year+'</h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':null===a.year?'<li><h5>Unknown Year</h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>":"<li><h5>"+a.year+'</h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>"}),b+="</ul>"),null===a.expenses?b+="<br/><h6>No known expenses information.</h6><br/>":(b+="<br/><h6>Expenses:</h6><ul>",a.expenses.forEach(function(a){b+=0===a.amount||null===a.amount?null===a.year?'<li><h5>Unknown Year</h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':"<li><h5>"+a.year+'</h5>: <strong style="color:rgb(255,185,0);">unknown</strong></li>':null===a.year?'<li><h5>Unknown Year</h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>":"<li><h5>"+a.year+'</h5>: <strong style="color:rgb(127,186,0);">$'+d(a.amount.toString())+"</strong></li>"}),b+="</ul>"),W(a),b}function I(){d3.select("#edit-add-info").html('<i class=" icon-file on-left"></i>Reset Form').on("click",I),xb.on("mouseover",null),sa=W(),d3.select("#info").html(sa),namesList=Fb.concat(Gb),namesList=namesList.sort();for(var a="",b=0;b<namesList.length;b++)a+='<option value="'+namesList[b]+'">';d3.select("datalist#list-name").html(a),d3.select("input#name").on("keyup",function(){M(this.value)}),d3.select('#key-people-0 input[name="kpeople"]').on("keyup",function(){N(0)}),d3.select('#funding-0 input[name="fund"]').on("keyup",function(){O(0)}),d3.select('#investing-0 input[name="invest"]').on("keyup",function(){P(0)}),d3.select('#fundinggiven-0 input[name="fundgiven"]').on("keyup",function(){Q(0)}),d3.select('#investmentmade-0 input[name="investmade"]').on("keyup",function(){R(0)}),d3.select('#data-0 input[name="data"]').on("keyup",function(){S(0)}),d3.select("#toFormC").on("click",function(){displayFormC()}),d3.selectAll("#submit-A").on("click",function(){d3.select("#name").style("border-color","#d9d9d9"),d3.select("#location").style("border-color","#d9d9d9"),L()})}function J(){var a={type:null,categories:null,name:null,nickname:null,location:null,url:null,employees:null,key_people:null,twitter_handle:null,followers:null,relations:null,funding_received:null,investments_received:null,funding_given:null,investments_made:null,collaborations:null,data:null,revenue:null,expenses:null,influence:null};if(""===$('input[name="name"]').val()&&""===$('input[name="location"]').val())return{name:null,location:null,errorMessage:"The entity name and location have not been filled out."};if(""===$('input[name="name"]').val())return{name:null,errorMessage:"The entity name has not been filled out."};if(""===$('input[name="location"]').val())return{location:null,errorMessage:"The location has not been filled out."};a.type=$("input#rb_forpro").is(":checked")?"For-Profit":$("input#rb_nonpro").is(":checked")?"Non-Profit":$("input#rb_gov").is(":checked")?"Government":"Individual",a.name=d3.select(".webform-content input[name='name']")[0][0].value,a.categories=[],d3.selectAll(".webform-categories input").filter(function(){if(this.checked===!0)switch(this.value){case"General":a.categories.push("General Civic Tech");break;case"DataAnalytics":a.categories.push("Data and Analytics");break;case"EconGrowthEdu":a.categories.push("Economic Growth and Education");break;case"SRCities":a.categories.push("Smart and Resilient Cities");break;case"SocialServ":a.categories.push("Social Services");break;case"GovTech":a.categories.push("GovTech")}}),0===a.categories.length&&(a.categories=null),a.location=d3.select("input[name='location']")[0][0].value,a.url="",a.url=""===d3.select("input[name='website']")[0][0].value?null:d3.select("input[name='website']")[0][0].value,a.employees="",a.employees=""===d3.select("input[name='employees']")[0][0].value?null:parseInt(d3.select("input[name='employees']")[0][0].value),a.key_people=[],d3.selectAll(".kpeople").filter(function(){""!==this.value&&a.key_people.push(this.value)}),0===a.key_people.length&&(a.key_people=null),a.funding_received=[];var b;d3.selectAll(".fund-input .funder").filter(function(c,d){this.value&&(d3.selectAll(".fund_amt")[0][d].value?(b=d3.selectAll(".fund_amt")[0][d].value,a.funding_received.push(d3.selectAll(".fund_year")[0][d].value?{name:this.value,amount:b,year:d3.selectAll(".fund_year")[0][d].value}:{name:this.value,amount:b,year:null})):(b=null,a.funding_received.push(d3.selectAll(".fund_year")[0][d].value?{name:this.value,amount:b,year:d3.selectAll(".fund_year")[0][d].value}:{name:this.value,amount:b,year:null})))}),0===a.funding_received.length&&(a.funding_received=null),a.funding_given=[];var c;d3.selectAll(".fundgiven-input .fundee").filter(function(b,d){this.value&&(d3.selectAll(".fundgiven_amt")[0][d].value?(c=d3.selectAll(".fundgiven_amt")[0][d].value,a.funding_given.push(d3.selectAll(".fundgiven_year")[0][d].value?{name:this.value,amount:c,year:d3.selectAll(".fundgiven_year")[0][d].value}:{name:this.value,amount:c,year:null})):(c=null,a.funding_given.push(d3.selectAll(".fundgiven_year")[0][d].value?{name:this.value,amount:c,year:d3.selectAll(".fundgiven_year")[0][d].value}:{name:this.value,amount:c,year:null})))}),0===a.funding_given.length&&(a.funding_given=null),a.investments_received=[];var d;d3.selectAll(".invest-input .investor").filter(function(b,c){this.value&&(d3.selectAll(".invest_amt")[0][c].value?(d=d3.selectAll(".invest_amt")[0][c].value,a.investments_received.push(d3.selectAll(".invest_year")[0][c].value?{name:this.value,amount:d,year:d3.selectAll(".invest_year")[0][c].value}:{name:this.value,amount:d,year:null})):(d=null,a.investments_received.push(d3.selectAll(".invest_year")[0][c].value?{name:this.value,amount:d,year:d3.selectAll(".invest_year")[0][c].value}:{name:this.value,amount:d,year:null})))}),0===a.investments_received.length&&(a.investments_received=null),a.investments_made=[];var e;return d3.selectAll(".investmade-input .investee").filter(function(b,c){this.value&&(d3.selectAll(".investmade_amt")[0][c].value?(e=d3.selectAll(".investmade_amt")[0][c].value,a.investments_made.push(d3.selectAll(".investmade_year")[0][c].value?{name:this.value,amount:e,year:d3.selectAll(".investmade_year")[0][c].value}:{name:this.value,amount:e,year:null})):(e=null,a.investments_made.push(d3.selectAll(".investmade_year")[0][c].value?{name:this.value,amount:e,year:d3.selectAll(".investmade_year")[0][c].value}:{name:this.value,amount:e,year:null})))}),0===a.investments_made.length&&(a.investments_made=null),a.data=[],d3.selectAll(".data-entity").filter(function(){""!==this.value&&a.data.push(this.value)}),0===a.data.length&&(a.data=null),a}function K(a){a.nickname=d3.select(".webform-content input[name='nickname']")[0][0].value,a.nickname||(a.nickname=a.name),a.twitter_handle=d3.select(".webform-content input[name='twitterhandle']")[0][0].value,a.twitter_handle||(a.twitter_handle=null),a.influence=$(".webform-influence input#rb_local").is(":checked")?"local":"global",a.collaborations=[],d3.selectAll(".collaborator").filter(function(){this.value&&a.collaborations.push(this.value)}),0===a.collaborations.length&&(a.collaborations=null),a.revenue=[];var b;d3.selectAll(".revenue-input .revenue_amt").filter(function(c,d){this.value&&(b=d3.selectAll(".revenue-input .revenue_year")[0][d].value,a.revenue.push(b?{amount:this.value,year:b}:{amount:this.value,year:null}))}),0===a.revenue.length&&(a.revenue=null),a.expenses=[];var c;return d3.selectAll(".expense-input .expense_amt").filter(function(b,d){this.value&&(c=d3.selectAll(".expense-input .expense_year")[0][d].value,a.expenses.push(c?{amount:this.value,year:c}:{amount:this.value,year:null}))}),0===a.expenses.length&&(a.expenses=null),a}function L(){var a=J();a.location&&a.name?(counterKey=0,counterK=0,counterFund=0,counterF=0,s='<h2 id="webform-head">Information</h2><hr/><div class="webform-content"><div class="input-control text" data-role="input-control"><input type="text" name="name" id="name" placeholder="Name of Entity"/></div><h3 class="form-header">Entity Type</h3><div class="webform-entities"><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_forpro" type="radio" name="entitytype" value="For-Profit" checked="checked"/><span class="check"></span><h4 class="webform-labels">For-Profit</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_nonpro" type="radio" name="entitytype" value="Non-Profit"/><span class="check"></span><h4 class="webform-labels">Non-Profit</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_gov" type="radio" name="entitytype" value="Government"/><span class="check"></span><h4 class="webform-labels">Government</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_individs" type="radio" name="entitytype" value="Individual"/><span class="check"></span><h4 class="webform-labels">Individual</h4></label></div></div><div class="input-control text" data-role="input-control"><input type="text" name="location" id="location" placeholder="City, State"/></div>',s+='<hr/><div class = "input-control text" data-role="input-control"><input type="text" name="nickname" id="nickname" placeholder="Nickname/Abbr."/></div><div class = "input-control text" data-role="input-control"><input type="text" name="twitterhandle" id="twitterhandle" placeholder="Twitter Handle"/></div><h3 class="form-header" style="display:inline-block;">Circle of Influence: </h3><div class="webform-influence"><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_local" type="radio" name="influence-type" value="Local Influence" checked="checked"/><span class="check"></span><h4 class="webform-labels">Local Influence</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_global" type="radio" name="influence-type" value="Global Influence" checked="checked"/><span class="check"></span><h4 class="webform-labels">Global Influence</h4></label></div></div><h3 class="form-header">Collaboration</h3><div id="collaboration-0" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div><h3 class="form-header">Revenue</h3><div id="revenue-0"><div class="revenue-input input-control text" data-role="input-control"><input type="text" name="revenue_amt" class="revenue_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/><input type="text" name="revenue_year" class="revenue_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div><h3 class="form-header">Expenses</h3><div id="expense-0"><div class="expense-input input-control text" data-role="input-control"><input type="text" name="expense_amt" class="expense_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/><input type="text" name="expense_year" class="expense_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div><button type="button" id="submit-B" href="javascript: check_empty()">Submit</button></div>',d3.select("#info").html(s),d3.selectAll("#name").text(function(){this.value=a.name}).attr("disabled",!0),d3.selectAll("#location").text(function(){this.value=a.location}).attr("disabled",!0).style("margin-top","10px"),d3.selectAll('input[name="entitytype"]').filter(function(){this.checked=this.value===a.type?!0:!1,this.disabled=!0}),d3.selectAll('input[name="collaboration"]').on("keyup",function(){T(0)}),d3.selectAll('input[name="revenue_amt"]').on("keyup",function(){U(0)}),d3.selectAll('input[name="expense_amt"]').on("keyup",function(){V(0)}),d3.selectAll("#submit-B").on("click",function(){X(a)})):a.name||a.location?a.name?d3.select("#location").style("border-color","#e51400"):d3.select("#name").style("border-color","#e51400"):(d3.select("#name").style("border-color","#e51400"),d3.select("#location").style("border-color","#e51400"))}function M(a){a=a.toLowerCase(),a in w&&(I(),Y(w[a]))}function N(a){""!==$("#key-people-"+a+' input[name="kpeople"]').val()&&(d3.select("#key-people-"+a+' input[name="kpeople"]').on("keyup",null),a++,$("#key-people-"+(a-1)).after('<div id="key-people-'+a+'" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name"/></div>'),d3.select("#key-people-"+a+" input[name='kpeople']").on("keyup",function(){N(a)}))}function O(a){""!==$("#funding-"+a+' input[name="fund"]').val()&&(d3.select("#funding-"+a+' input[name="fund"]').on("keyup",null),a++,$("#funding-"+(a-1)).after('<div id="funding-'+a+'"><div class="fund-input input-control text" data-role="input-control"><input type="text" name="fund" class="funder" placeholder="Funder" style="display:inline-block; width:50%;"/><input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#funding-"+a+" input[name='fund']").on("keyup",function(){O(a)}))}function P(a){""!==$("#investing-"+a+' input[name="invest"]').val()&&(d3.select("#investing-"+a+' input[name="invest"]').on("keyup",null),a++,$("#investing-"+(a-1)).after('<div id="investing-'+a+'"><div class="invest-input input-control text" data-role="input-control"><input type="text" name="invest" class="investor" placeholder="Investor" style="display:inline-block; width:50%;"/><input type="text" name="invest_amt" class="invest_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="invest_year" class="invest_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#investing-"+a+" input[name='invest']").on("keyup",function(){P(a)}))}function Q(a){""!==$("#fundinggiven-"+a+' input[name="fundgiven"]').val()&&(d3.select("#fundinggiven-"+a+' input[name="fundgiven"]').on("keyup",null),a++,$("#fundinggiven-"+(a-1)).after('<div id="fundinggiven-'+a+'"><div class="fundgiven-input input-control text" data-role="input-control"><input type="text" name="fundgiven" class="fundee" placeholder="Fundee" style="display:inline-block; width:50%;"/><input type="text" name="fundgiven_amt" class="fundgiven_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="fundgiven_year" class="fundgiven_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#fundinggiven-"+a+" input[name='fundgiven']").on("keyup",function(){Q(a)}))}function R(a){""!==$("#investmentmade-"+a+' input[name="investmade"]').val()&&(d3.select("#investmentmade-"+a+' input[name="investmade"]').on("keyup",null),a++,$("#investmentmade-"+(a-1)).after('<div id="investmentmade-'+a+'"><div class="investmade-input input-control text" data-role="input-control"><input type="text" name="investmade" class="investee" placeholder="Investee" style="display:inline-block; width:50%;"/><input type="text" name="investmade_amt" class="investmade_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="investmade_year" class="investmade_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#investmentmade-"+a+" input[name='investmade']").on("keyup",function(){R(a)}))}function S(a){""!==$("#data-"+a+' input[name="data"]').val()&&(d3.select("#data-"+a+' input[name="data"]').on("keyup",null),a++,$("#data-"+(a-1)).after('<div id="data-'+a+'" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div>'),d3.select("#data-"+a+" input[name='data']").on("keyup",function(){S(a)}))}function T(a){""!==$("#collaboration-"+a+' input[name="collaboration"]').val()&&(d3.select("#collaboration-"+a+' input[name="collaboration"]').on("keyup",null),a++,$("#collaboration-"+(a-1)).after('<div id="collaboration-'+a+'" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div>'),d3.select("#collaboration-"+a+" input[name='collaboration']").on("keyup",function(){T(a)}))}function U(a){""!==$("#revenue-"+a+' input[name="revenue_amt"]').val()&&(d3.select("#revenue-"+a+' input[name="revenue_amt"]').on("keyup",null),a++,$("#revenue-"+(a-1)).after('<div id="revenue-'+a+'"><div class="revenue-input input-control text" data-role="input-control"><input type="text" name="revenue_amt" class="revenue_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/><input type="text" name="revenue_year" class="revenue_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#revenue-"+a+" input[name=revenue_amt]").on("keyup",function(){U(a)}))}function V(a){""!==$("#expense-"+a+' input[name="expense_amt"]').val()&&(d3.select("#expense-"+a+' input[name="expense_amt"]').on("keyup",null),a++,$("#expense-"+(a-1)).after('<div id="expense-'+a+'"><div class="expense-input input-control text" data-role="input-control"><input type="text" name="expense_amt" class="expense_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/><input type="text" name="expense_year" class="expense_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#expense-"+a+" input[name=expense_amt]").on("keyup",function(){V(a)}))}function W(){return s='<h2 id="webform-head">Information</h2><hr/><div class="webform-content"><div class="input-control text" data-role="input-control"><input type="text" name="name" id="name" placeholder="Name of Entity" list="list-name"/><datalist id="list-name"></datalist></div><h3 class="form-header">What type of entity?</h3><div class="webform-entities"><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_forpro" type="radio" name="entitytype" value="For-Profit" checked="checked"/><span class="check"></span><h4 class="webform-labels">For-Profit</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_nonpro" type="radio" name="entitytype" value="Non-Profit"/><span class="check"></span><h4 class="webform-labels">Non-Profit</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_gov" type="radio" name="entitytype" value="Government"/><span class="check"></span><h4 class="webform-labels">Government</h4></label></div><div data-role="input-control" class="input-control radio default-style webform"><label><input id="rb_individs" type="radio" name="entitytype" value="Individual"/><span class="check"></span><h4 class="webform-labels">Individual</h4></label></div></div><h3 class="form-header">What kind of work do they do?</h3><h4>(Select All That Apply)</h4><div class="webform-categories"><div data-role="input-control" class="input-control checkbox webform"><label><input id="cb_gen" type="checkbox" name="gen" data-show="general" value="General"/><span class="check"></span><h4 class="webform-labels">General Civic Tech</h4></label></div><div data-role="input-control" class="input-control checkbox webform"><label><input id="cb_datat" type="checkbox" name="datat" data-show="datalytics" value="DataAnalytics"/><span class="check"></span><h4 class="webform-labels">Data & Analytics</h4></label></div><div data-role="input-control" class="input-control checkbox webform"><label><input id="cb_eced" type="checkbox" name="eced" data-show="econedu" value="EconGrowthEdu"/><span class="check"></span><h4 class="webform-labels">Jobs & Education</h4></label></div><div data-role="input-control" class="input-control checkbox webform"><label><input id="cb_src" type="checkbox" name="srcities" data-show="srcities" value="SRCities"/><span class="check"></span><h4 class="webform-labels">Smart & Resilient Cities</h4></label></div><div data-role="input-control" class="input-control checkbox webform"><label><input id="cb_socs" type="checkbox" name="socserv" data-show="socserv" value="SocialServ"/><span class="check"></span><h4 class="webform-labels">Social Services</h4></label></div><div data-role="input-control" class="input-control checkbox webform"><label><input id="cb_govt" type="checkbox" name="govtech" data-show="govtech" value="GovTech"/><span class="check"></span><h4 class="webform-labels">GovTech</h4></label></div></div><div class="input-control text" data-role="input-control"><input type="text" name="location" id="location" placeholder="City, State"/></div><div class="input-control text" data-role="input-control"><input type="text" name="website" id="website" placeholder="Website"/></div><h3 class="form-header" style="display:inline-block;">Number of Employees</h3><div class="input-control text" data-role="input-control" style="width:27% !important; display:inline-block; float:right; margin-top: 2%;"><input type="text" name="employees" id="employee" maxlength="6" style="width:100% !important;"/></div><h3 class="form-header">Key People?</h3><div id="key-people-0" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name"/></div><h3 class="form-header">Who funds them via grants?</h3><div id="funding-0"><div class="fund-input input-control text" data-role="input-control"><input type="text" name="fund" class="funder" placeholder="Funder" style="display:inline-block; width:50%;"/><input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div><h3 class="form-header">Who invests in them via equity stakes (stock)?</h3><div id="investing-0"><div class="invest-input input-control text" data-role="input-control"><input type="text" name="invest" class="investor" placeholder="Investor" style="display:inline-block; width:50%;"/><input type="text" name="invest_amt" class="invest_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="invest_year" class="invest_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div><h3 class="form-header">Who do they fund via grants?</h3><div id="fundinggiven-0"><div class="fundgiven-input input-control text" data-role="input-control"><input type="text" name="fundgiven" class="fundee" placeholder="Fundee" style="display:inline-block; width:50%;"/><input type="text" name="fundgiven_amt" class="fundgiven_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="fundgiven_year" class="fundgiven_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div><h3 class="form-header">Who do they invest in via equity stakes (stock)?</h3><div id="investmentmade-0"><div class="investmade-input input-control text" data-role="input-control"><input type="text" name="investmade" class="investee" placeholder="Investee" style="display:inline-block; width:50%;"/><input type="text" name="investmade_amt" class="investmade_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="investmade_year" class="investmade_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div><h3 class="form-header">Who provides them with data?</h3><div id="data-0" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div><div id="nextPhase"><span>Almost done...</span><button type="button" id="submit-A" href="javascript: check_empty()">Next</button></div></div><hr/><div class="webform-footer"><span id="">Some entities lack adequate information. Would you like to help?</span><br/><span id="toFormC">Click here!</span></div>',s
}function X(a){var b=K(a),c="";c+='<h2 id="webform-head">Information</h2><hr/><div style="text-align:center;" class="webform-content"><p>Thanks for submitting information to Athena!</p><p>Might you be interested in helping with other entities?</p>',c+='<ul id="suggestions">',c+="</ul></div>",d3.select("#info").html(c),d3.selectAll("#info ul a").on("click",function(a,b){fb(suggestions[b]),I(),Y(suggestions[b])}),$.ajax({type:"POST",data:$.param(b),url:"/database/save",crossDomain:!0}).done(function(){})}function Y(a){if(d3.selectAll("#name").text(function(){this.value=a.name}),d3.selectAll("#location").text(function(){this.value=a.location}),d3.selectAll('input[name="entitytype"]').filter(function(){this.checked=this.value===a.type?!0:!1}),null!==a.categories&&d3.selectAll(".webform-categories input").filter(function(b,c){this.checked=a.categories.indexOf(d3.selectAll(".webform-categories h4")[0][c].textContent)>-1?!0:!1}),d3.selectAll("#website").text(function(){this.value=a.url}),d3.selectAll("#employee").text(function(){this.value=a.employees}),null!==a.key_people){for(var b=a.key_people,c=0;c<b.length;c++)$("#key-people-"+c).after('<div id="key-people-'+(c+1)+'" class="input-control text" data-role="input-control"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name""/></div>'),d3.select("#key-people-"+c+' input[name="kpeople"]').on("keyup",null),d3.select("#key-people-"+c+' input[name="kpeople"]').text(function(){this.value=b[c]});d3.select("#key-people-"+b.length+' input[name="kpeople"]').on("keyup",function(){N(b.length)})}if(null!==a.funding_received){var d=a.funding_received;d.forEach(function(a,b){$("#funding-"+b).after('<div id="funding-'+(b+1)+'"><div class="fund-input input-control text" data-role="input-control"><input type="text" name="fund" class="funder" placeholder="Funder" style="display:inline-block; width:50%;"/><input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#funding-"+b+' input[name="fund"]').on("keyup",null),d3.select("#funding-"+b+' input[name="fund"]').text(function(){this.value=a.entity}),d3.select("#funding-"+b+' input[name="fund_amt"]').text(function(){this.value=a.amount}),d3.select("#funding-"+b+' input[name="fund_year"]').text(function(){this.value=a.year})}),d3.select("#funding-"+d.length+" input[name='fund']").on("keyup",function(){O(d.length)})}if(null!==a.funding_given){var e=a.funding_given;e.forEach(function(a,b){$("#fundinggiven-"+b).after('<div id="fundinggiven-'+(b+1)+'"><div class="fundgiven-input input-control text" data-role="input-control"><input type="text" name="fundgiven" class="fundee" placeholder="Fundee" style="display:inline-block; width:50%;"/><input type="text" name="fundgiven_amt" class="fundgiven_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="fundgiven_year" class="fundgiven_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#fundinggiven-"+b+' input[name="fundgiven"]').on("keyup",null),d3.select("#fundinggiven-"+b+' input[name="fundgiven"]').text(function(){this.value=a.entity}),d3.select("#fundinggiven-"+b+' input[name="fundgiven_amt"]').text(function(){this.value=a.amount}),d3.select("#fundinggiven-"+b+' input[name="fundgiven_year"]').text(function(){this.value=a.year})}),d3.select("#fundinggiven-"+e.length+" input[name='fundgiven']").on("keyup",function(){Q(e.length)})}if(null!==a.investments_received){var f=a.investments_received;f.forEach(function(a,b){$("#investing-"+b).after('<div id="investing-'+(b+1)+'"><div class="invest-input input-control text" data-role="input-control"><input type="text" name="invest" class="investor" placeholder="Investor" style="display:inline-block; width:50%;"/><input type="text" name="invest_amt" class="invest_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="invest_year" class="invest_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#investing-"+b+' input[name="invest"]').on("keyup",null),d3.select("#investing-"+b+' input[name="invest"]').text(function(){this.value=a.entity}),d3.select("#investing-"+b+' input[name="invest_amt"]').text(function(){this.value=a.amount}),d3.select("#investing-"+b+' input[name="invest_year"]').text(function(){this.value=a.year})}),d3.select("#investing-"+f.length+" input[name='invest']").on("keyup",function(){P(f.length)})}if(null!==a.investments_made){var g=a.investments_made;g.forEach(function(a,b){$("#investmentmade-"+b).after('<div id="investmentmade-'+(b+1)+'"><div class="investmade-input input-control text" data-role="input-control"><input type="text" name="investmade" class="investee" placeholder="Investee" style="display:inline-block; width:50%;"/><input type="text" name="investmade_amt" class="investmade_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/><input type="text" name="investmade_year" class="investmade_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#investmentmade-"+b+' input[name="investmade"]').on("keyup",null),d3.select("#investmentmade-"+b+' input[name="investmade"]').text(function(){this.value=a.entity}),d3.select("#investmentmade-"+b+' input[name="investmade_amt"]').text(function(){this.value=a.amount}),d3.select("#investmentmade-"+b+' input[name="investmade_year"]').text(function(){this.value=a.year})}),d3.select("#investmentmade-"+g.length+" input[name='investmade']").on("keyup",function(){R(g.length)})}if(null!==a.data){var h=a.data;h.forEach(function(a,b){$("#data-"+b).after('<div id="data-'+(b+1)+'" class="input-control text" data-role="input-control"><input type="text" name="data" class="data-entity" placeholder="Data Resource"/></div>'),d3.select("#data-"+b+' input[name="data"]').on("keyup",null),d3.select("#data-"+b+' input[name="data"]').text(function(){this.value=a.entity})}),d3.select("#data-"+h.length+" input[name='data']").on("keyup",function(){S(h.length)})}d3.selectAll("#submit-A").on("click",function(){d3.select("#name").style("border-color","#d9d9d9"),d3.select("#location").style("border-color","#d9d9d9"),L(),Z(a)})}function Z(a){if(d3.selectAll("#nickname").text(function(){this.value=a.nickname}),d3.selectAll("#twitterhandle").text(function(){this.value=a.twitter_handle}),d3.selectAll('input[name="influence-type"]').filter(function(){this.checked="local"===a.influence&&"Local Influence"===this.value?!0:"global"===a.influence&&"Global Influence"===this.value?!0:!1}),null!==a.collaborations){var b=a.collaborations;b.forEach(function(a,b){$("#collaboration-"+b).after('<div id="collaboration-'+(b+1)+'" class="input-control text" data-role="input-control"><input type="text" name="collaboration" class="collaborator" placeholder="Collaborator"/></div>'),d3.select("#collaboration-"+b+' input[name="collaboration"]').on("keyup",null),d3.select("#collaboration-"+b+' input[name="collaboration"]').text(function(){this.value=a.entity})}),d3.select("#collaboration-"+b.length+' input[name="collaboration"]').on("keyup",function(){T(b.length)})}if(null!==a.expenses){var c=a.expenses;c.forEach(function(a,b){$("#expense-"+b).after('<div id="expense-'+(b+1)+'"><div class="expense-input input-control text" data-role="input-control"><input type="text" name="expense_amt" class="expense_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/><input type="text" name="expense_year" class="expense_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#expense-"+b+' input[name="expense_amt"]').on("keyup",null),d3.select("#expense-"+b+' input[name="expense_amt"]').text(function(){this.value=a.amount}),d3.select("#expense-"+b+' input[name="expense_year"]').text(function(){this.value=a.year})}),d3.select("#expense-"+c.length+' input[name="expense_amt"]').on("keyup",function(){V(c.length)})}if(null!==a.revenue){var d=a.revenue;d.forEach(function(a,b){$("#revenue-"+b).after('<div id="revenue-'+(b+1)+'"><div class="revenue-input input-control text" data-role="input-control"><input type="text" name="revenue_amt" class="revenue_amt" placeholder="Amount" style="display:inline-block; width: 57%;"/><input type="text" name="revenue_year" class="revenue_year" placeholder="Year" style="display:inline-block; width: 20%;"/></div></div>'),d3.select("#revenue-"+b+' input[name="revenue_amt"]').on("keyup",null),d3.select("#revenue-"+b+' input[name="revenue_amt"]').text(function(){this.value=a.amount}),d3.select("#revenue-"+b+' input[name="revenue_year"]').text(function(){this.value=a.year})}),d3.select("#revenue-"+d.length+' input[name="revenue_amt"]').on("keyup",function(){U(d.length)})}}function ab(){for(var a="",b=[0,0,0,0],c=[],d=[],e=[],f=[],g=0;g<p.length;g++)"Individual"===p[g].type&&(f.push(p[g].name),Bb.push(p[g]),b[3]++),"Non-Profit"===p[g].type&&(d.push(p[g].name),zb.push(p[g]),b[1]++),"For-Profit"===p[g].type&&(c.push(p[g].name),yb.push(p[g]),b[0]++),"Government"===p[g].type&&(e.push(p[g].name),Ab.push(p[g]),b[2]++);a+="<h3 style='padding-bottom:10px;'>The Data</h3>",d3.select("#info").html(a).style("list-style","square"),d3.select("#info").append("div").attr("id","breakdown").style("width","100%");var g=d3.scale.linear().domain([0,d3.max(b)]).range([0,$("#breakdown").width()]),h=0,i=0;d3.select("#breakdown").selectAll("div").data(b).enter().append("div").style("width",function(a){return g(a)/5+"%"}).style("height","20px").style("font","8px sans-serif").style("background-color",function(){return 0===h?(h++,"rgb(127,186,0)"):1===h?(h++,"rgb(0,164,239)"):2===h?(h++,"rgb(242,80,34)"):3===h?(h++,"rgb(255,185,0)"):void 0}).style("text-align","right").style("padding","3px").style("margin","1px").style("color","white").text(function(){return 0===i?void i++:1===i?void i++:2===i?void i++:3===i?void i++:void 0});var j="";j+="<h3 style='padding-top:15px; color:rgb(127,186,0);'>For-Profit ("+b[0]+"):</h3> ";for(var g=0;g<c.length;g++)j+=g===c.length-1?"<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+c[g]+"</a>":"<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+c[g]+", </a>";j+="<h3 style='padding-top:15px; color:rgb(0,164,239);'>Non-Profit ("+b[1]+"):</h3> ";for(var g=0;g<d.length;g++)j+=g===d.length-1?"<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+d[g]+"</a>":"<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+d[g]+", </a>";j+="<h3 style='padding-top:15px; color:rgb(242,80,34);'>Government ("+b[2]+"):</h3> ";for(var g=0;g<e.length;g++)j+=g===e.length-1?"<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+e[g]+"</a>":"<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+e[g]+", </a>";j+="<h3 style='padding-top:15px; color:rgb(255,185,0);'>Individual ("+b[3]+"):</h3> ";for(var g=0;g<f.length;g++)j+=g===f.length-1?"<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+f[g]+"</a>":"<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+f[g]+", </a>";d3.select("#info").append("text").style("padding-bottom","20px").html(j)}function bb(){var a="";p.forEach(function(a){if(Cb.push(a.name.toLowerCase()),Db.push(a.location.toLowerCase()),Eb.push(a.nickname.toLowerCase()),-1===Fb.indexOf(a.name)&&null!==a.name&&(Fb.push(a.name),w[a.name.toLowerCase()]=a),-1===Fb.indexOf(a.nickname)&&null!==a.nickname&&(Gb.push(a.nickname),w[a.nickname.toLowerCase()]=a),-1===Hb.indexOf(a.location)&&null!==a.location){var b=a.location.split("; ");b.forEach(function(a){-1===Hb.indexOf(a)&&Hb.push(a)})}if(a.location.toLowerCase()in y)console.log("Else: "+a.location),y[a.location.toLowerCase()].push(a);else{console.log("If: "+a.location);var b=a.location.split("; ");b.forEach(function(b){b.toLowerCase()in y?y[b.toLowerCase()].push(a):(y[b.toLowerCase()]=[],y[b.toLowerCase()].push(a))})}}),Ib=Ib.concat(Hb),Ib=Ib.concat(Gb),Ib=Ib.concat(Fb),Ib=Ib.sort(),console.log(y);for(var b=0;b<Ib.length;b++)a+='<option value="'+Ib[b]+'">';d3.select(".filter-name-location datalist").html(a)}function cb(a){a=a.toLowerCase(),-1!==Cb.indexOf(a)?Cb.forEach(function(b){if(b===a&&b.length===a.length){var c=Cb.indexOf(a);vb.filter(function(a,b){b===c&&fb(a)})}}):-1!==Eb.indexOf(a)?Eb.forEach(function(b){if(b===a&&b.length===a.length){var c=Eb.indexOf(a);vb.filter(function(a,b){b===c&&fb(a)})}}):(rb.style("opacity",function(b){return b.source.location.toLowerCase()===a&&b.target.location.toLowerCase()===a?1:.05}),sb.style("opacity",function(b){return b.source.location.toLowerCase()===a&&b.target.location.toLowerCase()===a?1:.05}),tb.style("opacity",function(b){return b.source.location.toLowerCase()===a&&b.target.location.toLowerCase()===a?1:.05}),ub.style("opacity",function(b){return b.source.location.toLowerCase()===a&&b.target.location.toLowerCase()===a?1:.05}),d3.selectAll("circle").style("stroke","white"),d3.selectAll(".node").style("opacity",function(b){return-1===b.location.toLowerCase().indexOf(a)?.05:1}).select("text").style("opacity",1),xb.on("mouseout",null).on("mouseover",null).on("click",null),xb.filter(function(a,b){return 1==vb[0][b].style.opacity}).on("mouseover",C))}function db(a){var b=H(a);webform=G(a),d3.select("#edit").html(webform),d3.select("#info").html(b).style("list-style","square"),rb.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),sb.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),tb.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),ub.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"});var c=function(a,b){return a.target.index===b.index},d=function(a,b){return a.source.index===b.index},e={};e[a.ID]=1,t.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),u.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),q.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),r.forEach(function(b){d(b,a)&&(e[b.target.index]=1),c(b,a)&&(e[b.source.index]=1)}),d3.select(this).style("stroke","rgba(0,0,0,0.6)"),z.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(a){return a.ID in e?"1":"0.05"}).select("text").style("opacity",1),d3.select(this.parentNode).select("text").transition().duration(350).delay(0).style("opacity",1).style("font-weight","bold")}function eb(){xb.style("stroke","white").on("mouseover",db).on("mouseout",eb).on("click",fb),rb.transition().duration(350).delay(0).style("stroke","rgb(111,93,168)").style("opacity","0.2").style("stroke-width","1px"),sb.transition().duration(350).delay(0).style("stroke","rgb(38,114,114)").style("opacity","0.2").style("stroke-width","1px"),tb.transition().duration(350).delay(0).style("stroke","rgb(235,232,38)").style("opacity","0.2").style("stroke-width","1px"),ub.transition().duration(350).delay(0).style("stroke","rgb(191,72,150)").style("opacity","0.2").style("stroke-width","1px"),d3.selectAll(".node").transition().duration(350).delay(0).style("opacity","1"),d3.selectAll(".node").selectAll("text").transition().duration(350).delay(0).style("opacity",function(a){var b;return"For-Profit"===a.type&&(b=k.hasOwnProperty(a.name)?1:0),"Non-Profit"===a.type&&(b=l.hasOwnProperty(a.name)?1:0),"Individual"===a.type&&(b=m.hasOwnProperty(a.name)?1:0),"Government"===a.type&&(b=n.hasOwnProperty(a.name)?1:0),b}).style("font-size","14px").style("font-weight","normal")}function fb(a){o=0,C(a),rb.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),sb.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),tb.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),ub.transition().duration(350).delay(0).style("opacity",function(b){return a===b.source||a===b.target?"1":"0.05"}),xb.style("stroke",function(b){return b!==a?"white":"black"}).on("mouseout",null),xb.filter(function(b){return b!==a?b:void 0}).on("mouseover",null);var b=A.funding_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index}),c=A.investment_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index}),d=A.collaboration_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index}),e=A.data_connections.filter(function(b){return b.source.index===a.index||b.target.index===a.index}).map(function(b){return b.source.index===a.index?b.target.index:b.source.index});z.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(f){return b.indexOf(f.index)>-1||c.indexOf(f.index)>-1||d.indexOf(f.index)>-1||e.indexOf(f.index)>-1||f===a?1:.05}),xb.filter(function(f){return b.indexOf(f.index)>-1||c.indexOf(f.index)>-1||d.indexOf(f.index)>-1||e.indexOf(f.index)>-1||f===a}).on("mouseover",C).on("click",function(){})}function gb(){xb.on("mouseover",null).on("mouseout",null).on("click",null)}function hb(){d3.select(this).classed("fixed",function(a){a.fixed=!0}),xb.on("mouseover",db).on("mouseout",eb).on("click",fb)}function ib(a){var c=8*a.alpha;p.forEach(function(a){null!==a.type&&("Individual"===a.type&&(a.x+=c+c,a.y+=c+c),"Non-Profit"===a.type&&(a.x+=-c-c,a.y+=c+c),"For-Profit"===a.type&&(a.x+=c+c,a.y+=-c-c),"Government"===a.type&&(a.x+=-c-c,a.y+=-c-c))}),_.isEmpty(v)?(rb.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),sb.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),tb.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),ub.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),xb.attr("cx",function(a){return a.x=a.x}).attr("cy",function(a){return a.y=a.y}),wb.attr("transform",b)):(rb.attr("x1",function(a){return a.source===v?(a.source.x=v.x,a.source.x):a.source.x}).attr("y1",function(a){return a.source===v?(a.source.y=v.y,a.source.y):a.source.y}).attr("x2",function(a){return a.target===v?(a.target.x=v.x,a.target.x):a.target.x}).attr("y2",function(a){return a.target===v?(a.target.y=v.y,a.target.y):a.target.y}),sb.attr("x1",function(a){return a.source===v?(a.source.x=v.x,a.source.x):a.source.x}).attr("y1",function(a){return a.source===v?(a.source.y=v.y,a.source.y):a.source.y}).attr("x2",function(a){return a.target===v?(a.target.x=v.x,a.target.x):a.target.x}).attr("y2",function(a){return a.target===v?(a.target.y=v.y,a.target.y):a.target.y}),tb.attr("x1",function(a){return a.source===v?(a.source.x=v.x,a.source.x):a.source.x}).attr("y1",function(a){return a.source===v?(a.source.y=v.y,a.source.y):a.source.y}).attr("x2",function(a){return a.target===v?(a.target.x=v.x,a.target.x):a.target.x}).attr("y2",function(a){return a.target===v?(a.target.y=v.y,a.target.y):a.target.y}),ub.attr("x1",function(a){return a.source===v?(a.source.x=v.x,a.source.x):a.source.x}).attr("y1",function(a){return a.source===v?(a.source.y=v.y,a.source.y):a.source.y}).attr("x2",function(a){return a.target===v?(a.target.x=v.x,a.target.x):a.target.x}).attr("y2",function(a){return a.target===v?(a.target.y=v.y,a.target.y):a.target.y}),xb.attr("cx",function(a,b){return d3.select(xb)[0][0].data()[b].name===v.name?(a.x=v.x,a.x):a.x=a.x}).attr("cy",function(a,b){return d3.select(xb)[0][0].data()[b].name===v.name?(a.y=v.y,a.y):a.y=a.y}),wb.attr("transform",b))}function jb(){for(var a=[],b=0;b<vb[0].length;b++)"visible"===vb[0][b].style.visibility&&a.push(b);var c=[];return vb.filter(function(b,d){a.indexOf(d)>-1&&c.push(b)}),c}var kb=A.nodes,lb=A.funding_connections,mb=A.investment_connections,nb=A.collaboration_connections,ob=A.data_connections,pb=lb.concat(mb).concat(nb).concat(ob);p=kb.filter(function(a){return 1===a.render}),t=lb.filter(function(a){return 1===a.render}),u=mb.filter(function(a){return 1===a.render}),q=nb.filter(function(a){return 1===a.render}),r=ob.filter(function(a){return 1===a.render});var qb=(t.concat(u).concat(q).concat(r),d3.layout.force().nodes(kb).size([i,j]).links(pb).linkStrength(0).charge(function(a){return null!==a.employees?-6*E(a.employees):-25}).linkDistance(50).on("tick",ib).start()),gb=qb.drag().on("dragstart",gb).on("drag",gb).on("dragend",hb),rb=z.selectAll(".fund").data(t).enter().append("line").attr("class","fund").style("stroke","rgb(111,93,168)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),sb=z.selectAll(".invest").data(u).enter().append("line").attr("class","invest").style("stroke","rgb(38,114,114)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),tb=z.selectAll(".porucs").data(q).enter().append("line").attr("class","porucs").style("stroke","rgb(235,232,38)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),ub=z.selectAll(".data").data(r).enter().append("line").attr("class","data").style("stroke","rgb(191,72,150)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible"),vb=z.selectAll(".node").data(p).enter().append("g").attr("class","node").style("visibility","visible").on("dblclick",B).call(gb);e=z.selectAll(".node").filter(function(a){return"For-Profit"===a.type}).sort(function(a,b){return a.weight-b.weight}),f=z.selectAll(".node").filter(function(a){return"Non-Profit"===a.type}).sort(function(a,b){return a.weight-b.weight}),g=z.selectAll(".node").filter(function(a){return"Individual"===a.type}).sort(function(a,b){return a.weight-b.weight}),h=z.selectAll(".node").filter(function(a){return"Government"===a.type}).sort(function(a,b){return a.weight-b.weight}),e.each(function(a,b){b>=e[0].length-5&&(k[a.name]=a.weight)}),f.each(function(a,b){b>=f[0].length-5&&(l[a.name]=a.weight)}),g.each(function(a,b){b>=g[0].length-5&&(m[a.name]=a.weight)}),h.each(function(a,b){b>=h[0].length-5&&(n[a.name]=a.weight)});var wb=z.selectAll(".node").append("text").text(function(a){return a.nickname}).attr("x",0).attr("dy","0.1em").attr("y",function(a){return null!==a.employees?E(a.employees)+10:17}).style("opacity",function(a){var b;return"For-Profit"===a.type&&(b=k.hasOwnProperty(a.name)?1:0),"Non-Profit"===a.type&&(b=l.hasOwnProperty(a.name)?1:0),"Individual"===a.type&&(b=m.hasOwnProperty(a.name)?1:0),"Government"===a.type&&(b=n.hasOwnProperty(a.name)?1:0),b}).style("font-size","14px").style("color","#FFFFFF").style("pointer-events","none"),xb=vb.append("circle").attr("r",function(a){return null!==a.employees?E(a.employees):"7"}).style("fill",function(a){if(null!==a.type){if("Individual"===a.type)return"rgb(255,185,0)";if("Non-Profit"===a.type)return"rgb(0,164,239)";if("For-Profit"===a.type)return"rgb(127,186,0)";if("Government"===a.type)return"rgb(242,80,34)"}}).attr("cx",function(a){return a.x}).attr("cy",function(a){return a.y}).style("stroke-width","1.5px").style("stroke","white").on("mouseover",db).on("mouseout",eb).on("click",fb);for(wb.call(a,80);qb.alpha()>.025;)qb.tick();d3.selectAll("#edit").on("click",I);var yb=[],zb=[],Ab=[],Bb=[];ab(),d3.selectAll(".for-profit-entity").on("click",function(a,b){fb(yb[b])}),d3.selectAll(".non-profit-entity").on("click",function(a,b){fb(zb[b])}),d3.selectAll(".individual-entity").on("click",function(a,b){fb(Bb[b])}),d3.selectAll(".government-entity").on("click",function(a,b){fb(Ab[b])}),d3.selectAll(".click-location").on("click",function(){cb(this.innerHTML)});var Cb=[],Db=[],Eb=[],Fb=[],Gb=[],Hb=[],Ib=[];bb(),d3.selectAll("#search-text").on("keydown",function(){if(13===d3.event.keyCode){var a=document.getElementById("search-text").value;cb(a)}}),d3.selectAll("option").on("keydown",function(a,b){if(13===d3.event.keyCode){var c=d3.selectAll("option")[0][b].value;cb(c)}}),d3.selectAll("#cb_fund").on("click",function(){var a=jb();if(document.getElementById("cb_fund").checked){var b=0;d3.selectAll(".fund").style("visibility",function(c){return a.indexOf(c.source)>-1&&a.indexOf(c.target)>-1&&"hidden"===this.style.visibility?(b++,"visible"):"hidden"})}document.getElementById("cb_fund").checked||d3.selectAll(".fund").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_fund").checked=!1)}),d3.selectAll("#cb_invest").on("click",function(){var a=jb();document.getElementById("cb_invest").checked&&d3.selectAll(".invest").style("visibility",function(b){return a.indexOf(b.source)>-1&&a.indexOf(b.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_invest").checked||d3.selectAll(".invest").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_invest").checked=!1)}),d3.selectAll("#cb_porucs").on("click",function(){var a=jb();document.getElementById("cb_porucs").checked&&d3.selectAll(".porucs").style("visibility",function(b){return a.indexOf(b.source)>-1&&a.indexOf(b.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_porucs").checked||d3.selectAll(".porucs").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_porucs").checked=!1)}),d3.selectAll("#cb_data").on("click",function(){var a=jb();document.getElementById("cb_data").checked&&d3.selectAll(".data").style("visibility",function(b){return a.indexOf(b.source)>-1&&a.indexOf(b.target)>-1&&"hidden"===this.style.visibility?"visible":"hidden"}),document.getElementById("cb_data").checked||d3.selectAll(".data").style("visibility",function(){return"hidden"}),0!==a.length&&(document.getElementById("cb_individ").checked||document.getElementById("cb_forpro").checked||document.getElementById("cb_nonpro").checked||document.getElementById("cb_gov").checked)||(document.getElementById("cb_data").checked=!1)}),d3.selectAll("#cb_individ, #cb_nonpro, #cb_forpro, #cb_gov").on("click",function(){function a(){for(var a=arguments,b={},c=[],d=0;d<a.length;d++)for(var e=0;e<a[d].length;e++)b[a[d][e]]!==!0&&(c[c.length]=a[d][e],b[a[d][e]]=!0);return c}var b=[],c=[],d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],s=[],v=[],w=[],x=[],y=[],z=[],A=[],B=[],C=[],D=[],E=[],F=[],G=[],H=[],I=[],J=[],K=[],L=[],M=[],N=[],O=[],P=[],Q=[],R=[],S=[],T=[];document.getElementById("cb_individ").checked&&(d3.selectAll(".node").filter(function(a){return"Individual"===a.type?this:void 0}).style("visibility","visible"),f=0,p.forEach(function(a){"Individual"===a.type&&(t.forEach(function(c){(a===c.source||a===c.target)&&b.push(f),f++}),f=0)}),f=0,p.forEach(function(a){"Individual"===a.type&&(u.forEach(function(b){(a===b.source||a===b.target)&&c.push(f),f++}),f=0)}),f=0,p.forEach(function(a){"Individual"===a.type&&(q.forEach(function(b){(a===b.source||a===b.target)&&d.push(f),f++}),f=0)}),countIndex0=0,p.forEach(function(a){"Individual"===a.type&&(r.forEach(function(b){(a===b.source||a===b.target)&&e.push(countIndex0),countIndex0++}),countIndex0=0)})),document.getElementById("cb_individ").checked||(d3.selectAll(".node").filter(function(a){return"Individual"===a.type?this:void 0}).style("visibility","hidden"),E=0,p.forEach(function(a){"Individual"===a.type&&(t.forEach(function(b){(a===b.source||a===b.target)&&A.push(E),E++}),E=0)}),E=0,p.forEach(function(a){"Individual"===a.type&&(u.forEach(function(b){(a===b.source||a===b.target)&&B.push(E),E++}),E=0)}),E=0,p.forEach(function(a){"Individual"===a.type&&(q.forEach(function(b){(a===b.source||a===b.target)&&C.push(E),E++}),E=0)}),E=0,p.forEach(function(a){"Individual"===a.type&&(r.forEach(function(b){(a===b.source||a===b.target)&&D.push(E),E++}),E=0)})),document.getElementById("cb_nonpro").checked&&(d3.selectAll(".node").filter(function(a){return"Non-Profit"===a.type?this:void 0}).style("visibility","visible"),k=0,p.forEach(function(a){"Non-Profit"===a.type&&(t.forEach(function(b){a!==b.source&&a!==b.target||-1!==g.indexOf(k)||g.push(k),k++}),k=0)}),k=0,p.forEach(function(a){"Non-Profit"===a.type&&(u.forEach(function(b){a!==b.source&&a!==b.target||-1!==h.indexOf(k)||h.push(k),k++}),k=0)}),k=0,p.forEach(function(a){"Non-Profit"===a.type&&(q.forEach(function(b){a!==b.source&&a!==b.target||-1!==i.indexOf(k)||i.push(k),k++}),k=0)}),k=0,p.forEach(function(a){"Non-Profit"===a.type&&(r.forEach(function(b){a!==b.source&&a!==b.target||-1!==j.indexOf(k)||j.push(k),k++}),k=0)})),document.getElementById("cb_nonpro").checked||(d3.selectAll(".node").filter(function(a){return"Non-Profit"===a.type?this:void 0}).style("visibility","hidden"),J=0,p.forEach(function(a){"Non-Profit"===a.type&&(t.forEach(function(b){a!==b.source&&a!==b.target||-1!==F.indexOf(J)||F.push(J),J++}),J=0)}),J=0,p.forEach(function(a){"Non-Profit"===a.type&&(u.forEach(function(b){a!==b.source&&a!==b.target||-1!==G.indexOf(J)||G.push(J),J++}),J=0)}),J=0,p.forEach(function(a){"Non-Profit"===a.type&&(q.forEach(function(b){a!==b.source&&a!==b.target||-1!==H.indexOf(J)||H.push(J),J++}),J=0)}),J=0,p.forEach(function(a){"Non-Profit"===a.type&&(r.forEach(function(b){a!==b.source&&a!==b.target||-1!==I.indexOf(J)||I.push(J),J++}),J=0)})),document.getElementById("cb_forpro").checked&&(d3.selectAll(".node").filter(function(a){return"For-Profit"===a.type?this:void 0}).style("visibility","visible"),s=0,p.forEach(function(a){"For-Profit"===a.type&&(t.forEach(function(b){a!==b.source&&a!==b.target||-1!==l.indexOf(s)||l.push(s),s++}),s=0)}),s=0,p.forEach(function(a){"For-Profit"===a.type&&(u.forEach(function(b){a!==b.source&&a!==b.target||-1!==m.indexOf(s)||m.push(s),s++}),s=0)}),s=0,p.forEach(function(a){"For-Profit"===a.type&&(q.forEach(function(b){a!==b.source&&a!==b.target||-1!==n.indexOf(s)||n.push(s),s++}),s=0)}),s=0,p.forEach(function(a){"For-Profit"===a.type&&(r.forEach(function(b){a!==b.source&&a!==b.target||-1!==o.indexOf(s)||o.push(s),s++}),s=0)})),document.getElementById("cb_forpro").checked||(d3.selectAll(".node").filter(function(a){return"For-Profit"===a.type?this:void 0}).style("visibility","hidden"),O=0,p.forEach(function(a){"For-Profit"===a.type&&(t.forEach(function(b){a!==b.source&&a!==b.target||-1!==K.indexOf(O)||K.push(O),O++}),O=0)}),O=0,p.forEach(function(a){"For-Profit"===a.type&&(u.forEach(function(b){a!==b.source&&a!==b.target||-1!==L.indexOf(O)||L.push(O),O++}),O=0)}),O=0,p.forEach(function(a){"For-Profit"===a.type&&(q.forEach(function(b){a!==b.source&&a!==b.target||-1!==M.indexOf(O)||M.push(O),O++}),O=0)}),O=0,p.forEach(function(a){"For-Profit"===a.type&&(r.forEach(function(b){a!==b.source&&a!==b.target||-1!==N.indexOf(O)||N.push(O),O++}),O=0)})),document.getElementById("cb_gov").checked&&(d3.selectAll(".node").filter(function(a){return"Government"===a.type?this:void 0
}).style("visibility","visible"),z=0,p.forEach(function(a){"Government"===a.type&&(t.forEach(function(b){a!==b.source&&a!==b.target||-1!==v.indexOf(z)||v.push(z),z++}),z=0)}),z=0,p.forEach(function(a){"Government"===a.type&&(u.forEach(function(b){a!==b.source&&a!==b.target||-1!==w.indexOf(z)||w.push(z),z++}),z=0)}),z=0,p.forEach(function(a){"Government"===a.type&&(q.forEach(function(b){a!==b.source&&a!==b.target||-1!==x.indexOf(z)||x.push(z),z++}),z=0)}),z=0,p.forEach(function(a){"Government"===a.type&&(r.forEach(function(b){a!==b.source&&a!==b.target||-1!==y.indexOf(z)||y.push(z),z++}),z=0)})),document.getElementById("cb_gov").checked||(d3.selectAll(".node").filter(function(a){return"Government"===a.type?this:void 0}).style("visibility","hidden"),T=0,p.forEach(function(a){"Government"===a.type&&(t.forEach(function(b){a!==b.source&&a!==b.target||-1!==P.indexOf(T)||P.push(T),T++}),T=0)}),T=0,p.forEach(function(a){"Government"===a.type&&(u.forEach(function(b){a!==b.source&&a!==b.target||-1!==Q.indexOf(T)||Q.push(T),T++}),T=0)}),T=0,p.forEach(function(a){"Government"===a.type&&(q.forEach(function(b){a!==b.source&&a!==b.target||-1!==R.indexOf(T)||R.push(T),T++}),T=0)}),T=0,p.forEach(function(a){"Government"===a.type&&(r.forEach(function(b){a!==b.source&&a!==b.target||-1!==S.indexOf(T)||S.push(T),T++}),T=0)}));var U=[],V=[],W=[],X=[];0!==b.length&&(U=a(U,b)),0!==g.length&&(U=U=a(U,g)),0!==l.length&&(U=a(U,l)),0!==v.length&&(U=a(U,v)),0!==c.length&&(V=a(V,c)),0!==h.length&&(V=a(V,h)),0!==m.length&&(V=a(V,m)),0!==w.length&&(V=a(V,w)),0!==d.length&&(W=a(W,d)),0!==i.length&&(W=a(W,i)),0!==n.length&&(W=a(W,n)),0!==x.length&&(W=a(W,x)),0!==e.length&&(X=a(X,e)),0!==j.length&&(X=a(X,j)),0!==o.length&&(X=a(X,o)),0!==y.length&&(X=a(X,y));var Y=[],Z=[],$=[],_=[];0!==A.length&&(Y=a(Y,A)),0!==F.length&&(Y=a(Y,F)),0!==K.length&&(Y=a(Y,K)),0!==P.length&&(Y=a(Y,P)),0!==B.length&&(Z=a(Z,B)),0!==G.length&&(Z=a(Z,G)),0!==L.length&&(Z=a(Z,L)),0!==Q.length&&(Z=a(Z,Q)),0!==C.length&&($=a($,C)),0!==H.length&&($=a($,H)),0!==M.length&&($=a($,M)),0!==R.length&&($=a($,R)),0!==D.length&&(_=a(_,D)),0!==I.length&&(_=a(_,I)),0!==N.length&&(_=a(_,N)),0!==S.length&&(_=a(_,S));var ab=[],bb=[],cb=[],db=[];document.getElementById("cb_fund").checked||rb.filter(function(a,b){"hidden"===rb[0][b].style.visibility&&ab.push(b)}),document.getElementById("cb_invest").checked||sb.filter(function(a,b){"hidden"===sb[0][b].style.visibility&&bb.push(b)}),document.getElementById("cb_porucs").checked||tb.filter(function(a,b){"hidden"===tb[0][b].style.visibility&&cb.push(b)}),document.getElementById("cb_data").checked||ub.filter(function(a,b){"hidden"===ub[0][b].style.visibility&&db.push(b)}),d3.selectAll(".fund").style("visibility",function(a,b){return U.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".invest").style("visibility",function(a,b){return V.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".porucs").style("visibility",function(a,b){return W.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".data").style("visibility",function(a,b){return X.indexOf(b)>-1?"visible":"hidden"}),d3.selectAll(".fund").style("visibility",function(a,b){return Y.indexOf(b)>-1||ab.indexOf(b)>-1?"hidden":"visible"}),d3.selectAll(".invest").style("visibility",function(a,b){return Z.indexOf(b)>-1||bb.indexOf(b)>-1?"hidden":"visible"}),d3.selectAll(".porucs").style("visibility",function(a,b){return $.indexOf(b)>-1||cb.indexOf(b)>-1?"hidden":"visible"}),d3.selectAll(".data").style("visibility",function(a,b){return _.indexOf(b)>-1||db.indexOf(b)>-1?"hidden":"visible"});for(var eb=0,fb=0;fb<rb[0].length;fb++)"hidden"===rb[0][fb].style.visibility&&eb++;for(var gb=0,fb=0;fb<sb[0].length;fb++)"hidden"===sb[0][fb].style.visibility&&gb++;for(var hb=0,fb=0;fb<tb[0].length;fb++)"hidden"===tb[0][fb].style.visibility&&hb++;for(var ib=0,fb=0;fb<ub[0].length;fb++)"hidden"===ub[0][fb].style.visibility&&ib++;eb===rb[0].length&&document.getElementById("cb_fund").checked&&(document.getElementById("cb_fund").checked=!1),eb!==rb[0].length&&(document.getElementById("cb_fund").checked||(document.getElementById("cb_fund").checked=!0)),gb===sb[0].length&&document.getElementById("cb_invest").checked&&(document.getElementById("cb_invest").checked=!1),gb!==sb[0].length&&(document.getElementById("cb_invest").checked||(document.getElementById("cb_invest").checked=!0)),hb===tb[0].length&&document.getElementById("cb_porucs").checked&&(document.getElementById("cb_porucs").checked=!1),hb!==tb[0].length&&(document.getElementById("cb_porucs").checked||(document.getElementById("cb_porucs").checked=!0)),ib===ub[0].length&&document.getElementById("cb_data").checked&&(document.getElementById("cb_data").checked=!1),ib!==ub[0].length&&(document.getElementById("cb_data").checked||(document.getElementById("cb_data").checked=!0))}),d3.selectAll("#cb_emp, #cb_numtwit").on("click",function(){document.getElementById("cb_emp").checked&&(xb.transition().duration(350).delay(0).attr("r",function(a){return null!==a.employees?E(a.employees):"7"}),wb.attr("transform",function(a){return null!==a.employees?c(0,-E(a.employees)):c(0,-7)})),document.getElementById("cb_numtwit").checked&&(xb.transition().duration(350).delay(0).attr("r",function(a){return null!==a.followers?a.followers>1e6?"50":F(a.followers):"7"}),wb.attr("transform",function(a){return null!==a.followers?c(0,-F(a.followers)):c(0,-7)}))}),d3.select("svg").on("click",function(){d3.mouse(this);if(1===o){d3.event.preventDefault(),eb(),d3.selectAll("g").classed("fixed",function(a){a.fixed=!1}),d3.selectAll("g").call(gb),v=jQuery.extend(!0,{},{});{d3.layout.force().nodes(kb).size([i,j]).links(pb).linkStrength(0).charge(function(a){return null!==a.employees?-6*E(a.employees):-25}).linkDistance(50).on("tick",ib).start()}}o=1})})}();