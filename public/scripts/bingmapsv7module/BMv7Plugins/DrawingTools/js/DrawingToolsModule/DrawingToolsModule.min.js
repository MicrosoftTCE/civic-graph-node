var DrawingTools={DrawingMode:{pushpin:"pushpin",polyline:"polyline",polygon:"polygon",circle:"circle",rectangle:"rectangle",erase:"erase",edit:"edit"},StyleTools:{strokeColor:"strokeColor",fillColor:"fillColor",strokeThickness:"strokeThickness",strokeDashArray:"strokeDashArray"},DistanceUnit:{meters:"meters",km:"km",miles:"miles",feet:"feett",yards:"yards"},DrawingManager:function(G,e){var E=new Microsoft.Maps.EntityCollection(),v=new Microsoft.Maps.EntityCollection(),C,r,p,I=false,b=null,q=this,h=[],u=[],o,k=G.getRootElement(),c=36,w=false,t=new RegExp("^[0-9]+$"),H=new RegExp("^#?[A-Fa-f0-9]{6}$");var s={toolbarContainer:null,toolbarOptions:{drawingModes:["pushpin","polyline","polygon","circle","rectangle","erase","edit"],styleTools:["strokeColor","fillColor","strokeThickness","strokeDashArray"],dashedArray:[null,"5,5","5,10","10,5","10,10","20,10,5,5,5,10","15,10,5,10,15"],openFlyoutAbove:false},pushpinOptions:{},shapeOptions:{strokeThickness:3,strokeColor:new Microsoft.Maps.Color(150,0,255,0),fillColor:new Microsoft.Maps.Color(150,0,0,255)},primaryDragHandleOptions:{typeName:"drawingToolsPrimaryDragHandle",htmlContent:"<div></div>",draggable:true,anchor:new Microsoft.Maps.Point(0,0),width:14,height:14},secondaryDragHandleOptions:{typeName:"drawingToolsSecondaryDragHandle",htmlContent:"<div></div>",draggable:true,anchor:new Microsoft.Maps.Point(0,0),width:14,height:14},events:{created:null,changed:null,changing:null,erased:null,drawingModeChanged:null}};var a={pushpin:"Add a pushpin",polyline:"Draw a line or path on the map",polygon:"Draw an area on the map",circle:"Draw a circle on the map",rectangle:"Draw a rectangle on the map",erase:"Erase shapes",edit:"Select shapes for to edit",strokeThickness:"Change the thickness of lines",strokeColor:"Change the stroke color of shapes",fillColor:"Change the fill color of shapes",strokeDashArray:"Change the dash style of lines"};function z(){G.entities.push(E);G.entities.push(v);B(e);if(!o){d()}}this.addCircle=function(K,J,L){var M=DrawingTools.MapMath.generateRegularPolygon(K,J,DrawingTools.DistanceUnit.km,c,0);var N=new Microsoft.Maps.Polygon(M,L||s.shapeOptions);N.ShapeInfo={type:"circle",radius:J,center:K};E.push(N)};this.addRectangle=function(M,L,J){var K=new Microsoft.Maps.Polygon([M,new Microsoft.Maps.Location(M.latitude,L.longitude),L,Microsoft.Maps.Location(L.latitude,M.longitude),M],J||s.shapeOptions);K.ShapeInfo={type:"rectangle"};E.push(K)};this.clear=function(){v.clear();E.clear()};this.calculateVisualMidpoint=function(M,L){var N=G.tryLocationToPixel([M,L]);var J=(N[0].x+N[1].x)/2;var K=(N[0].y+N[1].y)/2;return G.tryPixelToLocation(new Microsoft.Maps.Point(J,K))};this.getOptions=function(){return s};this.getShapeLayer=function(){return E};this.getDrawingMode=function(){return b};this.setOptions=function(J){B(J)};this.setDrawingMode=function(L){if(b!=L&&s.events.drawingModeChanged){s.events.drawingModeChanged(L)}f();b=L;g();if(b){if(b=="erase"){for(var J=0;J<E.getLength();J++){var K=E.get(J);h.push(Microsoft.Maps.Events.addHandler(K,"click",D));h.push(Microsoft.Maps.Events.addHandler(K,"mouseover",function(M){k.style.cursor="default"}));h.push(Microsoft.Maps.Events.addHandler(K,"mouseout",function(M){k.style.cursor="pointer"}))}}else{if(b=="edit"){for(var J=0;J<E.getLength();J++){var K=E.get(J);if(K.getIcon){K.setOptions({draggable:true});h.push(Microsoft.Maps.Events.addHandler(K,"drag",function(M){if(s.events&&s.events.changing){s.events.changing(M.entity)}}));h.push(Microsoft.Maps.Events.addHandler(K,"dragend",function(M){if(s.events&&s.events.changed){s.events.changed(M.entity)}}));h.push(Microsoft.Maps.Events.addHandler(K,"mouseover",function(M){k.style.cursor="move"}))}else{h.push(Microsoft.Maps.Events.addHandler(K,"click",function(M){if(M.target){C=M.target;n()}}));h.push(Microsoft.Maps.Events.addHandler(K,"mouseover",function(M){k.style.cursor="default"}))}h.push(Microsoft.Maps.Events.addHandler(K,"mouseout",function(M){k.style.cursor="pointer"}))}}else{h.push(Microsoft.Maps.Events.addHandler(G,"mouseup",y));h.push(Microsoft.Maps.Events.addHandler(G,"mousemove",l));G.setOptions({disablePanning:true,disableZooming:true});k.style.cursor="default"}}h.push(Microsoft.Maps.Events.addHandler(G,"keyup",function(M){if(M.keyCode=="27"){q.setDrawingMode(null)}}))}};function B(J){s=x(s,J);for(attrname in J){switch(attrname){case"showToolbar":if(o){o.style.display=(s.showToolbar)?"":"none"}break;case"toolbarOptions":d();break;case"shapeOptions":if(C&&!C.getIcon){C.setOptions(s.shapeOptions)}break}}}function f(){for(var J=0;J<h.length;J++){Microsoft.Maps.Events.removeHandler(h[J])}h=[];for(var J=0;J<u.length;J++){Microsoft.Maps.Events.removeHandler(u[J])}u=[];v.clear();if(C&&(b=="polygon"||b=="rectangle"||b=="circle"||b=="polyline")){var L=C.getLocations();while(L.length>p){L.pop()}switch(b){case"polygon":case"rectangle":case"circle":L.push(L[0]);break}C.setLocations(L);if(s.events&&s.events.created&&(b=="polygon"||b=="polyline")){s.events.created(C)}}if(b=="edit"){for(var J=0;J<E.getLength();J++){var K=E.get(J);if(K.getIcon){K.setOptions({draggable:false})}}}G.setOptions({disablePanning:false,disableZooming:false});C=null;b=null;I=false;g();k.style.cursor="hand"}function y(M){if(w){w=false;return}var J=new Microsoft.Maps.Point(M.getX(),M.getY());r=G.tryPixelToLocation(J);if(!I){switch(b){case"pushpin":I=true;break;case"polyline":C=new Microsoft.Maps.Polyline([r,r],s.shapeOptions);C.ShapeInfo={type:"polyline"};p=0;break;case"polygon":C=new Microsoft.Maps.Polygon([r,r,r],s.shapeOptions);C.ShapeInfo={type:"polygon"};p=0;break;case"rectangle":C=new Microsoft.Maps.Polygon([r,r,r,r],s.shapeOptions);C.ShapeInfo={type:"rectangle"};p=4;break;case"circle":var L=DrawingTools.MapMath.generateRegularPolygon(r,0,DrawingTools.DistanceUnit.km,c,0);C=new Microsoft.Maps.Polygon(L,s.shapeOptions);C.ShapeInfo={type:"circle",radius:0,center:r};p=c;break;default:break}if(C!=null){E.push(C);I=true}}else{if(I&&(b=="rectangle"||b=="circle")){I=false;if(s.events&&s.events.created){s.events.created(C)}}}switch(b){case"pushpin":var K=new Microsoft.Maps.Pushpin(r,s.pushpinOptions);K.ShapeInfo={type:"pushpin"};E.push(K);if(s.events&&s.events.created){s.events.created(K)}break;case"polyline":case"polygon":var L=C.getLocations();if(p<L.length){L[p]=r}else{L.push(r)}C.setLocations(L);p++;i();break;default:break}}function l(N){if(I){var J=new Microsoft.Maps.Point(N.getX(),N.getY());var K=G.tryPixelToLocation(J);switch(b){case"polyline":case"polygon":var L=C.getLocations();L[p]=K;C.setLocations(L);if(s.events&&s.events.changing){s.events.changing(C)}break;case"rectangle":var L=C.getLocations();if(L.length>=4){var M=L[0];L=[M];L.push(new Microsoft.Maps.Location(M.latitude,K.longitude));L.push(K);L.push(new Microsoft.Maps.Location(K.latitude,M.longitude));L.push(M)}C.setLocations(L);if(s.events&&s.events.changing){s.events.changing(C)}break;case"circle":C.ShapeInfo.center=r;C.ShapeInfo.radius=DrawingTools.MapMath.haversineDistance(r,K,DrawingTools.DistanceUnit.km);var L=DrawingTools.MapMath.generateRegularPolygon(r,C.ShapeInfo.radius,DrawingTools.DistanceUnit.km,c,0);C.setLocations(L);if(s.events&&s.events.changing){s.events.changing(C)}break;default:break}}}function D(J){if(J.target){E.remove(J.target);if(s.events.erased){s.events.erased(J.target)}}}function n(){var J;if(C.ShapeInfo&&C.ShapeInfo.type){J=C.ShapeInfo.type}else{if(C.getFillColor){J="polygon"}else{if(C.getStroke){J="polyline"}}}if(!C.ShapeInfo){C.ShapeInfo={}}if(!C.ShapeInfo.type){C.ShapeInfo.type=J}switch(J){case"polyline":case"polygon":i();break;case"rectangle":j();break;case"circle":A();break;default:q.setDrawingMode(null);break}}function i(){v.clear();var N=C.getLocations();var J=N.length;var L=J;if(C.ShapeInfo.type=="polygon"){J--}else{L--}for(var M=0;M<J;M++){if(b=="edit"&&M<L){var P=q.calculateVisualMidpoint(N[M],N[M+1]);var O=new Microsoft.Maps.Pushpin(P,s.secondaryDragHandleOptions);O.EditInfo={locIdx:M,dragPinType:"secondary"};v.push(O);u.push(Microsoft.Maps.Events.addHandler(O,"drag",function(R){if(R.entity.EditInfo){var Q=C.getLocations();if(R.entity.EditInfo.locIdx<Q.length&&R.entity.EditInfo.locIdx>=0){if(!R.entity.EditInfo.isAdded){Q.splice(R.entity.EditInfo.locIdx+1,0,R.entity.getLocation());R.entity.EditInfo.isAdded=true}else{if(R.entity.EditInfo.locIdx<Q.length-1){Q[R.entity.EditInfo.locIdx+1]=R.entity.getLocation()}}C.setLocations(Q);if(s.events&&s.events.changing){s.events.changing(C)}}}}));u.push(Microsoft.Maps.Events.addHandler(O,"dragend",function(Q){n();if(s.events&&s.events.changed){s.events.changed(C)}}))}var K=new Microsoft.Maps.Pushpin(N[M],s.primaryDragHandleOptions);K.EditInfo={locIdx:M,dragPinType:"primary"};v.push(K);u.push(Microsoft.Maps.Events.addHandler(K,"drag",function(R){if(R.entity.EditInfo&&C.ShapeInfo){var Q=C.getLocations();if(R.entity.EditInfo.locIdx<Q.length&&R.entity.EditInfo.locIdx>=0){if(R.entity.EditInfo.locIdx==0||R.entity.EditInfo.locIdx==Q.length-1){Q[0]=R.entity.getLocation();Q[Q.length-1]=R.entity.getLocation()}else{Q[R.entity.EditInfo.locIdx]=R.entity.getLocation()}C.setLocations(Q);if(s.events&&s.events.changing){s.events.changing(C)}w=true}}}));u.push(Microsoft.Maps.Events.addHandler(K,"dragend",function(Q){n();if(s.events&&s.events.changed){s.events.changed(C)}}));u.push(Microsoft.Maps.Events.addHandler(K,"dragstart",function(S){for(var Q=0;Q<v.getLength();Q++){var R=v.get(Q);if(R.EditInfo.dragPinType=="secondary"){v.remove(R)}}}))}}function j(){v.clear();var L=C.getLocations();var K=new Microsoft.Maps.Pushpin(L[0],s.primaryDragHandleOptions);v.push(K);u.push(Microsoft.Maps.Events.addHandler(K,"drag",function(N){var M=C.getLocations();M[0]=N.entity.getLocation();if(M.length==5){M[4]=M[0]}M[1]=new Microsoft.Maps.Location(M[0].latitude,M[2].longitude);M[3]=new Microsoft.Maps.Location(M[2].latitude,M[0].longitude);C.setLocations(M);if(s.events&&s.events.changing){s.events.changing(C)}}));u.push(Microsoft.Maps.Events.addHandler(K,"dragend",function(M){if(s.events&&s.events.changed){s.events.changed(C)}}));var J=new Microsoft.Maps.Pushpin(L[2],s.primaryDragHandleOptions);v.push(J);u.push(Microsoft.Maps.Events.addHandler(J,"drag",function(N){var M=C.getLocations();M[2]=N.entity.getLocation();M[1]=new Microsoft.Maps.Location(M[0].latitude,M[2].longitude);M[3]=new Microsoft.Maps.Location(M[2].latitude,M[0].longitude);C.setLocations(M);if(s.events&&s.events.changing){s.events.changing(C)}}));u.push(Microsoft.Maps.Events.addHandler(J,"dragend",function(M){if(s.events&&s.events.changed){s.events.changed(C)}}))}function A(){v.clear();if(C.ShapeInfo.center&&C.ShapeInfo.radius!=null){var L=DrawingTools.MapMath.calculateCoord(C.ShapeInfo.center,90,C.ShapeInfo.radius,DrawingTools.DistanceUnit.km);var K=new Microsoft.Maps.Pushpin(L,s.primaryDragHandleOptions);v.push(K);u.push(Microsoft.Maps.Events.addHandler(K,"drag",function(N){C.ShapeInfo.radius=DrawingTools.MapMath.haversineDistance(C.ShapeInfo.center,N.entity.getLocation(),DrawingTools.DistanceUnit.km);var M=DrawingTools.MapMath.generateRegularPolygon(C.ShapeInfo.center,C.ShapeInfo.radius,DrawingTools.DistanceUnit.km,c,0);C.setLocations(M);if(s.events&&s.events.changing){s.events.changing(C)}}));u.push(Microsoft.Maps.Events.addHandler(K,"dragend",function(M){if(s.events&&s.events.changed){s.events.changed(C)}}));var J=new Microsoft.Maps.Pushpin(C.ShapeInfo.center,s.primaryDragHandleOptions);J.EditInfo={radiusHandle:K};v.push(J);u.push(Microsoft.Maps.Events.addHandler(J,"drag",function(O){var P=O.entity.getLocation();C.ShapeInfo.center=P;var N=DrawingTools.MapMath.generateRegularPolygon(P,C.ShapeInfo.radius,DrawingTools.DistanceUnit.km,c,0);C.setLocations(N);if(s.events&&s.events.changing){s.events.changing(C)}if(J.EditInfo&&J.EditInfo.radiusHandle){var M=DrawingTools.MapMath.calculateCoord(C.ShapeInfo.center,90,C.ShapeInfo.radius,DrawingTools.DistanceUnit.km);J.EditInfo.radiusHandle.setLocation(M)}}));u.push(Microsoft.Maps.Events.addHandler(J,"dragend",function(M){if(s.events&&s.events.changed){s.events.changed(C)}}))}}function x(M,L){for(var K in L){try{if(L[K].constructor==Object&&"undefined"!=typeof(M[K])){M[K]=L[K]}else{M[K]=x(M[K],L[K])}}catch(J){M[K]=L[K]}}return M}function d(){if(o){o.parentNode.removeChild(o);o=null}if(s.toolbarContainer){o=document.createElement("div");o.className="drawingToolsToolbar";if(s.toolbarOptions&&s.toolbarOptions.drawingModes&&s.toolbarOptions.drawingModes.length>0){var Q=s.toolbarOptions.drawingModes;for(var P=0;P<Q.length;P++){var O=document.createElement("a");O.href="javascript:void(0);";O.className="drawingToolsIcon drawingToolsIcon_"+Q[P];var J=document.createAttribute("rel");J.nodeValue=Q[P];O.attributes.setNamedItem(J);O.title=a[Q[P]];O.addEventListener("click",function(S){J=this.attributes.getNamedItem("rel").value;var R=b;f();if(R!=J){q.setDrawingMode(J)}});o.appendChild(O)}var N=[];if(s.toolbarOptions.styleTools&&s.toolbarOptions.styleTools.length>0){N=s.toolbarOptions.styleTools;for(var P=0;P<N.length;P++){var O=document.createElement("a");O.href="javascript:void(0);";O.className="drawingToolsIcon drawingToolsIcon_"+N[P];O.title=a[N[P]];var K=document.createElement("div");K.className="drawingToolsFlyout";K.style.display="none";switch(N[P]){case"strokeThickness":if(s.shapeOptions&&s.shapeOptions.strokeThickness){for(var M=1;M<8;M++){var L=F(M,null,function(R){s.shapeOptions.strokeThickness=parseInt(R.style.strokeWidth);if(C&&C.getStrokeThickness){C.setOptions({strokeThickness:parseInt(R.style.strokeWidth)})}});if(s.shapeOptions.strokeThickness==M){L.style.backgroundColor="#26a0da"}K.appendChild(L)}}break;case"fillColor":if(s.shapeOptions&&s.shapeOptions.fillColor){m(K,s.shapeOptions.fillColor,function(R){s.shapeOptions.fillColor=R;if(C&&C.getFillColor){C.setOptions({fillColor:R})}})}break;case"strokeColor":if(s.shapeOptions&&s.shapeOptions.strokeColor){m(K,s.shapeOptions.strokeColor,function(R){s.shapeOptions.strokeColor=R;if(C&&C.getStrokeColor){C.setOptions({strokeColor:R})}})}break;case"strokeDashArray":if(s.toolbarOptions&&s.toolbarOptions.dashedArray){for(var M=0;M<s.toolbarOptions.dashedArray.length;M++){var L=F(4,s.toolbarOptions.dashedArray[M],function(R){s.shapeOptions.strokeDashArray=R.style.strokeDasharray;if(C&&C.getStrokeDashArray){C.setOptions({strokeDashArray:R.style.strokeDasharray})}});if(s.shapeOptions.strokeDashArray==s.toolbarOptions.dashedArray[M]){L.style.backgroundColor="#26a0da"}K.appendChild(L)}}break}O.flyout=K;o.appendChild(K);O.addEventListener("click",function(R){if(this.flyout.style.display==""){this.flyout.style.display="none"}else{g();if(s.toolbarOptions.openFlyoutAbove){this.flyout.style.top=this.offsetTop-140+"px"}else{this.flyout.style.top=this.offsetTop+30+"px"}this.flyout.style.left=this.offsetLeft+"px";this.flyout.style.display=""}});o.appendChild(O)}}}toolbarContainer.appendChild(o)}}function g(){if(o&&o.childNodes){for(var K=0;K<o.childNodes.length;K++){var L=o.childNodes[K];var J=L.attributes.getNamedItem("rel");if(J&&J.value){if(J.value==b){o.childNodes[K].classList.add("drawingToolsIcon_"+J.value+"_active")}else{o.childNodes[K].classList.remove("drawingToolsIcon_"+J.value+"_active")}}else{if(L.className=="drawingToolsFlyout"){L.style.display="none"}}}}}function F(Q,N,P){var M=document.createElementNS("http://www.w3.org/2000/svg","svg");var L=document.createAttribute("width");L.nodeValue=150;M.attributes.setNamedItem(L);var O=document.createAttribute("height");O.nodeValue=14;M.attributes.setNamedItem(O);var K=document.createAttribute("class");K.nodeValue="drawingToolsFlyout_line";M.attributes.setNamedItem(K);var J=document.createElementNS("http://www.w3.org/2000/svg","line");J.style.stroke="#000";J.style.strokeWidth=Q;J.style.strokeDasharray=N;J.setAttribute("x1",10);J.setAttribute("y1",7);J.setAttribute("x2",140);J.setAttribute("y2",7);M.addEventListener("click",function(T){var S=this.parentNode;for(var R=0;R<S.childNodes.length;R++){S.childNodes[R].style.backgroundColor=""}this.style.backgroundColor="#26a0da";S.style.display="none";P(this.firstChild)});M.appendChild(J);return M}function m(Q,N,S){var K=["#fefe33","#fb9902","#ff0000","#ff0066","#8601af","#000066","#0000ff","#0392ce","#00ff00","#006600","#000000","#ffffff"];var R=document.createElement("input");R.type="text";R.value=N.toHex();R.style.width="60px";var J=document.createElement("input");J.type="text";J.value=N.a;J.style.width="60px";for(var P=0;P<K.length;P++){var L=document.createElement("a");L.className="drawingToolsColor";L.style.backgroundColor=K[P];L.rel=K[P];L.addEventListener("click",function(T){R.value=this.rel});Q.appendChild(L)}var O=document.createElement("span");O.innerText="Color:";Q.appendChild(O);Q.appendChild(R);var M=document.createElement("span");M.innerText="Alpha:";Q.appendChild(M);Q.appendChild(J);var L=document.createElement("input");L.type="button";L.value="Select";L.style.margin="5px 0px 0px 23px";L.style.width="100px";L.addEventListener("click",function(U){if(!J.value||J.value==""||!J.value.match(t)){J.value=150}if(!R.value.match(H)){R.value=N.toHex()}if(S){var V=Microsoft.Maps.Color.fromHex(R.value);var T=parseInt(J.value);if(T>255){T=255;J.value=255}V.a=T;S(V)}Q.style.display="none"});Q.appendChild(L)}z()},MapMath:{areLocationsEqual:function(b,a){return Math.round(b.latitude*10000)==Math.round(a.latitude*10000)&&Math.round(b.longitude*10000)==Math.round(a.longitude*10000)},degToRad:function(a){return a*Math.PI/180},radToDeg:function(a){return a*180/Math.PI},constants:{EARTH_RADIUS_METERS:6378100,EARTH_RADIUS_KM:6378.1,EARTH_RADIUS_MILES:3963.1676,EARTH_RADIUS_FEET:20925524.9},convertDistance:function(c,b,a){switch(b){case DrawingTools.DistanceUnit.meters:c/=1000;break;case DrawingTools.DistanceUnit.feet:c/=3288.839895;break;case DrawingTools.DistanceUnit.miles:c*=1.609344;break;case DrawingTools.DistanceUnit.yards:c*=0.0009144;break;case DrawingTools.DistanceUnit.km:break}switch(a){case DrawingTools.DistanceUnit.meters:c*=1000;break;case DrawingTools.DistanceUnit.feet:c*=5280;break;case DrawingTools.DistanceUnit.miles:c/=1.609344;break;case DrawingTools.DistanceUnit.yards:c*=1093.6133;break;case DrawingTools.DistanceUnit.km:break}return c},getEarthRadius:function(a){switch(a){case DrawingTools.DistanceUnit.km:return DrawingTools.MapMath.constants.EARTH_RADIUS_KM;case DrawingTools.DistanceUnit.meters:return DrawingTools.MapMath.constants.EARTH_RADIUS_METERS;case DrawingTools.DistanceUnit.feet:return DrawingTools.MapMath.constants.EARTH_RADIUS_FEET;case DrawingTools.DistanceUnit.miles:return DrawingTools.MapMath.constants.EARTH_RADIUS_MILES;case DrawingTools.DistanceUnit.yards:return DrawingTools.MapMath.constants.EARTH_RADIUS_KM*1093.6133;break}},calculateCoord:function(g,d,b,j){var i=DrawingTools.MapMath.getEarthRadius(j);var c=DrawingTools.MapMath.degToRad(g.latitude),f=DrawingTools.MapMath.degToRad(g.longitude),h=b/i;var a=Math.asin(Math.sin(c)*Math.cos(h)+Math.cos(c)*Math.sin(h)*Math.cos(DrawingTools.MapMath.degToRad(d)));var e=f+Math.atan2(Math.sin(DrawingTools.MapMath.degToRad(d))*Math.sin(h)*Math.cos(c),Math.cos(h)-Math.sin(c)*Math.sin(a));return new Microsoft.Maps.Location(DrawingTools.MapMath.radToDeg(a),DrawingTools.MapMath.radToDeg(e))},generateRegularPolygon:function(h,a,b,f,g){var e=[],c=360/f;for(var d=0;d<=f;d++){e.push(DrawingTools.MapMath.calculateCoord(h,(d*c+g)%360,a,b))}return e},haversineDistance:function(d,b,l){if(d&&b){var e=DrawingTools.MapMath.degToRad(d.latitude),g=DrawingTools.MapMath.degToRad(d.longitude),c=DrawingTools.MapMath.degToRad(b.latitude),f=DrawingTools.MapMath.degToRad(b.longitude);var h=c-e,a=f-g,i=Math.pow(Math.sin(h/2),2)+Math.cos(e)*Math.cos(c)*Math.pow(Math.sin(a/2),2),j=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));var k=DrawingTools.MapMath.getEarthRadius(l);return k*j}return 0}}};Microsoft.Maps.moduleLoaded("DrawingToolsModule");