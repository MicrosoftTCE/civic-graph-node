var ImageOverlay;(function(){var b=0;function a(){var c="strechedImg"+b;b++;if(window[c]){return a()}return c}ImageOverlay=function(j,f,d){var h=new Microsoft.Maps.Pushpin(d.center);var c=1;var e=a();function g(){var l=i();var k={width:null,height:null,anchor:new Microsoft.Maps.Point(l.anchorPointX,l.anchorPointY),htmlContent:"<img id='"+e+"' style='width:"+l.width+"px;height:"+l.height+"px;opacity:"+c+";filter:alpha(opacity="+(c*100)+");' src='"+f+"'/>"};h.setOptions(k);h.setLocation(l.pushpinLocation)}function i(){var m=j.tryLocationToPixel(d.getNorthwest());var s=j.tryLocationToPixel(d.getSoutheast());var k=Math.abs(s.x-m.x);var v=Math.abs(m.y-s.y);var u=k/2;var t=v/2;var p=d.center;var o=j.getBounds();if(o.intersects(d)&&(!o.contains(d.getNorthwest())||!o.contains(d.getSoutheast()))){var r=j.tryLocationToPixel(o.center);var n=j.tryLocationToPixel(d.center);var q=r.x-n.x;var l=r.x-n.y;p=o.center;u=k/2+q;t=v/2+l}return{width:k,height:v,anchorPointX:u,anchorPointY:t,pushpinLocation:p}}h.Refresh=function(){var k=i();h.setOptions({anchor:new Microsoft.Maps.Point(k.anchorPointX,k.anchorPointY)});h.setLocation(k.pushpinLocation);var l=document.getElementById(e);if(l){l.style.width=k.width+"px";l.style.height=k.height+"px"}};h.SetOpacity=function(k){if(k>=0||opctity<=1){c=k;g()}};Microsoft.Maps.Events.addHandler(j,"viewchange",function(k){if(!k.linear){h.Refresh()}});g();return h}})();Microsoft.Maps.moduleLoaded("ImageOverlayModule");