function transform(e){return"translate("+e.x+","+e.y+")"}function translateSVG(e,t){return"translate("+e+","+t+")"}function numCommas(e){e+="";x=e.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var t=/(\d+)(\d{3})/;while(t.test(x1)){x1=x1.replace(t,"$1"+","+"$2")}return x1+x2}function getSVG(e){return e}var dblclickobject;var centerNodeFundLink=[];var centerNodeInvestLink=[];var centerNodePorucsLink=[];var centerNodeDataLink=[];var color=d3.scale.category20();var width=960;var height=960;var organizations={};var filteredNodes={};var porucsCon={};var dataCon={};var fundingCon={};var investingCon={};var fundLink={};var investLink={};var porucsLink={};var dataLink={};var newCenterFundLink=[];var newCenterPorucsLink=[];var newCenterInvestLink=[];var newCenterDataLink=[];var nodeInit;var controlForce={init:true,dblclick:false};var centeredNode={};var fundLinkX1=[];var fundLinkX2=[];var investLinkX1=[];var investLinkX2=[];var porucsLinkX1=[];var porucsLinkX2=[];var dataLinkX1=[];var dataLinkX2=[];var fundLinkY1=[];var fundLinkY2=[];var investLinkY1=[];var investLinkY2=[];var porucsLinkY1=[];var porucsLinkY2=[];var dataLinkY1=[];var dataLinkY2=[];var nodeX=[];var nodeY=[];var node;var flag=1;var didDBLClick=0;var svg=d3.select(".content").append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("id","network").attr("height",height).attr("width",width);var aspect=width/height,network=$("#network"),container=network.parent();$(window).on("resize",function(){var e=container.width();network.attr("width",e);network.attr("height",Math.round(e/aspect))}).trigger("resize");var viewBoxParameters="0 0 "+width+" "+height;svg.attr("viewBox",viewBoxParameters).attr("preserveAspectRatio","xMidYMid");var empScale=d3.scale.sqrt().domain([10,13e4]).range([10,50]);var twitScale=d3.scale.sqrt().domain([10,1e6]).range([10,50]);d3.json("data/final_data.json",function(e,t){function o(e){d3.select(this).classed("fixed",function(e){e.fixed=false});d3.select(this).on("mousedown.drag",null);dblclickobject=d3.select(this).data()[0];var t=parseInt(svg.style("width").substring(0,(svg.style("width").length+1)/2));var n=parseInt(svg.style("height").substring(0,(svg.style("height").length+1)/2));var r=parseInt(t/2);var i=parseInt(n/2);console.log("Half Width: "+r);console.log("Half Height"+i);multiplierX=t/width;multiplierY=n/height;scaledDX=multiplierX*e.x;scaledDY=multiplierY*e.y;console.log("Before X: "+e.x);console.log("Before Y: "+e.y);centeredNode=jQuery.extend(true,{},e);centeredNode.x=width/2-10;centeredNode.y=height/2-60;console.log("After X: "+centeredNode.x);console.log("After Y: "+centeredNode.y);console.log(centeredNode);var s=d3.layout.force().nodes(filteredNodes).size([width,height]).links(fundingCon.concat(investingCon).concat(porucsCon).concat(dataCon)).linkStrength(0).charge(function(e){if(e.numemp!==null)return-5*empScale(parseInt(e.numemp));else return-50}).on("tick",M).start()}function u(e){s=f(e);webform=a(e);d3.select("#edit").html(webform);d3.select("#info").html(s).style("list-style","square")}function a(e){var t="";t+="<h1>"+'<i class="icon-pencil on-left"></i>'+"Edit or Add Information"+"</h1>";return t}function f(e){var t="";t+="<h1>"+"<a href="+'"'+e.weblink+'" target="_blank">'+e.name+"</a></h1>";t+="<h6>"+"Type of Entity: "+"</h6>"+" <h5>"+e.type+"</h5>";if(e.location!==null){t+="<br/>"+"<h6> "+"Location:  "+"</h6>";var n=[];var r=[];if(e.location.indexOf("; ")!==-1){t+="<br/> <h5><ul>";n=e.location.split("; ");for(var i=0;i<n.length;i++){t+='<li style="display:block;">'+'<h5><a class="click-location" style="cursor:pointer;">'+n[i]+"</h5></a>"+"</li>"}}else{t+="<h5><ul>";t+='<li style="display:inline-block;">'+'<h5><a class="click-location" style="cursor:pointer;">'+e.location+"</h5></a>"+"</li>"}t+="</h5></ul><br/>"}else{t+="<br/>"+"<h6> "+"Location:  "+"</h6>"+" <h5>"+"N/A"+"</h5>"+"<br/>"}if(e.type!=="Individual"){if(e.numemp!==null){t+="<h6>"+"Employees: "+"</h6> <h5>"+numCommas(e.numemp)+"</h5><br/>"}else{t+="<h6>"+"Employees: "+"</h6> <h5>"+"N/A"+"</h5><br/>"}}if(e.twitterH===null){t+="<h6>"+"Twitter:  "+"</h6> <h5>"+"N/A"+"</h5><br/>";t+="<h6>"+"Twitter Followers: "+"</h6> <h5>"+"N/A"+"</h5><br/>"}else{var s=e.twitterH.replace("@","");s="https://twitter.com/"+s;t+="<h6>"+"Twitter:  "+"</h6> <h5>"+"<a href="+'"'+s+'">'+e.twitterH+"</h5></a><br/>";t+="<h6>"+"Twitter Followers:  "+"</h6> <h5>"+numCommas(e.followers)+"</h5><br/>"}var o=[];if(e.people!==null){t+="<br/><h6>"+"Key People:"+"</h6>"+"<ul><h5>";o=e.people.split(", ");for(var i=0;i<o.length;i++){t+="<li>"+'<a href="http://www.bing.com/search?q='+o[i].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+o[i]+"</a>"+"</li>"}t+="</h5></ul>"}var u=[];var a=[];if(e.fundingR===null){t+="<br/> <h6>"+"No known funding."+"</h6><br/>"}else{var f=0;var c=[];var h=[];var p;var d;if(e.fundingR.indexOf("; ")!==-1){c=e.fundingR.split("; ");for(var i=0;i<c.length;i++){h=c[i].split(":");u.push(h[0]);a.push(h[1]);if(u[i]==="Total"){p=a[i];continue}if(u[i]==="Individuals"){d=a[i];continue}if(a[i]==="null"){if(f===0){t+="<br/>"+"<h6>"+" Received funding from:"+"</h6><ul>";f++}t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+u[i].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+u[i]+"</a></h5>"+': <strong style="color:rgb(255,185,0);">unknown</strong>'+"</li>"}else{if(f===0){t+="<br/>"+"<h6>"+" Received funding from:"+"</h6><ul>";f++}t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+u[i].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+u[i]+"</a></h5>"+": $"+'<strong style="color:rgb(127,186,0);">'+numCommas(a[i])+"</strong>"+"</li>"}}}else{c=e.fundingR.split(":");if(c[0]==="Total"){t+="<br/>";p=c[1]}else if(c[0]==="Individuals"){t+="<br/>";d=c[1]}else{t+="<br/>"+"<h6>"+" Received funding from:"+"</h6><ul>";t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+c[0].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+c[0]+"</a></h5>";if(c[1]==="null"){t+=': <strong style="color:rgb(255,185,0);">unknown</strong>'+"</li>"}else{t+=": $"+'<strong style="color:rgb(127,186,0);">'+numCommas(c[1])+"</strong>"+"</li>"}}}t+="</ul>";if(!isNaN(d)){t+="<h6>"+"Individuals provided "+"</h6>"+" $"+'<strong style="color:rgb(127,186,0);">'+numCommas(d)+"</strong></h5><h6> in fundings.</h6><br/>"}if(!isNaN(p)){t+="<h6>"+"Total funding received: "+"</h6>"+" $"+'<strong style="color:rgb(127,186,0);">'+numCommas(p)+"</strong></h5><br/>"}}var v=[];var m=[];var g;var y;if(e.investmentR===null){t+="<br/> <h6>"+"No known investments."+"</h6> <br/>"}else{var f=0;var b=[];var w=[];if(e.investmentR.indexOf("; ")!==-1){b=e.investmentR.split("; ");for(var i=0;i<b.length;i++){w=b[i].split(":");v.push(w[0]);m.push(w[1]);if(v[i]==="Total"){g=m[i];continue}if(v[i]==="Individuals"){y=m[i];continue}if(m[i]==="null"){if(f===0){t+="<br/>"+"<h6>"+" Received investments from:"+"</h6>"+"<ul>";f++}t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+v[i].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+v[i]+"</a></h5>"+': <strong style="color:rgb(255,185,0);">unknown</strong>'+"</li>"}else{if(f===0){t+="<br/>"+"<h6>"+" Received investments from:"+"</h6>"+"<ul>";f++}t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+v[i].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+v[i]+"</a></h5>"+": $"+'<strong style="color:rgb(127,186,0);">'+numCommas(m[i])+"</strong>"+"</li>"}}}else{b=e.investmentR.split(":");if(b[0]==="Total"){t+="<br/>";g=m[1]}else if(b[0]==="Individuals"){t+="<br/>";y=m[1]}else{t+="<br/>"+"<h6>"+" Received investments from:"+"</h6><ul>";t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+b[0].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+b[0]+"</a></h5>";if(b[1]==="null"){t+=': <strong style="color:rgb(255,185,0);">unknown</strong>'+"</li>"}else{t+=": $"+'<strong style="color:rgb(127,186,0);">'+numCommas(b[1])+"</strong>"+"</li>"}}}t+="</ul>";if(!isNaN(y)){t+="<h6>"+"Individuals provided "+"</h6>"+" $"+'<strong style="color:rgb(127,186,0);">'+numCommas(y)+"</strong> in investments.<br/>"}if(!isNaN(g)){t+="<h6>"+"Total investments received: "+"</h6>"+" $"+'<strong style="color:rgb(127,186,0);">'+numCommas(g)+"</strong>.<br/>"}}if(e.relatedto===null){t+="<br/><h6>"+"No known relations."+"</h6><br/>"}else{t+="<br/>"+"<h6>"+"Related To:  "+"</h6> <ul>";var E=[];var S=[];if(e.relatedto.indexOf(", ")!==-1){E=e.relatedto.split(", ");for(var i=0;i<E.length;i++){t+="<li><h5>"+'<a href="http://www.bing.com/search?q='+E[i].replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+E[i]+"</a>"+"</h5></li>"}}else{t+="<li><h5> "+'<a href="http://www.bing.com/search?q='+e.relatedto.replace(" ","%20")+'&go=Submit&qs=bs&form=QBRE" target="_blank">'+e.relatedto+"</a>"+"</h5></li>"}t+="</ul>"}l(e);return t}function l(e){}function c(){}function h(){}function g(){var e="";var t=[0,0,0,0];var n=[];var r=[];var i=[];var s=[];for(var o=0;o<filteredNodes.length;o++){if(filteredNodes[o].type==="Individual"){s.push(filteredNodes[o].name);m.push(filteredNodes[o]);t[3]++}if(filteredNodes[o].type==="Non-Profit"){r.push(filteredNodes[o].name);d.push(filteredNodes[o]);t[1]++}if(filteredNodes[o].type==="For-Profit"){n.push(filteredNodes[o].name);p.push(filteredNodes[o]);t[0]++}if(filteredNodes[o].type==="Government"){i.push(filteredNodes[o].name);v.push(filteredNodes[o]);t[2]++}}e+="<h3 style='padding-bottom:10px;'>The Data</h3>";d3.select("#info").html(e).style("list-style","square");d3.select("#info").append("div").attr("id","breakdown").style("width","100%");var o=d3.scale.linear().domain([0,d3.max(t)]).range([0,$("#breakdown").width()]);var u=0;var a=0;d3.select("#breakdown").selectAll("div").data(t).enter().append("div").style("width",function(e){return o(e)/5+"%"}).style("height","20px").style("font","8px sans-serif").style("background-color",function(e){if(u===0){u++;return"rgb(127,186,0)"}if(u===1){u++;return"rgb(0,164,239)"}if(u===2){u++;return"rgb(242,80,34)"}if(u===3){u++;return"rgb(255,185,0)"}}).style("text-align","right").style("padding","3px").style("margin","1px").style("color","white").text(function(e){if(a===0){a++;return}if(a===1){a++;return}if(a===2){a++;return}if(a===3){a++;return}});var f="";f+="<h3 style='padding-top:15px; color:rgb(127,186,0);'>For-Profit ("+t[0]+"):</h3> ";for(var o=0;o<n.length;o++){if(o===n.length-1){f+="<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+n[o]+"</a>"}else{f+="<a class='for-profit-entity' style='font-size:16px; cursor:pointer;'>"+n[o]+", </a>"}}f+="<h3 style='padding-top:15px; color:rgb(0,164,239);'>Non-Profit ("+t[1]+"):</h3> ";for(var o=0;o<r.length;o++){if(o===r.length-1){f+="<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+r[o]+"</a>"}else{f+="<a class='non-profit-entity' style='font-size:16px; cursor:pointer;'>"+r[o]+", </a>"}}f+="<h3 style='padding-top:15px; color:rgb(242,80,34);'>Government ("+t[2]+"):</h3> ";for(var o=0;o<i.length;o++){if(o===i.length-1){f+="<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+i[o]+"</a>"}else{f+="<a class='government-entity' style='font-size:16px; cursor:pointer;'>"+i[o]+", </a>"}}f+="<h3 style='padding-top:15px; color:rgb(255,185,0);'>Individual ("+t[3]+"):</h3> ";for(var o=0;o<s.length;o++){if(o===s.length-1){f+="<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+s[o]+"</a>"}else{f+="<a  class='individual-entity' style='font-size:16px; cursor:pointer;'>"+s[o]+", </a>"}}d3.select("#info").append("text").style("padding-bottom","20px").html(f)}function x(){var e="";filteredNodes.forEach(function(e){y.push(e.name);b.push(e.location);if(w.indexOf(e.name)===-1&&e.name!==null){w.push(e.name)}if(E.indexOf(e.location)===-1&&e.location!==null){var t=e.location.split("; ");t.forEach(function(e){if(E.indexOf(e)===-1){E.push(e)}})}});S=S.concat(E);S=S.concat(w);S=S.sort();for(var t=0;t<S.length;t++){e+='<option value="'+S[t]+'">'}d3.select(".filter-name-location datalist").html(e)}function T(e){var t=[];var n=0;if(y.indexOf(e)!==-1){y.forEach(function(t){if(t===e&&t.length===e.length){var n=y.indexOf(e);nodeInit.filter(function(e,t){if(t===n){L(e)}})}})}else{b.forEach(function(r){if(r!==null){var i=r.split("; ");if(i.indexOf(e)!==-1){t.push(n)}}n++});var r=0;fundLink.style("opacity",function(t){if(t.source.location===e&&t.target.location===e){return"1"}else return"0.05"});investLink.style("opacity",function(t){if(t.source.location===e&&t.target.location===e){return"1"}else return"0.05"});porucsLink.style("opacity",function(t){if(t.source.location===e&&t.target.location===e){return"1"}else return"0.05"});dataLink.style("opacity",function(t){if(t.source.location===e&&t.target.location===e){return"1"}else return"0.05"});d3.selectAll(".node").style("opacity",function(e,n){if(t.indexOf(n)===-1){return.05}else return 1}).on("mouseover",null);node.on("mouseout",null).on("mouseover",null).on("click",null);node.filter(function(e,t){if(nodeInit[0][t].style.opacity==1)return e}).on("mouseout",null).on("mouseover",u).on("click",null)}}function N(e){var n=f(e);webform=a(e);d3.select("#edit").html(webform);d3.select("#info").html(n).style("list-style","square");fundLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});investLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});porucsLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});dataLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});var r=t.fundingR.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var i=t.investingR.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var s=t.porucs.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var o=t.data.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});d3.select(this).style("stroke","black");svg.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(t){if(r.indexOf(t.index)>-1||i.indexOf(t.index)>-1||s.indexOf(t.index)>-1||o.indexOf(t.index)>-1||t===e)return"1";else return"0.05"})}function C(e){fundLink.style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});investLink.style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});porucsLink.style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});dataLink.style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});var n=t.fundingR.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var r=t.investingR.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var i=t.porucs.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var s=t.data.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});svg.selectAll(".node").style("opacity",function(t){if(n.indexOf(t.index)>-1||r.indexOf(t.index)>-1||i.indexOf(t.index)>-1||s.indexOf(t.index)>-1||t===e)return"1";else return"0.05"});d3.select(this).style("stroke","black").on("mouseout",null);node.filter(function(t){if(t!==e){return t}}).style("stroke","white").on("mouseover",null).on("mouseout",null).on("click",null);node.filter(function(t){return n.indexOf(t.index)>-1||r.indexOf(t.index)>-1||i.indexOf(t.index)>-1||s.indexOf(t.index)>-1||t===e}).on("mouseover",u).on("click",L)}function k(){node.style("stroke","white").on("mouseover",N).on("mouseout",k).on("click",L);fundLink.transition().duration(350).delay(0).style("stroke","rgb(111,93,168)").style("opacity","0.2").style("stroke-width","1px").style("z-index","0");investLink.transition().duration(350).delay(0).style("stroke","rgb(38,114,114)").style("opacity","0.2").style("stroke-width","1px").style("z-index","0");porucsLink.transition().duration(350).delay(0).style("stroke","rgb(235,232,38)").style("opacity","0.2").style("stroke-width","1px").style("z-index","0");dataLink.transition().duration(350).delay(0).style("stroke","rgb(191,72,150)").style("opacity","0.2").style("stroke-width","1px").style("z-index","0");d3.selectAll(".node").transition().duration(350).delay(0).style("opacity","1")}function L(e){u(e);fundLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});investLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});porucsLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});dataLink.transition().duration(350).delay(0).style("opacity",function(t){if(e===t.source||e===t.target){return"1"}else return"0.05"});node.style("stroke",function(t){if(t!==e){return"white"}else return"black"}).on("mouseout",null);node.filter(function(t){if(t!==e){return t}}).on("mouseover",null);var n=t.fundingR.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var r=t.investingR.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var i=t.porucs.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});var s=t.data.filter(function(t){return t.source.index===e.index||t.target.index===e.index}).map(function(t){return t.source.index===e.index?t.target.index:t.source.index});svg.selectAll(".node").transition().duration(350).delay(0).style("opacity",function(t){if(n.indexOf(t.index)>-1||r.indexOf(t.index)>-1||i.indexOf(t.index)>-1||s.indexOf(t.index)>-1||t===e)return"1";else return"0.05"});node.filter(function(t){return n.indexOf(t.index)>-1||r.indexOf(t.index)>-1||i.indexOf(t.index)>-1||s.indexOf(t.index)>-1||t===e}).on("mouseover",u).on("click",function(e){})}function A(e){d3.select(this).classed("fixed",function(e){e.fixed=false});node.on("mouseover",null).on("mouseout",null).on("click",null)}function r(e){node.on("mouseover",null).on("mouseout",null).on("click",null)}function O(e){d3.select(this).classed("fixed",function(e){e.fixed=true});node.on("mouseover",N).on("mouseout",k).on("click",L)}function M(e){var t=8*e.alpha;filteredNodes.forEach(function(e,n){if(e.type!==null){if(e.type==="Individual"){e.x+=t;e.y+=t}if(e.type==="Non-Profit"){e.x+=-t;e.y+=t}if(e.type==="For-Profit"){e.x+=t;e.y+=-t}if(e.type==="Government"){e.x+=-t;e.y+=-t}}});if(_.isEmpty(centeredNode)){fundLink.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y});investLink.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y});porucsLink.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y});dataLink.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y});node.attr("cx",function(e){return e.x=e.x}).attr("cy",function(e){return e.y=e.y});i.attr("transform",transform)}else{fundLink.attr("x1",function(e){if(e.source===centeredNode){e.source.x=centeredNode.x;console.log("Test");return e.source.x}else return e.source.x}).attr("y1",function(e){if(e.source===centeredNode){e.source.y=centeredNode.y;console.log("Test");return e.source.y}else return e.source.y}).attr("x2",function(e){if(e.target===centeredNode){e.target.x=centeredNode.x;console.log("Test");return e.target.x}else return e.target.x}).attr("y2",function(e){if(e.target===centeredNode){e.target.y=centeredNode.y;console.log("Test");return e.target.y}else return e.target.y});investLink.attr("x1",function(e){if(e.source===centeredNode){e.source.x=centeredNode.x;console.log("Test");return e.source.x}else return e.source.x}).attr("y1",function(e){if(e.source===centeredNode){e.source.y=centeredNode.y;console.log("Test");return e.source.y}else return e.source.y}).attr("x2",function(e){if(e.target===centeredNode){e.target.x=centeredNode.x;console.log("Test");return e.target.x}else return e.target.x}).attr("y2",function(e){if(e.target===centeredNode){e.target.y=centeredNode.y;console.log("Test");return e.target.y}else return e.target.y});porucsLink.attr("x1",function(e){if(e.source===centeredNode){e.source.x=centeredNode.x;console.log("Test");return e.source.x}else return e.source.x}).attr("y1",function(e){if(e.source===centeredNode){e.source.y=centeredNode.y;console.log("Test");return e.source.y}else return e.source.y}).attr("x2",function(e){if(e.target===centeredNode){e.target.x=centeredNode.x;console.log("Test");return e.target.x}else return e.target.x}).attr("y2",function(e){if(e.target===centeredNode){e.target.y=centeredNode.y;console.log("Test");return e.target.y}else return e.target.y});dataLink.attr("x1",function(e){if(e.source===centeredNode){e.source.x=centeredNode.x;console.log("Test");return e.source.x}else return e.source.x}).attr("y1",function(e){if(e.source===centeredNode){e.source.y=centeredNode.y;console.log("Test");return e.source.y}else return e.source.y}).attr("x2",function(e){if(e.target===centeredNode){e.target.x=centeredNode.x;console.log("Test");return e.target.x}else return e.target.x}).attr("y2",function(e){if(e.target===centeredNode){e.target.y=centeredNode.y;console.log("Test");return e.target.y}else return e.target.y});node.attr("cx",function(e,t){if(d3.select(node)[0][0].data()[t].name===centeredNode.name){console.log("centeredNode x"+centeredNode.x);e.x=centeredNode.x;return e.x}else return e.x=e.x}).attr("cy",function(e,t){if(d3.select(node)[0][0].data()[t].name===centeredNode.name){console.log("centeredNode y"+centeredNode.y);e.y=centeredNode.y;return e.y}else return e.y=e.y});i.attr("transform",transform)}}function D(){var e=[];for(var t=0;t<nodeInit[0].length;t++){if(nodeInit[0][t].style.visibility==="visible"){e.push(t)}}var n=[];nodeInit.filter(function(t,r){if(e.indexOf(r)>-1)n.push(t)});return n}function j(){console.log($("#keypeople input[name='kpeople']").val());if($("#keypeople input[name='kpeople']").val()!==null&&P===0){H++;$("#keypeople").after('<div id="keypeople'+H+'"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name" onkeyup="add_input_kp()"/></div>');document.querySelector('#keypeople input[name="kpeople"]').onkeyup=null;P++}if($("#keypeople"+H+' input[name="kpeople"]').val()!==""){H++;tempCounterK=H;var e=tempCounterK-1;$("#keypeople"+e).after('<div id="keypeople'+H+'"><input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name" onkeyup="add_input_kp()"/></div>');document.querySelector("#keypeople"+e+' input[name="kpeople"]').onkeyup=null}}filteredNodes=t.nodes;fundingCon=t.fundingR;investingCon=t.investingR;porucsCon=t.porucs;dataCon=t.data;var n=d3.layout.force().nodes(filteredNodes).size([width,height]).links(fundingCon.concat(investingCon).concat(porucsCon).concat(dataCon)).linkStrength(0).charge(function(e){if(e.numemp!==null)return-5*empScale(parseInt(e.numemp));else return-50}).on("tick",M).start();var r=n.drag().on("dragstart",r).on("drag",r).on("dragend",O);fundLink=svg.selectAll(".fund").data(fundingCon).enter().append("line").attr("class","fund").style("stroke","rgb(111,93,168)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible");investLink=svg.selectAll(".invest").data(investingCon).enter().append("line").attr("class","invest").style("stroke","rgb(38,114,114)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible");porucsLink=svg.selectAll(".porucs").data(porucsCon).enter().append("line").attr("class","porucs").style("stroke","rgb(235,232,38)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible");dataLink=svg.selectAll(".data").data(dataCon).enter().append("line").attr("class","data").style("stroke","rgb(191,72,150)").style("stroke-width","1").style("opacity","0.2").style("visibility","visible");nodeInit=svg.selectAll(".node").data(filteredNodes).enter().append("g").attr("class","node").style("visibility","visible").on("dblclick",o).call(r);node=nodeInit.append("circle").attr("r",function(e){if(e.numemp!==null)return empScale(parseInt(e.numemp));else return"7"}).style("fill",function(e){if(e.type!==null){if(e.type==="Individual")return"rgb(255,185,0)";if(e.type==="Non-Profit")return"rgb(0,164,239)";if(e.type==="For-Profit")return"rgb(127,186,0)";if(e.type==="Government")return"rgb(242,80,34)"}}).attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}).style("stroke-width","1.5px").style("stroke","white").on("mouseover",N).on("mouseout",k);var i=svg.selectAll(".node").append("text").text(function(e){return e.nickname}).attr("x",-8).attr("y",".31em").style("font","10px sans-serif").style("pointer-events","none").style("text-shadow","0 1px 0 #fff, 1px 0 0 #fff, 0 -1px 0 #fff, -1px 0 0 #fff");while(n.alpha()>.025){n.tick()}d3.selectAll("#edit").on("click",function(){s="";s+='<h2 id="webform-head">Information</h2><hr/>          <div class="webform-content">          <input type="text" name="name" id="name" placeholder="Name of Entity"/>          <h3 class="form-header">Entity Type</h3>          <div class="webform-entities">          <div data-role="input-control" class="input-control radio default-style webform">            <label>              <input id="rb_nonpro" type="radio" name="relevance" value="Non-Profits" checked="checked"/><span class="check"></span>              <h4 class="webform-labels">Non-Profit</h4>            </label>          </div>          <div data-role="input-control" class="input-control radio default-style webform">            <label>              <input id="rb_forpro" type="radio" name="relevance" value="For-Profits"/><span class="check"></span>              <h4 class="webform-labels">For-Profit</h4>            </label>          </div>          <div data-role="input-control" class="input-control radio default-style webform">            <label>              <input id="rb_gov" type="radio" name="relevance" value="Government"/><span class="check"></span>              <h4 class="webform-labels">Government</h4>            </label>          </div>          <div data-role="input-control" class="input-control radio default-style webform">            <label>              <input id="rb_individs" type="radio" name="relevance" value="Individuals"/><span class="check"></span>              <h4 class="webform-labels">Individual</h4>            </label>          </div>          </div>          <h3 class="form-header">Category</h3><h4>(Select All That Apply)</h4>          <div class="webform-categories">          <div data-role="input-control" class="input-control checkbox webform">            <label>              <input id="cb_gen" type="checkbox" name="gen" data-show="general" value="General"/><span class="check"></span>              <h4 class="webform-labels">General</h4>            </label>          </div>          <div data-role="input-control" class="input-control checkbox webform">            <label>              <input id="cb_datat" type="checkbox" name="datat" data-show="datatrans" value="DataTrans"/><span class="check"></span>              <h4 class="webform-labels">Data Transparency</h4>            </label>          </div>          <div data-role="input-control" class="input-control checkbox webform">            <label>              <input id="cb_cjao" type="checkbox" name="cjao" data-show="cjobsopp" value="CJobsOpp"/><span class="check"></span>              <h4 class="webform-labels">21st Century Jobs and Opportunities</h4>            </label>          </div>          <div data-role="input-control" class="input-control checkbox webform">            <label>              <input id="cb_src" type="checkbox" name="src" data-show="srcities" value="SRCities"/><span class="check"></span>              <h4 class="webform-labels">Smart and Resilient Cities</h4>            </label>          </div>          </div>          <input type="text" name="location" id="location" placeholder="City, State"/>          <input type="text" name="website" id="website" placeholder="Website" value="http://"/>          <h3 class="form-header">Number of Employees: </h3><input type="text" name="employees" id="employee" maxlength="6" style="width:30% !important;"/>          <h3 class="form-header">Key People</h3>          <div id="keypeople">          <input type="text" name="kpeople" class="kpeople" placeholder="Key Person\'s Name"/>          </div>          <h3 class="form-header">Funding/Investment</h3>          <div id="funding">          <div class="fund-input">          <input type="text" name="fund" class="fund" placeholder="Funder" style="display:inline-block; width:50%;"/>          <input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 27%;"/>          <input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%;"/>          </div>          </div>          <button id="submit" href="javascript: check_empty()">Send</button>          </div>';d3.select("#info").html(s)});var p=[];var d=[];var v=[];var m=[];g();d3.selectAll(".for-profit-entity").on("click",function(e,t){L(p[t])});d3.selectAll(".non-profit-entity").on("click",function(e,t){L(d[t])});d3.selectAll(".individual-entity").on("click",function(e,t){L(m[t])});d3.selectAll(".government-entity").on("click",function(e,t){L(v[t])});d3.selectAll(".click-location").on("click",function(e){T(this.innerHTML)});var y=[];var b=[];var w=[];var E=[];var S=[];x();d3.selectAll("#search-text").on("keydown",function(){if(d3.event.keyCode===13){var e=document.getElementById("search-text").value;T(e)}});d3.selectAll("option").on("click",function(e,t){var n=d3.selectAll("option")[0][t].value;T(n)});d3.selectAll("#cb_fund").on("click",function(){var e=D();if(document.getElementById("cb_fund").checked){var t=0;d3.selectAll(".fund").style("visibility",function(n){if(e.indexOf(n.source)>-1&&e.indexOf(n.target)>-1&&this.style.visibility==="hidden"){t++;return"visible"}else return"hidden"})}if(!document.getElementById("cb_fund").checked){d3.selectAll(".fund").style("visibility",function(e){return"hidden"})}if(e.length===0||!document.getElementById("cb_individ").checked&&!document.getElementById("cb_forpro").checked&&!document.getElementById("cb_nonpro").checked&&!document.getElementById("cb_gov").checked){document.getElementById("cb_fund").checked=false}});d3.selectAll("#cb_invest").on("click",function(){var e=D();if(document.getElementById("cb_invest").checked){d3.selectAll(".invest").style("visibility",function(t){if(e.indexOf(t.source)>-1&&e.indexOf(t.target)>-1&&this.style.visibility==="hidden"){return"visible"}else return"hidden"})}if(!document.getElementById("cb_invest").checked){d3.selectAll(".invest").style("visibility",function(e){return"hidden"})}if(e.length===0||!document.getElementById("cb_individ").checked&&!document.getElementById("cb_forpro").checked&&!document.getElementById("cb_nonpro").checked&&!document.getElementById("cb_gov").checked){document.getElementById("cb_invest").checked=false}});d3.selectAll("#cb_porucs").on("click",function(){var e=D();if(document.getElementById("cb_porucs").checked){d3.selectAll(".porucs").style("visibility",function(t){if(e.indexOf(t.source)>-1&&e.indexOf(t.target)>-1&&this.style.visibility==="hidden")return"visible";else return"hidden"})}if(!document.getElementById("cb_porucs").checked){d3.selectAll(".porucs").style("visibility",function(e){return"hidden"})}if(e.length===0||!document.getElementById("cb_individ").checked&&!document.getElementById("cb_forpro").checked&&!document.getElementById("cb_nonpro").checked&&!document.getElementById("cb_gov").checked){document.getElementById("cb_porucs").checked=false}});d3.selectAll("#cb_data").on("click",function(){var e=D();if(document.getElementById("cb_data").checked){d3.selectAll(".data").style("visibility",function(t){if(e.indexOf(t.source)>-1&&e.indexOf(t.target)>-1&&this.style.visibility==="hidden")return"visible";else return"hidden"})}if(!document.getElementById("cb_data").checked){d3.selectAll(".data").style("visibility",function(e){return"hidden"})}if(e.length===0||!document.getElementById("cb_individ").checked&&!document.getElementById("cb_forpro").checked&&!document.getElementById("cb_nonpro").checked&&!document.getElementById("cb_gov").checked){document.getElementById("cb_data").checked=false}});d3.selectAll("#cb_individ, #cb_nonpro, #cb_forpro, #cb_gov").on("click",function(){function q(){var e=arguments;var t={};var n=[];for(var r=0;r<e.length;r++){for(var i=0;i<e[r].length;i++){if(t[e[r][i]]!==true){n[n.length]=e[r][i];t[e[r][i]]=true}}}return n}var e=[];var t=[];var n=[];var r=[];var i=[];var s=[];var o=[];var u=[];var a=[];var f=[];var l=[];var c=[];var h=[];var p=[];var d=[];var v=[];var m=[];var g=[];var y=[];var b=[];var w=[];var E=[];var S=[];var x=[];var T=[];var N=[];var C=[];var k=[];var L=[];var A=[];var O=[];var M=[];var _=[];var D=[];var P=[];var H=[];var B=[];var j=[];var F=[];var I=[];if(document.getElementById("cb_individ").checked){d3.selectAll(".node").filter(function(e){if(e.type==="Individual")return this}).style("visibility","visible");i=0;filteredNodes.forEach(function(t){if(t.type==="Individual"){fundingCon.forEach(function(n){if(t===n.source||t===n.target){e.push(i)}i++});i=0}});i=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){investingCon.forEach(function(n){if(e===n.source||e===n.target){t.push(i)}i++});i=0}});i=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){porucsCon.forEach(function(t){if(e===t.source||e===t.target){n.push(i)}i++});i=0}});countIndex0=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){dataCon.forEach(function(t){if(e===t.source||e===t.target){r.push(countIndex0)}countIndex0++});countIndex0=0}})}if(!document.getElementById("cb_individ").checked){d3.selectAll(".node").filter(function(e){if(e.type==="Individual")return this}).style("visibility","hidden");T=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){fundingCon.forEach(function(t){if(e===t.source||e===t.target){w.push(T)}T++});T=0}});T=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){investingCon.forEach(function(t){if(e===t.source||e===t.target){E.push(T)}T++});T=0}});T=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){porucsCon.forEach(function(t){if(e===t.source||e===t.target){S.push(T)}T++});T=0}});T=0;filteredNodes.forEach(function(e){if(e.type==="Individual"){dataCon.forEach(function(t){if(e===t.source||e===t.target){x.push(T)}T++});T=0}})}if(document.getElementById("cb_nonpro").checked){d3.selectAll(".node").filter(function(e){if(e.type==="Non-Profit")return this}).style("visibility","visible");f=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){fundingCon.forEach(function(t){if((e===t.source||e===t.target)&&s.indexOf(f)===-1){s.push(f)}f++});f=0}});f=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){investingCon.forEach(function(t){if((e===t.source||e===t.target)&&o.indexOf(f)===-1){o.push(f)}f++});f=0}});f=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){porucsCon.forEach(function(t){if((e===t.source||e===t.target)&&u.indexOf(f)===-1){u.push(f)}f++});f=0}});f=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){dataCon.forEach(function(t){if((e===t.source||e===t.target)&&a.indexOf(f)===-1){a.push(f)}f++});f=0}})}if(!document.getElementById("cb_nonpro").checked){d3.selectAll(".node").filter(function(e){if(e.type==="Non-Profit")return this}).style("visibility","hidden");A=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){fundingCon.forEach(function(t){if((e===t.source||e===t.target)&&N.indexOf(A)===-1){N.push(A)}A++});A=0}});A=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){investingCon.forEach(function(t){if((e===t.source||e===t.target)&&C.indexOf(A)===-1){C.push(A)}A++});A=0}});A=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){porucsCon.forEach(function(t){if((e===t.source||e===t.target)&&k.indexOf(A)===-1){k.push(A)}A++});A=0}});A=0;filteredNodes.forEach(function(e){if(e.type==="Non-Profit"){dataCon.forEach(function(t){if((e===t.source||e===t.target)&&L.indexOf(A)===-1){L.push(A)}A++});A=0}})}if(document.getElementById("cb_forpro").checked){d3.selectAll(".node").filter(function(e){if(e.type==="For-Profit")return this}).style("visibility","visible");d=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){fundingCon.forEach(function(t){if((e===t.source||e===t.target)&&l.indexOf(d)===-1){l.push(d)}d++});d=0}});d=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){investingCon.forEach(function(t){if((e===t.source||e===t.target)&&c.indexOf(d)===-1){c.push(d)}d++});d=0}});d=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){porucsCon.forEach(function(t){if((e===t.source||e===t.target)&&h.indexOf(d)===-1){h.push(d)}d++});d=0}});d=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){dataCon.forEach(function(t){if((e===t.source||e===t.target)&&p.indexOf(d)===-1){p.push(d)}d++});d=0}})}if(!document.getElementById("cb_forpro").checked){d3.selectAll(".node").filter(function(e){if(e.type==="For-Profit")return this}).style("visibility","hidden");P=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){fundingCon.forEach(function(t){if((e===t.source||e===t.target)&&O.indexOf(P)===-1){O.push(P)}P++});P=0}});P=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){investingCon.forEach(function(t){if((e===t.source||e===t.target)&&M.indexOf(P)===-1){M.push(P)}P++});P=0}});P=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){porucsCon.forEach(function(t){if((e===t.source||e===t.target)&&_.indexOf(P)===-1){_.push(P)}P++});P=0}});P=0;filteredNodes.forEach(function(e){if(e.type==="For-Profit"){dataCon.forEach(function(t){if((e===t.source||e===t.target)&&D.indexOf(P)===-1){D.push(P)}P++});P=0}})}if(document.getElementById("cb_gov").checked){d3.selectAll(".node").filter(function(e){if(e.type==="Government")return this}).style("visibility","visible");b=0;filteredNodes.forEach(function(e){if(e.type==="Government"){fundingCon.forEach(function(t){if((e===t.source||e===t.target)&&v.indexOf(b)===-1){v.push(b)}b++});b=0}});b=0;filteredNodes.forEach(function(e){if(e.type==="Government"){investingCon.forEach(function(t){if((e===t.source||e===t.target)&&m.indexOf(b)===-1){m.push(b)}b++});b=0}});b=0;filteredNodes.forEach(function(e){if(e.type==="Government"){porucsCon.forEach(function(t){if((e===t.source||e===t.target)&&g.indexOf(b)===-1){g.push(b)}b++});b=0}});b=0;filteredNodes.forEach(function(e){if(e.type==="Government"){dataCon.forEach(function(t){if((e===t.source||e===t.target)&&y.indexOf(b)===-1){y.push(b)}b++});b=0}})}if(!document.getElementById("cb_gov").checked){d3.selectAll(".node").filter(function(e){if(e.type==="Government")return this}).style("visibility","hidden");I=0;filteredNodes.forEach(function(e){if(e.type==="Government"){fundingCon.forEach(function(t){if((e===t.source||e===t.target)&&H.indexOf(I)===-1){H.push(I)}I++});I=0}});I=0;filteredNodes.forEach(function(e){if(e.type==="Government"){investingCon.forEach(function(t){if((e===t.source||e===t.target)&&B.indexOf(I)===-1){B.push(I)}I++});I=0}});I=0;filteredNodes.forEach(function(e){if(e.type==="Government"){porucsCon.forEach(function(t){if((e===t.source||e===t.target)&&j.indexOf(I)===-1){j.push(I)}I++});I=0}});I=0;filteredNodes.forEach(function(e){if(e.type==="Government"){dataCon.forEach(function(t){if((e===t.source||e===t.target)&&F.indexOf(I)===-1){F.push(I)}I++});I=0}})}var R=[];var U=[];var z=[];var W=[];if(e.length!==0)R=q(R,e);if(s.length!==0)R=R=q(R,s);if(l.length!==0)R=q(R,l);if(v.length!==0)R=q(R,v);if(t.length!==0)U=q(U,t);if(o.length!==0)U=q(U,o);if(c.length!==0)U=q(U,c);if(m.length!==0)U=q(U,m);if(n.length!==0)z=q(z,n);if(u.length!==0)z=q(z,u);if(h.length!==0)z=q(z,h);if(g.length!==0)z=q(z,g);if(r.length!==0)W=q(W,r);if(a.length!==0)W=q(W,a);if(p.length!==0)W=q(W,p);if(y.length!==0)W=q(W,y);var X=[];var V=[];var $=[];var J=[];if(w.length!==0)X=q(X,w);if(N.length!==0)X=q(X,N);if(O.length!==0)X=q(X,O);if(H.length!==0)X=q(X,H);if(E.length!==0)V=q(V,E);if(C.length!==0)V=q(V,C);if(M.length!==0)V=q(V,M);if(B.length!==0)V=q(V,B);if(S.length!==0)$=q($,S);if(k.length!==0)$=q($,k);if(_.length!==0)$=q($,_);if(j.length!==0)$=q($,j);if(x.length!==0)J=q(J,x);if(L.length!==0)J=q(J,L);if(D.length!==0)J=q(J,D);if(F.length!==0)J=q(J,F);var K=[];var Q=[];var G=[];var Y=[];if(!document.getElementById("cb_fund").checked){fundLink.filter(function(e,t){if(fundLink[0][t].style.visibility==="hidden"){K.push(t)}})}if(!document.getElementById("cb_invest").checked){investLink.filter(function(e,t){if(investLink[0][t].style.visibility==="hidden"){Q.push(t)}})}if(!document.getElementById("cb_porucs").checked){porucsLink.filter(function(e,t){if(porucsLink[0][t].style.visibility==="hidden"){G.push(t)}})}if(!document.getElementById("cb_data").checked){dataLink.filter(function(e,t){if(dataLink[0][t].style.visibility==="hidden"){Y.push(t)}})}d3.selectAll(".fund").style("visibility",function(e,t){if(R.indexOf(t)>-1){return"visible"}else{return"hidden"}});d3.selectAll(".invest").style("visibility",function(e,t){if(U.indexOf(t)>-1){return"visible"}else{return"hidden"}});d3.selectAll(".porucs").style("visibility",function(e,t){if(z.indexOf(t)>-1){return"visible"}else{return"hidden"}});d3.selectAll(".data").style("visibility",function(e,t){if(W.indexOf(t)>-1){return"visible"}else{return"hidden"}});d3.selectAll(".fund").style("visibility",function(e,t){if(X.indexOf(t)>-1||K.indexOf(t)>-1){return"hidden"}else{return"visible"}});d3.selectAll(".invest").style("visibility",function(e,t){if(V.indexOf(t)>-1||Q.indexOf(t)>-1){return"hidden"}else{return"visible"}});d3.selectAll(".porucs").style("visibility",function(e,t){if($.indexOf(t)>-1||G.indexOf(t)>-1){return"hidden"}else{return"visible"}});d3.selectAll(".data").style("visibility",function(e,t){if(J.indexOf(t)>-1||Y.indexOf(t)>-1){return"hidden"}else{return"visible"}});var Z=0;for(var et=0;et<fundLink[0].length;et++){if(fundLink[0][et].style.visibility==="hidden"){Z++}}var tt=0;for(var et=0;et<investLink[0].length;et++){if(investLink[0][et].style.visibility==="hidden"){tt++}}var nt=0;for(var et=0;et<porucsLink[0].length;et++){if(porucsLink[0][et].style.visibility==="hidden"){nt++}}var rt=0;for(var et=0;et<dataLink[0].length;et++){if(dataLink[0][et].style.visibility==="hidden"){rt++}}if(Z===fundLink[0].length)if(document.getElementById("cb_fund").checked){document.getElementById("cb_fund").checked=false}if(Z!==fundLink[0].length)if(!document.getElementById("cb_fund").checked){document.getElementById("cb_fund").checked=true}if(tt===investLink[0].length)if(document.getElementById("cb_invest").checked){document.getElementById("cb_invest").checked=false}if(tt!==investLink[0].length)if(!document.getElementById("cb_invest").checked){document.getElementById("cb_invest").checked=true}if(nt===porucsLink[0].length)if(document.getElementById("cb_porucs").checked){document.getElementById("cb_porucs").checked=false}if(nt!==porucsLink[0].length)if(!document.getElementById("cb_porucs").checked){document.getElementById("cb_porucs").checked=true}if(rt===dataLink[0].length)if(document.getElementById("cb_data").checked){document.getElementById("cb_data").checked=false}if(rt!==dataLink[0].length)if(!document.getElementById("cb_data").checked){document.getElementById("cb_data").checked=true}});d3.selectAll("#cb_emp, #cb_numtwit").on("click",function(){if(document.getElementById("cb_emp").checked){node.attr("r",function(e){if(e.numemp!==null)return empScale(parseInt(e.numemp));else return"7"});i.attr("transform",function(e){if(e.numemp!==null)return translateSVG(0,-(empScale(parseInt(e.numemp))+2));else return translateSVG(0,-(empScale(parseInt(7))+2))})}if(document.getElementById("cb_numtwit").checked){node.attr("r",function(e){if(e.followers!==null){if(parseInt(e.followers)>1e6){return"50"}else{return twitScale(parseInt(e.followers))}}else return"7"});i.attr("transform",function(e){if(e.followers!==null){if(parseInt(e.followers)>1e6){return translateSVG(0,-52)}else{return translateSVG(0,-(twitScale(parseInt(e.followers))+2))}}else return translateSVG(0,-(twitScale(parseInt(7))+2))})}});var P=0;var H=0;var B;d3.selectAll('#keypeople input[name="kpeople"]').on("keydown",j);var F=0;var I=0;var q;d3.selectAll(".fund").on("keydown",function(){if($("#funding input[name='fund']").val()!==null&&F===0){I++;$("#funding").after('<div id="funding'+I+'"><div class="fund-input"><input type="text" name="fund" class="fund" onkeyup="add_input_f()" placeholder="Funder" style="display:inline-block; width:40%; padding-left:10px;"/><input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 20%; padding-left:10px; margin-left:3px;"/><input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%; padding-left:10px; margin-left:3px;"/></div></div>');document.querySelector('#funding input[name="fund"]').onkeyup=null;F++}if($("#funding"+I+' input[name="fund"]').val()!==""){I++;q=I;var e=q-1;$("#funding"+e).after('<div id="funding'+I+'"><div class="fund-input"><input type="text" name="fund" class="fund" onkeyup="add_input_f()" placeholder="Funder" style="display:inline-block; width:40%; padding-left:10px;"/><input type="text" name="fund_amt" class="fund_amt" placeholder="Amount" style="display:inline-block; width: 20%; padding-left:10px; margin-left:3px;"/><input type="text" name="fund_year" class="fund_year" placeholder="Year" style="display:inline-block; width: 20%; padding-left:10px; margin-left:3px;"/></div></div>');document.querySelector("#funding"+e+' input[name="fund"]').onkeyup=null}});d3.select("svg").on("contextmenu",function(){d3.event.preventDefault();k();d3.selectAll("g").classed("fixed",function(e){e.fixed=false});d3.selectAll("g").call(r);centeredNode=jQuery.extend(true,{},{});var e=d3.layout.force().nodes(filteredNodes).size([width,height]).links(fundingCon.concat(investingCon).concat(porucsCon).concat(dataCon)).linkStrength(0).charge(function(e){if(e.numemp!==null)return-5*empScale(parseInt(e.numemp));else return-50}).on("tick",M).start()})})